Args in experiment:
Namespace(is_training=1, model_id='MRO_336_720_M_channels_6', model='DLinear', data='custom', root_path='./dataset/', data_path='MRO.csv', features='M', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
MRO_336_720_M_channels_6
Use CPU

Model(
  (decompsition): series_decomp(
    (moving_avg): moving_avg(
      (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (Linear_Seasonal): Linear(in_features=336, out_features=720, bias=True)
  (Linear_Trend): Linear(in_features=336, out_features=720, bias=True)
  (Linear_Decoder): Linear(in_features=336, out_features=720, bias=True)
)

>>>>>>>start training : MRO_336_720_M_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 9951
val 855
test 2425
	iters: 100, epoch: 1 | loss: 0.3975362
	speed: 0.0086s/iter; time left: 106.2335s
	iters: 200, epoch: 1 | loss: 0.5011624
	speed: 0.0059s/iter; time left: 72.5117s
	iters: 300, epoch: 1 | loss: 0.6312414
	speed: 0.0057s/iter; time left: 69.2094s
	iters: 400, epoch: 1 | loss: 0.5843028
	speed: 0.0045s/iter; time left: 53.8318s
	iters: 500, epoch: 1 | loss: 0.6720627
	speed: 0.0049s/iter; time left: 58.4576s
	iters: 600, epoch: 1 | loss: 0.8016194
	speed: 0.0044s/iter; time left: 52.3142s
	iters: 700, epoch: 1 | loss: 0.7538012
	speed: 0.0044s/iter; time left: 51.5175s
	iters: 800, epoch: 1 | loss: 0.4197841
	speed: 0.0040s/iter; time left: 46.6550s
	iters: 900, epoch: 1 | loss: 0.7081050
	speed: 0.0048s/iter; time left: 55.3097s
	iters: 1000, epoch: 1 | loss: 0.4936168
	speed: 0.0043s/iter; time left: 48.9832s
	iters: 1100, epoch: 1 | loss: 0.6920013
	speed: 0.0040s/iter; time left: 45.0748s
	iters: 1200, epoch: 1 | loss: 0.4175385
	speed: 0.0040s/iter; time left: 44.7894s
Epoch: 1 cost time: 5.8s
Epoch: 1, Steps: 1243 | Train Loss: 0.5299194 Vali Loss: 13.7945986 Test Loss: 16.7829113
Validation loss decreased (inf --> 13.794599).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3866659
	speed: 0.0146s/iter; time left: 161.8552s
	iters: 200, epoch: 2 | loss: 0.6162458
	speed: 0.0041s/iter; time left: 44.5383s
	iters: 300, epoch: 2 | loss: 0.7636596
	speed: 0.0048s/iter; time left: 52.1817s
	iters: 400, epoch: 2 | loss: 0.2924648
	speed: 0.0045s/iter; time left: 48.7616s
	iters: 500, epoch: 2 | loss: 0.6081477
	speed: 0.0039s/iter; time left: 41.8438s
	iters: 600, epoch: 2 | loss: 0.5395237
	speed: 0.0041s/iter; time left: 43.3643s
	iters: 700, epoch: 2 | loss: 0.8658699
	speed: 0.0044s/iter; time left: 46.1018s
	iters: 800, epoch: 2 | loss: 0.4218726
	speed: 0.0051s/iter; time left: 52.8691s
	iters: 900, epoch: 2 | loss: 0.5613708
	speed: 0.0053s/iter; time left: 54.0912s
	iters: 1000, epoch: 2 | loss: 0.6244147
	speed: 0.0042s/iter; time left: 42.8480s
	iters: 1100, epoch: 2 | loss: 0.6615310
	speed: 0.0046s/iter; time left: 46.4965s
	iters: 1200, epoch: 2 | loss: 0.6424134
	speed: 0.0056s/iter; time left: 55.7366s
Epoch: 2 cost time: 5.7s
Epoch: 2, Steps: 1243 | Train Loss: 0.5259512 Vali Loss: 16.3273659 Test Loss: 18.7767773
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.4434958
	speed: 0.0124s/iter; time left: 122.5302s
	iters: 200, epoch: 3 | loss: 0.4925413
	speed: 0.0052s/iter; time left: 50.7712s
	iters: 300, epoch: 3 | loss: 0.4655515
	speed: 0.0050s/iter; time left: 48.7062s
	iters: 400, epoch: 3 | loss: 0.5121475
	speed: 0.0052s/iter; time left: 49.4333s
	iters: 500, epoch: 3 | loss: 0.4245295
	speed: 0.0052s/iter; time left: 48.7598s
	iters: 600, epoch: 3 | loss: 0.3906473
	speed: 0.0044s/iter; time left: 41.3500s
	iters: 700, epoch: 3 | loss: 0.2723742
	speed: 0.0055s/iter; time left: 51.0705s
	iters: 800, epoch: 3 | loss: 0.6681327
	speed: 0.0044s/iter; time left: 40.2277s
	iters: 900, epoch: 3 | loss: 0.7721646
	speed: 0.0069s/iter; time left: 62.5088s
	iters: 1000, epoch: 3 | loss: 0.6440105
	speed: 0.0046s/iter; time left: 40.9608s
	iters: 1100, epoch: 3 | loss: 0.5968341
	speed: 0.0061s/iter; time left: 53.6184s
	iters: 1200, epoch: 3 | loss: 0.5382051
	speed: 0.0120s/iter; time left: 104.8226s
Epoch: 3 cost time: 8.1s
Epoch: 3, Steps: 1243 | Train Loss: 0.5176705 Vali Loss: 13.9714088 Test Loss: 16.5889301
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.4298526
	speed: 0.0272s/iter; time left: 233.6089s
	iters: 200, epoch: 4 | loss: 0.4389442
	speed: 0.0050s/iter; time left: 42.4822s
	iters: 300, epoch: 4 | loss: 0.7770039
	speed: 0.0053s/iter; time left: 44.4781s
	iters: 400, epoch: 4 | loss: 0.3575240
	speed: 0.0053s/iter; time left: 44.3533s
	iters: 500, epoch: 4 | loss: 0.4717761
	speed: 0.0050s/iter; time left: 40.6021s
	iters: 600, epoch: 4 | loss: 0.5274424
	speed: 0.0056s/iter; time left: 45.4509s
	iters: 700, epoch: 4 | loss: 0.6082347
	speed: 0.0058s/iter; time left: 46.4522s
	iters: 800, epoch: 4 | loss: 0.5178254
	speed: 0.0048s/iter; time left: 38.2680s
	iters: 900, epoch: 4 | loss: 0.6307374
	speed: 0.0054s/iter; time left: 41.7632s
	iters: 1000, epoch: 4 | loss: 0.5370676
	speed: 0.0048s/iter; time left: 36.8360s
	iters: 1100, epoch: 4 | loss: 0.4954551
	speed: 0.0054s/iter; time left: 41.1092s
	iters: 1200, epoch: 4 | loss: 0.8081942
	speed: 0.0047s/iter; time left: 35.5222s
Epoch: 4 cost time: 6.4s
Epoch: 4, Steps: 1243 | Train Loss: 0.5123758 Vali Loss: 15.4897575 Test Loss: 17.2569942
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : MRO_336_720_M_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2425

Final Metrics:

DLinear      MSE: 16.782907  MAE: 2.967885   SE: 19.186718  RRMSE: 0.776408   RMAE: 0.562476   (numpy)
DLinear      MSE: 16.782913  MAE: 2.967888   SE: 19.186720  RRMSE: 0.776409   RMAE: 0.562476   (torch)

Repeat       MSE: 20.380396  MAE: 3.232846   SE: 33.095654  RRMSE: 0.855585   RMAE: 0.612691   (numpy)
Repeat       MSE: 20.380388  MAE: 3.232842   SE: 33.095657  RRMSE: 0.855585   RMAE: 0.612691   (torch)

Shapes: pred (2424, 720, 6), true (2424, 720, 6), naive_pred (2424, 720, 6), gt (2424, 1056, 6), metrics {'DLinear': {'mse': 16.782907, 'mae': 2.9678855, 'se': 19.186718, 'relative_rmse': 0.7764085, 'relative_mae': 0.5624758, 'mse_torch': 16.782913208007812, 'mae_torch': 2.9678878784179688, 'se_torch': 19.18671989440918, 'relative_rmse_torch': 0.7764086802200966, 'relative_mae_torch': 0.5624762607930646}, 'Repeat': {'mse': 20.380396, 'mae': 3.2328455, 'se': 33.095654, 'relative_rmse': 0.85558474, 'relative_mae': 0.6126912, 'mse_torch': 20.380388259887695, 'mae_torch': 3.232842445373535, 'se_torch': 33.09565734863281, 'relative_rmse_torch': 0.8555845518416767, 'relative_mae_torch': 0.6126906422678302}}
