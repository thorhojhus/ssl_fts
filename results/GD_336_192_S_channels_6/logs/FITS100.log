Args in experiment:
Namespace(is_training=1, model_id='GD_336_192_S_channels_6', model='FITS100', data='custom', root_path='./dataset/', data_path='GD.csv', features='S', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
GD_336_192_S_channels_6
Use CPU
FITS cutoff frequency: 100

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=100, out_features=157, bias=True)
  )
)

>>>>>>>start training : GD_336_192_S_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10479
val 1383
test 2953
	iters: 100, epoch: 1 | loss: 0.0009935
	speed: 0.0042s/iter; time left: 54.0943s
	iters: 200, epoch: 1 | loss: 0.0011764
	speed: 0.0010s/iter; time left: 12.2660s
	iters: 300, epoch: 1 | loss: 0.0696821
	speed: 0.0009s/iter; time left: 11.3332s
	iters: 400, epoch: 1 | loss: 0.1091212
	speed: 0.0012s/iter; time left: 15.4405s
	iters: 500, epoch: 1 | loss: 0.0791913
	speed: 0.0012s/iter; time left: 14.8279s
	iters: 600, epoch: 1 | loss: 0.0500634
	speed: 0.0012s/iter; time left: 14.5434s
	iters: 700, epoch: 1 | loss: 0.0488405
	speed: 0.0010s/iter; time left: 12.7100s
	iters: 800, epoch: 1 | loss: 0.0322881
	speed: 0.0008s/iter; time left: 10.0255s
	iters: 900, epoch: 1 | loss: 0.0530123
	speed: 0.0011s/iter; time left: 12.9739s
	iters: 1000, epoch: 1 | loss: 0.1300657
	speed: 0.0008s/iter; time left: 10.2128s
	iters: 1100, epoch: 1 | loss: 0.0440817
	speed: 0.0008s/iter; time left: 9.7816s
	iters: 1200, epoch: 1 | loss: 0.0063622
	speed: 0.0011s/iter; time left: 13.3293s
	iters: 1300, epoch: 1 | loss: 0.0650095
	speed: 0.0008s/iter; time left: 8.9276s
Epoch: 1 cost time: 1.3s
Epoch: 1, Steps: 1309 | Train Loss: 0.0417137 Vali Loss: 0.9623857 Test Loss: 5.0761442
Validation loss decreased (inf --> 0.962386).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0412880
	speed: 0.0030s/iter; time left: 34.7178s
	iters: 200, epoch: 2 | loss: 0.0636198
	speed: 0.0008s/iter; time left: 8.8866s
	iters: 300, epoch: 2 | loss: 0.0178769
	speed: 0.0008s/iter; time left: 8.8045s
	iters: 400, epoch: 2 | loss: 0.0478103
	speed: 0.0008s/iter; time left: 8.9091s
	iters: 500, epoch: 2 | loss: 0.0295710
	speed: 0.0008s/iter; time left: 8.6769s
	iters: 600, epoch: 2 | loss: 0.0204951
	speed: 0.0008s/iter; time left: 8.8703s
	iters: 700, epoch: 2 | loss: 0.0165181
	speed: 0.0008s/iter; time left: 9.4103s
	iters: 800, epoch: 2 | loss: 0.0295924
	speed: 0.0009s/iter; time left: 9.9311s
	iters: 900, epoch: 2 | loss: 0.0048565
	speed: 0.0008s/iter; time left: 8.6813s
	iters: 1000, epoch: 2 | loss: 0.0007880
	speed: 0.0008s/iter; time left: 8.5876s
	iters: 1100, epoch: 2 | loss: 0.0553687
	speed: 0.0008s/iter; time left: 8.2986s
	iters: 1200, epoch: 2 | loss: 0.0029856
	speed: 0.0008s/iter; time left: 8.1094s
	iters: 1300, epoch: 2 | loss: 0.0111126
	speed: 0.0010s/iter; time left: 10.8365s
Epoch: 2 cost time: 1.1s
Epoch: 2, Steps: 1309 | Train Loss: 0.0341926 Vali Loss: 0.9469563 Test Loss: 4.7578216
Validation loss decreased (0.962386 --> 0.946956).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0228787
	speed: 0.0026s/iter; time left: 27.4512s
	iters: 200, epoch: 3 | loss: 0.0037916
	speed: 0.0008s/iter; time left: 8.3908s
	iters: 300, epoch: 3 | loss: 0.0042950
	speed: 0.0008s/iter; time left: 8.0209s
	iters: 400, epoch: 3 | loss: 0.0209306
	speed: 0.0009s/iter; time left: 9.0167s
	iters: 500, epoch: 3 | loss: 0.0016139
	speed: 0.0008s/iter; time left: 8.1305s
	iters: 600, epoch: 3 | loss: 0.0524061
	speed: 0.0008s/iter; time left: 7.9169s
	iters: 700, epoch: 3 | loss: 0.0371821
	speed: 0.0007s/iter; time left: 7.3203s
	iters: 800, epoch: 3 | loss: 0.0486641
	speed: 0.0008s/iter; time left: 7.4381s
	iters: 900, epoch: 3 | loss: 0.1546918
	speed: 0.0008s/iter; time left: 7.6394s
	iters: 1000, epoch: 3 | loss: 0.1026094
	speed: 0.0007s/iter; time left: 7.0600s
	iters: 1100, epoch: 3 | loss: 0.0016885
	speed: 0.0008s/iter; time left: 7.6941s
	iters: 1200, epoch: 3 | loss: 0.1138665
	speed: 0.0008s/iter; time left: 7.4480s
	iters: 1300, epoch: 3 | loss: 0.0335395
	speed: 0.0008s/iter; time left: 6.9295s
Epoch: 3 cost time: 1.0s
Epoch: 3, Steps: 1309 | Train Loss: 0.0324184 Vali Loss: 0.9145576 Test Loss: 4.7899523
Validation loss decreased (0.946956 --> 0.914558).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0010539
	speed: 0.0027s/iter; time left: 24.5263s
	iters: 200, epoch: 4 | loss: 0.0316638
	speed: 0.0011s/iter; time left: 9.9550s
	iters: 300, epoch: 4 | loss: 0.0583708
	speed: 0.0008s/iter; time left: 6.9180s
	iters: 400, epoch: 4 | loss: 0.0389689
	speed: 0.0010s/iter; time left: 9.1331s
	iters: 500, epoch: 4 | loss: 0.0975317
	speed: 0.0008s/iter; time left: 6.7156s
	iters: 600, epoch: 4 | loss: 0.0196439
	speed: 0.0008s/iter; time left: 6.5690s
	iters: 700, epoch: 4 | loss: 0.0380687
	speed: 0.0011s/iter; time left: 9.7240s
	iters: 800, epoch: 4 | loss: 0.0789403
	speed: 0.0007s/iter; time left: 6.1687s
	iters: 900, epoch: 4 | loss: 0.0822411
	speed: 0.0009s/iter; time left: 7.4418s
	iters: 1000, epoch: 4 | loss: 0.0377832
	speed: 0.0008s/iter; time left: 6.3332s
	iters: 1100, epoch: 4 | loss: 0.0042797
	speed: 0.0008s/iter; time left: 6.2992s
	iters: 1200, epoch: 4 | loss: 0.0241505
	speed: 0.0007s/iter; time left: 5.9105s
	iters: 1300, epoch: 4 | loss: 0.0274774
	speed: 0.0009s/iter; time left: 7.4006s
Epoch: 4 cost time: 1.1s
Epoch: 4, Steps: 1309 | Train Loss: 0.0318589 Vali Loss: 0.9144300 Test Loss: 4.7406063
Validation loss decreased (0.914558 --> 0.914430).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0052420
	speed: 0.0026s/iter; time left: 20.5351s
	iters: 200, epoch: 5 | loss: 0.0017566
	speed: 0.0008s/iter; time left: 5.8124s
	iters: 300, epoch: 5 | loss: 0.1018699
	speed: 0.0008s/iter; time left: 5.9601s
	iters: 400, epoch: 5 | loss: 0.0045670
	speed: 0.0008s/iter; time left: 5.8825s
	iters: 500, epoch: 5 | loss: 0.0026151
	speed: 0.0008s/iter; time left: 6.1763s
	iters: 600, epoch: 5 | loss: 0.0293357
	speed: 0.0008s/iter; time left: 5.5221s
	iters: 700, epoch: 5 | loss: 0.0062927
	speed: 0.0008s/iter; time left: 5.4905s
	iters: 800, epoch: 5 | loss: 0.1341559
	speed: 0.0008s/iter; time left: 5.3081s
	iters: 900, epoch: 5 | loss: 0.0436699
	speed: 0.0008s/iter; time left: 5.5429s
	iters: 1000, epoch: 5 | loss: 0.0231398
	speed: 0.0008s/iter; time left: 5.4795s
	iters: 1100, epoch: 5 | loss: 0.0350508
	speed: 0.0012s/iter; time left: 8.1944s
	iters: 1200, epoch: 5 | loss: 0.0307514
	speed: 0.0011s/iter; time left: 7.5102s
	iters: 1300, epoch: 5 | loss: 0.0274693
	speed: 0.0008s/iter; time left: 5.0296s
Epoch: 5 cost time: 1.1s
Epoch: 5, Steps: 1309 | Train Loss: 0.0316038 Vali Loss: 0.9062449 Test Loss: 4.7376056
Validation loss decreased (0.914430 --> 0.906245).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0035913
	speed: 0.0030s/iter; time left: 19.6418s
	iters: 200, epoch: 6 | loss: 0.0021699
	speed: 0.0008s/iter; time left: 5.2508s
	iters: 300, epoch: 6 | loss: 0.0431927
	speed: 0.0008s/iter; time left: 4.6955s
	iters: 400, epoch: 6 | loss: 0.0146674
	speed: 0.0008s/iter; time left: 4.8098s
	iters: 500, epoch: 6 | loss: 0.0114658
	speed: 0.0008s/iter; time left: 4.6315s
	iters: 600, epoch: 6 | loss: 0.0560101
	speed: 0.0008s/iter; time left: 4.6847s
	iters: 700, epoch: 6 | loss: 0.0286495
	speed: 0.0008s/iter; time left: 4.8199s
	iters: 800, epoch: 6 | loss: 0.0785203
	speed: 0.0007s/iter; time left: 4.2603s
	iters: 900, epoch: 6 | loss: 0.0534096
	speed: 0.0008s/iter; time left: 4.2486s
	iters: 1000, epoch: 6 | loss: 0.0021826
	speed: 0.0008s/iter; time left: 4.2563s
	iters: 1100, epoch: 6 | loss: 0.0031767
	speed: 0.0008s/iter; time left: 4.2308s
	iters: 1200, epoch: 6 | loss: 0.0080000
	speed: 0.0008s/iter; time left: 4.1755s
	iters: 1300, epoch: 6 | loss: 0.0078297
	speed: 0.0009s/iter; time left: 4.7319s
Epoch: 6 cost time: 1.1s
Epoch: 6, Steps: 1309 | Train Loss: 0.0314882 Vali Loss: 0.9113110 Test Loss: 4.7333479
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0013998
	speed: 0.0027s/iter; time left: 13.6361s
	iters: 200, epoch: 7 | loss: 0.0512093
	speed: 0.0009s/iter; time left: 4.4557s
	iters: 300, epoch: 7 | loss: 0.0054214
	speed: 0.0008s/iter; time left: 4.0269s
	iters: 400, epoch: 7 | loss: 0.0508882
	speed: 0.0008s/iter; time left: 3.7906s
	iters: 500, epoch: 7 | loss: 0.0393814
	speed: 0.0008s/iter; time left: 3.6373s
	iters: 600, epoch: 7 | loss: 0.0187657
	speed: 0.0008s/iter; time left: 3.5129s
	iters: 700, epoch: 7 | loss: 0.0212781
	speed: 0.0008s/iter; time left: 3.4268s
	iters: 800, epoch: 7 | loss: 0.0129750
	speed: 0.0008s/iter; time left: 3.4194s
	iters: 900, epoch: 7 | loss: 0.0377972
	speed: 0.0008s/iter; time left: 3.4398s
	iters: 1000, epoch: 7 | loss: 0.0307493
	speed: 0.0008s/iter; time left: 3.5768s
	iters: 1100, epoch: 7 | loss: 0.0287800
	speed: 0.0011s/iter; time left: 4.3479s
	iters: 1200, epoch: 7 | loss: 0.0240869
	speed: 0.0008s/iter; time left: 3.0312s
	iters: 1300, epoch: 7 | loss: 0.0580526
	speed: 0.0008s/iter; time left: 3.1268s
Epoch: 7 cost time: 1.1s
Epoch: 7, Steps: 1309 | Train Loss: 0.0314223 Vali Loss: 0.9065942 Test Loss: 4.7316728
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0586579
	speed: 0.0026s/iter; time left: 10.1387s
	iters: 200, epoch: 8 | loss: 0.0423650
	speed: 0.0007s/iter; time left: 2.7767s
	iters: 300, epoch: 8 | loss: 0.0049747
	speed: 0.0008s/iter; time left: 2.9371s
	iters: 400, epoch: 8 | loss: 0.0337538
	speed: 0.0008s/iter; time left: 2.8399s
	iters: 500, epoch: 8 | loss: 0.0192015
	speed: 0.0008s/iter; time left: 2.6630s
	iters: 600, epoch: 8 | loss: 0.0120248
	speed: 0.0008s/iter; time left: 2.6672s
	iters: 700, epoch: 8 | loss: 0.0679899
	speed: 0.0010s/iter; time left: 3.3799s
	iters: 800, epoch: 8 | loss: 0.0068453
	speed: 0.0008s/iter; time left: 2.4609s
	iters: 900, epoch: 8 | loss: 0.0259658
	speed: 0.0008s/iter; time left: 2.3052s
	iters: 1000, epoch: 8 | loss: 0.0052746
	speed: 0.0008s/iter; time left: 2.2612s
	iters: 1100, epoch: 8 | loss: 0.1073142
	speed: 0.0008s/iter; time left: 2.1914s
	iters: 1200, epoch: 8 | loss: 0.0063980
	speed: 0.0008s/iter; time left: 2.0473s
	iters: 1300, epoch: 8 | loss: 0.0316808
	speed: 0.0010s/iter; time left: 2.5690s
Epoch: 8 cost time: 1.1s
Epoch: 8, Steps: 1309 | Train Loss: 0.0313966 Vali Loss: 0.9111223 Test Loss: 4.7305837
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : GD_336_192_S_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2953

Final Metrics:

FITS100      MSE: 4.737605   MAE: 1.642322   SE: 10.412119  RRMSE: 0.141453   RMAE: 0.106731   (numpy)
FITS100      MSE: 4.737606   MAE: 1.642322   SE: 10.412120  RRMSE: 0.141454   RMAE: 0.106731   (torch)

Repeat       MSE: 4.300982   MAE: 1.530693   SE: 9.897922   RRMSE: 0.134778   RMAE: 0.099477   (numpy)
Repeat       MSE: 4.300982   MAE: 1.530692   SE: 9.897922   RRMSE: 0.134778   RMAE: 0.099477   (torch)

Shapes: pred (2952, 192, 1), true (2952, 192, 1), naive_pred (2952, 192, 1), gt (2952, 528, 1), metrics {'FITS100': {'mse': 4.7376046, 'mae': 1.6423218, 'se': 10.412119, 'relative_rmse': 0.14145349, 'relative_mae': 0.106731474, 'mse_torch': 4.737605571746826, 'mae_torch': 1.642322063446045, 'se_torch': 10.41211986541748, 'relative_rmse_torch': 0.14145350225917733, 'relative_mae_torch': 0.10673149228221572}, 'Repeat': {'mse': 4.3009815, 'mae': 1.5306926, 'se': 9.897922, 'relative_rmse': 0.1347777, 'relative_mae': 0.099476896, 'mse_torch': 4.300981521606445, 'mae_torch': 1.530692458152771, 'se_torch': 9.897921562194824, 'relative_rmse_torch': 0.1347777005580629, 'relative_mae_torch': 0.09947688941167633}}
