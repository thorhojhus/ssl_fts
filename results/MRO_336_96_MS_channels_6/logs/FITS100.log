Args in experiment:
Namespace(is_training=1, model_id='MRO_336_96_MS_channels_6', model='FITS100', data='custom', root_path='./dataset/', data_path='MRO.csv', features='MS', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
MRO_336_96_MS_channels_6
Use CPU
FITS cutoff frequency: 100

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=100, out_features=128, bias=True)
  )
)

>>>>>>>start training : MRO_336_96_MS_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10575
val 1479
test 3049
	iters: 100, epoch: 1 | loss: 0.0873107
	speed: 0.0047s/iter; time left: 62.1115s
	iters: 200, epoch: 1 | loss: 0.0286999
	speed: 0.0013s/iter; time left: 17.2854s
	iters: 300, epoch: 1 | loss: 0.0657669
	speed: 0.0015s/iter; time left: 19.3448s
	iters: 400, epoch: 1 | loss: 0.0358452
	speed: 0.0020s/iter; time left: 25.7341s
	iters: 500, epoch: 1 | loss: 0.0460277
	speed: 0.0015s/iter; time left: 18.7271s
	iters: 600, epoch: 1 | loss: 0.0379611
	speed: 0.0015s/iter; time left: 18.8008s
	iters: 700, epoch: 1 | loss: 0.0185881
	speed: 0.0014s/iter; time left: 17.8448s
	iters: 800, epoch: 1 | loss: 0.0181107
	speed: 0.0014s/iter; time left: 17.1597s
	iters: 900, epoch: 1 | loss: 0.0117410
	speed: 0.0029s/iter; time left: 35.3481s
	iters: 1000, epoch: 1 | loss: 0.0095477
	speed: 0.0013s/iter; time left: 16.4791s
	iters: 1100, epoch: 1 | loss: 0.0241165
	speed: 0.0014s/iter; time left: 16.5957s
	iters: 1200, epoch: 1 | loss: 0.0198276
	speed: 0.0014s/iter; time left: 16.4720s
	iters: 1300, epoch: 1 | loss: 0.0182140
	speed: 0.0013s/iter; time left: 15.8600s
Epoch: 1 cost time: 2.1s
Epoch: 1, Steps: 1321 | Train Loss: 0.0487437 Vali Loss: 2.6736417 Test Loss: 3.4796970
Validation loss decreased (inf --> 2.673642).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0260248
	speed: 0.0055s/iter; time left: 65.3702s
	iters: 200, epoch: 2 | loss: 0.0110324
	speed: 0.0014s/iter; time left: 16.9205s
	iters: 300, epoch: 2 | loss: 0.0284077
	speed: 0.0017s/iter; time left: 19.7297s
	iters: 400, epoch: 2 | loss: 0.0371286
	speed: 0.0013s/iter; time left: 15.2309s
	iters: 500, epoch: 2 | loss: 0.0532480
	speed: 0.0014s/iter; time left: 15.6591s
	iters: 600, epoch: 2 | loss: 0.0627256
	speed: 0.0014s/iter; time left: 15.6059s
	iters: 700, epoch: 2 | loss: 0.0193728
	speed: 0.0017s/iter; time left: 18.8357s
	iters: 800, epoch: 2 | loss: 0.0151992
	speed: 0.0015s/iter; time left: 16.0848s
	iters: 900, epoch: 2 | loss: 0.1160232
	speed: 0.0013s/iter; time left: 14.7348s
	iters: 1000, epoch: 2 | loss: 0.0733679
	speed: 0.0015s/iter; time left: 16.1912s
	iters: 1100, epoch: 2 | loss: 0.0162193
	speed: 0.0013s/iter; time left: 14.1014s
	iters: 1200, epoch: 2 | loss: 0.0318717
	speed: 0.0017s/iter; time left: 17.7711s
	iters: 1300, epoch: 2 | loss: 0.0723861
	speed: 0.0013s/iter; time left: 13.9972s
Epoch: 2 cost time: 1.9s
Epoch: 2, Steps: 1321 | Train Loss: 0.0366497 Vali Loss: 2.5471032 Test Loss: 3.2525914
Validation loss decreased (2.673642 --> 2.547103).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0260031
	speed: 0.0063s/iter; time left: 65.8759s
	iters: 200, epoch: 3 | loss: 0.0333309
	speed: 0.0014s/iter; time left: 14.3682s
	iters: 300, epoch: 3 | loss: 0.0325166
	speed: 0.0014s/iter; time left: 14.2954s
	iters: 400, epoch: 3 | loss: 0.0651284
	speed: 0.0015s/iter; time left: 15.0347s
	iters: 500, epoch: 3 | loss: 0.0114677
	speed: 0.0017s/iter; time left: 17.1786s
	iters: 600, epoch: 3 | loss: 0.0677100
	speed: 0.0014s/iter; time left: 13.7660s
	iters: 700, epoch: 3 | loss: 0.0192100
	speed: 0.0013s/iter; time left: 12.4582s
	iters: 800, epoch: 3 | loss: 0.0231508
	speed: 0.0014s/iter; time left: 13.6360s
	iters: 900, epoch: 3 | loss: 0.0531038
	speed: 0.0013s/iter; time left: 12.9762s
	iters: 1000, epoch: 3 | loss: 0.0103354
	speed: 0.0014s/iter; time left: 12.9512s
	iters: 1100, epoch: 3 | loss: 0.0309512
	speed: 0.0013s/iter; time left: 12.6029s
	iters: 1200, epoch: 3 | loss: 0.0307843
	speed: 0.0014s/iter; time left: 13.2055s
	iters: 1300, epoch: 3 | loss: 0.1370336
	speed: 0.0013s/iter; time left: 12.3675s
Epoch: 3 cost time: 1.8s
Epoch: 3, Steps: 1321 | Train Loss: 0.0348760 Vali Loss: 2.5533633 Test Loss: 3.2415833
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0536343
	speed: 0.0063s/iter; time left: 57.6440s
	iters: 200, epoch: 4 | loss: 0.0177434
	speed: 0.0013s/iter; time left: 12.2069s
	iters: 300, epoch: 4 | loss: 0.0081885
	speed: 0.0017s/iter; time left: 15.0356s
	iters: 400, epoch: 4 | loss: 0.0326194
	speed: 0.0016s/iter; time left: 14.3622s
	iters: 500, epoch: 4 | loss: 0.0090892
	speed: 0.0016s/iter; time left: 13.7457s
	iters: 600, epoch: 4 | loss: 0.0774897
	speed: 0.0014s/iter; time left: 12.1844s
	iters: 700, epoch: 4 | loss: 0.0736880
	speed: 0.0013s/iter; time left: 11.2065s
	iters: 800, epoch: 4 | loss: 0.0175417
	speed: 0.0013s/iter; time left: 10.6157s
	iters: 900, epoch: 4 | loss: 0.0220738
	speed: 0.0016s/iter; time left: 13.4823s
	iters: 1000, epoch: 4 | loss: 0.0707026
	speed: 0.0013s/iter; time left: 10.8121s
	iters: 1100, epoch: 4 | loss: 0.0429586
	speed: 0.0013s/iter; time left: 10.8887s
	iters: 1200, epoch: 4 | loss: 0.0093269
	speed: 0.0014s/iter; time left: 11.5167s
	iters: 1300, epoch: 4 | loss: 0.0417701
	speed: 0.0014s/iter; time left: 11.1957s
Epoch: 4 cost time: 1.9s
Epoch: 4, Steps: 1321 | Train Loss: 0.0343034 Vali Loss: 2.5285690 Test Loss: 3.2018576
Validation loss decreased (2.547103 --> 2.528569).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0494225
	speed: 0.0065s/iter; time left: 51.2460s
	iters: 200, epoch: 5 | loss: 0.0157862
	speed: 0.0014s/iter; time left: 10.5411s
	iters: 300, epoch: 5 | loss: 0.0309908
	speed: 0.0015s/iter; time left: 11.7879s
	iters: 400, epoch: 5 | loss: 0.0237636
	speed: 0.0014s/iter; time left: 10.6338s
	iters: 500, epoch: 5 | loss: 0.0301010
	speed: 0.0013s/iter; time left: 9.6535s
	iters: 600, epoch: 5 | loss: 0.0367722
	speed: 0.0013s/iter; time left: 9.6028s
	iters: 700, epoch: 5 | loss: 0.0342893
	speed: 0.0015s/iter; time left: 10.7375s
	iters: 800, epoch: 5 | loss: 0.0421630
	speed: 0.0015s/iter; time left: 10.9424s
	iters: 900, epoch: 5 | loss: 0.0166336
	speed: 0.0015s/iter; time left: 10.4055s
	iters: 1000, epoch: 5 | loss: 0.0212583
	speed: 0.0013s/iter; time left: 8.7827s
	iters: 1100, epoch: 5 | loss: 0.0193542
	speed: 0.0014s/iter; time left: 9.8004s
	iters: 1200, epoch: 5 | loss: 0.0166236
	speed: 0.0013s/iter; time left: 8.7810s
	iters: 1300, epoch: 5 | loss: 0.0417551
	speed: 0.0013s/iter; time left: 8.4543s
Epoch: 5 cost time: 1.9s
Epoch: 5, Steps: 1321 | Train Loss: 0.0340172 Vali Loss: 2.5056520 Test Loss: 3.1743855
Validation loss decreased (2.528569 --> 2.505652).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1301041
	speed: 0.0063s/iter; time left: 41.0130s
	iters: 200, epoch: 6 | loss: 0.0200915
	speed: 0.0013s/iter; time left: 8.4659s
	iters: 300, epoch: 6 | loss: 0.0107674
	speed: 0.0013s/iter; time left: 8.4675s
	iters: 400, epoch: 6 | loss: 0.0434437
	speed: 0.0015s/iter; time left: 9.0858s
	iters: 500, epoch: 6 | loss: 0.0782375
	speed: 0.0013s/iter; time left: 8.0753s
	iters: 600, epoch: 6 | loss: 0.0331899
	speed: 0.0013s/iter; time left: 7.8404s
	iters: 700, epoch: 6 | loss: 0.0077571
	speed: 0.0014s/iter; time left: 8.3382s
	iters: 800, epoch: 6 | loss: 0.0328518
	speed: 0.0017s/iter; time left: 10.1597s
	iters: 900, epoch: 6 | loss: 0.0368822
	speed: 0.0014s/iter; time left: 7.9182s
	iters: 1000, epoch: 6 | loss: 0.0797464
	speed: 0.0013s/iter; time left: 7.4869s
	iters: 1100, epoch: 6 | loss: 0.0280075
	speed: 0.0013s/iter; time left: 7.4268s
	iters: 1200, epoch: 6 | loss: 0.0149782
	speed: 0.0022s/iter; time left: 11.8572s
	iters: 1300, epoch: 6 | loss: 0.0270073
	speed: 0.0016s/iter; time left: 8.7155s
Epoch: 6 cost time: 2.0s
Epoch: 6, Steps: 1321 | Train Loss: 0.0339159 Vali Loss: 2.5102775 Test Loss: 3.1676536
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0181236
	speed: 0.0060s/iter; time left: 31.1265s
	iters: 200, epoch: 7 | loss: 0.0162768
	speed: 0.0016s/iter; time left: 8.1035s
	iters: 300, epoch: 7 | loss: 0.0148450
	speed: 0.0013s/iter; time left: 6.7037s
	iters: 400, epoch: 7 | loss: 0.0772432
	speed: 0.0013s/iter; time left: 6.3579s
	iters: 500, epoch: 7 | loss: 0.0326362
	speed: 0.0014s/iter; time left: 6.9305s
	iters: 600, epoch: 7 | loss: 0.0277816
	speed: 0.0014s/iter; time left: 6.5523s
	iters: 700, epoch: 7 | loss: 0.0315949
	speed: 0.0014s/iter; time left: 6.3327s
	iters: 800, epoch: 7 | loss: 0.0412240
	speed: 0.0015s/iter; time left: 6.5717s
	iters: 900, epoch: 7 | loss: 0.0377247
	speed: 0.0014s/iter; time left: 6.0312s
	iters: 1000, epoch: 7 | loss: 0.0622775
	speed: 0.0013s/iter; time left: 5.7773s
	iters: 1100, epoch: 7 | loss: 0.0287703
	speed: 0.0013s/iter; time left: 5.5322s
	iters: 1200, epoch: 7 | loss: 0.0204599
	speed: 0.0017s/iter; time left: 7.0123s
	iters: 1300, epoch: 7 | loss: 0.0121475
	speed: 0.0014s/iter; time left: 5.6838s
Epoch: 7 cost time: 1.9s
Epoch: 7, Steps: 1321 | Train Loss: 0.0337890 Vali Loss: 2.5080853 Test Loss: 3.1662381
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0280183
	speed: 0.0057s/iter; time left: 21.9884s
	iters: 200, epoch: 8 | loss: 0.0314646
	speed: 0.0013s/iter; time left: 4.9829s
	iters: 300, epoch: 8 | loss: 0.0633105
	speed: 0.0014s/iter; time left: 5.0204s
	iters: 400, epoch: 8 | loss: 0.0696555
	speed: 0.0014s/iter; time left: 4.9900s
	iters: 500, epoch: 8 | loss: 0.0364481
	speed: 0.0014s/iter; time left: 5.0095s
	iters: 600, epoch: 8 | loss: 0.0597481
	speed: 0.0014s/iter; time left: 4.7324s
	iters: 700, epoch: 8 | loss: 0.0567889
	speed: 0.0014s/iter; time left: 4.5350s
	iters: 800, epoch: 8 | loss: 0.0168481
	speed: 0.0014s/iter; time left: 4.3020s
	iters: 900, epoch: 8 | loss: 0.0194590
	speed: 0.0013s/iter; time left: 4.0553s
	iters: 1000, epoch: 8 | loss: 0.0249449
	speed: 0.0021s/iter; time left: 6.3099s
	iters: 1100, epoch: 8 | loss: 0.0306103
	speed: 0.0013s/iter; time left: 3.6378s
	iters: 1200, epoch: 8 | loss: 0.0130945
	speed: 0.0013s/iter; time left: 3.5812s
	iters: 1300, epoch: 8 | loss: 0.0113378
	speed: 0.0014s/iter; time left: 3.6981s
Epoch: 8 cost time: 1.9s
Epoch: 8, Steps: 1321 | Train Loss: 0.0338139 Vali Loss: 2.5088391 Test Loss: 3.1665385
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : MRO_336_96_MS_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3049

Final Metrics:

FITS100      MSE: 3.174386   MAE: 1.390586   SE: 6.468874   RRMSE: 0.212162   RMAE: 0.165591   (numpy)
FITS100      MSE: 3.174386   MAE: 1.390586   SE: 6.468875   RRMSE: 0.212162   RMAE: 0.165591   (torch)

Repeat       MSE: 2.870288   MAE: 1.261266   SE: 5.347196   RRMSE: 0.201744   RMAE: 0.150191   (numpy)
Repeat       MSE: 2.870288   MAE: 1.261266   SE: 5.347196   RRMSE: 0.201744   RMAE: 0.150191   (torch)

Shapes: pred (3048, 96, 1), true (3048, 96, 1), naive_pred (3048, 96, 1), gt (3048, 432, 1), metrics {'FITS100': {'mse': 3.1743858, 'mae': 1.3905863, 'se': 6.4688745, 'relative_rmse': 0.21216244, 'relative_mae': 0.16559094, 'mse_torch': 3.1743855476379395, 'mae_torch': 1.390586495399475, 'se_torch': 6.468874931335449, 'relative_rmse_torch': 0.21216242874738755, 'relative_mae_torch': 0.16559096963573489}, 'Repeat': {'mse': 2.8702881, 'mae': 1.261266, 'se': 5.3471956, 'relative_rmse': 0.20174436, 'relative_mae': 0.15019149, 'mse_torch': 2.870288133621216, 'mae_torch': 1.2612659931182861, 'se_torch': 5.347195625305176, 'relative_rmse_torch': 0.20174435404524144, 'relative_mae_torch': 0.15019149075587518}}
