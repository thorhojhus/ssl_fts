Args in experiment:
Namespace(is_training=1, model_id='GD_336_720_S_channels_6', model='DLinear_FITS', data='custom', root_path='./dataset/', data_path='GD.csv', features='S', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
GD_336_720_S_channels_6
Use CPU
FITS cutoff frequency: 49

Model(
  (decomposition): SeriesDecomp(
    (moving_avg): MovingAvg(
      (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=49, out_features=154, bias=True)
  )
  (Linear_Seasonal): Linear(in_features=336, out_features=720, bias=True)
  (Linear_Trend): Linear(in_features=336, out_features=720, bias=True)
)

>>>>>>>start training : GD_336_720_S_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 9951
val 855
test 2425
	iters: 100, epoch: 1 | loss: 0.2023821
	speed: 0.0076s/iter; time left: 94.0495s
	iters: 200, epoch: 1 | loss: 0.1151606
	speed: 0.0035s/iter; time left: 42.2917s
	iters: 300, epoch: 1 | loss: 0.0667991
	speed: 0.0031s/iter; time left: 37.4902s
	iters: 400, epoch: 1 | loss: 0.0350121
	speed: 0.0035s/iter; time left: 42.0863s
	iters: 500, epoch: 1 | loss: 0.1339448
	speed: 0.0035s/iter; time left: 42.0472s
	iters: 600, epoch: 1 | loss: 0.0367007
	speed: 0.0031s/iter; time left: 37.0928s
	iters: 700, epoch: 1 | loss: 0.1633753
	speed: 0.0046s/iter; time left: 54.2034s
	iters: 800, epoch: 1 | loss: 0.0785390
	speed: 0.0044s/iter; time left: 50.9825s
	iters: 900, epoch: 1 | loss: 0.0304272
	speed: 0.0038s/iter; time left: 44.1883s
	iters: 1000, epoch: 1 | loss: 0.0191838
	speed: 0.0043s/iter; time left: 49.6353s
	iters: 1100, epoch: 1 | loss: 0.0217377
	speed: 0.0033s/iter; time left: 36.9385s
	iters: 1200, epoch: 1 | loss: 0.0556838
	speed: 0.0042s/iter; time left: 46.6328s
Epoch: 1 cost time: 4.7s
Epoch: 1, Steps: 1243 | Train Loss: 0.0657395 Vali Loss: 4.5200777 Test Loss: 20.0483665
Validation loss decreased (inf --> 4.520078).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0342531
	speed: 0.0099s/iter; time left: 109.4608s
	iters: 200, epoch: 2 | loss: 0.0091274
	speed: 0.0040s/iter; time left: 43.6706s
	iters: 300, epoch: 2 | loss: 0.0172787
	speed: 0.0034s/iter; time left: 37.1973s
	iters: 400, epoch: 2 | loss: 0.0674936
	speed: 0.0037s/iter; time left: 40.2910s
	iters: 500, epoch: 2 | loss: 0.0513978
	speed: 0.0037s/iter; time left: 39.6578s
	iters: 600, epoch: 2 | loss: 0.0311277
	speed: 0.0038s/iter; time left: 39.9445s
	iters: 700, epoch: 2 | loss: 0.0409293
	speed: 0.0032s/iter; time left: 33.0538s
	iters: 800, epoch: 2 | loss: 0.0253274
	speed: 0.0036s/iter; time left: 37.3819s
	iters: 900, epoch: 2 | loss: 0.0069869
	speed: 0.0040s/iter; time left: 40.7413s
	iters: 1000, epoch: 2 | loss: 0.0413971
	speed: 0.0034s/iter; time left: 34.6831s
	iters: 1100, epoch: 2 | loss: 0.0509394
	speed: 0.0037s/iter; time left: 37.6772s
	iters: 1200, epoch: 2 | loss: 0.0394302
	speed: 0.0035s/iter; time left: 34.5230s
Epoch: 2 cost time: 4.5s
Epoch: 2, Steps: 1243 | Train Loss: 0.0465280 Vali Loss: 3.6164818 Test Loss: 17.5829048
Validation loss decreased (4.520078 --> 3.616482).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0641203
	speed: 0.0086s/iter; time left: 84.7583s
	iters: 200, epoch: 3 | loss: 0.0739271
	speed: 0.0031s/iter; time left: 30.1291s
	iters: 300, epoch: 3 | loss: 0.0334085
	speed: 0.0029s/iter; time left: 27.5043s
	iters: 400, epoch: 3 | loss: 0.0206721
	speed: 0.0032s/iter; time left: 30.8035s
	iters: 500, epoch: 3 | loss: 0.0397036
	speed: 0.0035s/iter; time left: 32.8421s
	iters: 600, epoch: 3 | loss: 0.0299420
	speed: 0.0038s/iter; time left: 35.1100s
	iters: 700, epoch: 3 | loss: 0.0498726
	speed: 0.0035s/iter; time left: 32.0837s
	iters: 800, epoch: 3 | loss: 0.0222040
	speed: 0.0037s/iter; time left: 33.9642s
	iters: 900, epoch: 3 | loss: 0.0080534
	speed: 0.0034s/iter; time left: 30.7340s
	iters: 1000, epoch: 3 | loss: 0.0182575
	speed: 0.0033s/iter; time left: 29.5168s
	iters: 1100, epoch: 3 | loss: 0.0364863
	speed: 0.0030s/iter; time left: 26.9691s
	iters: 1200, epoch: 3 | loss: 0.0296219
	speed: 0.0031s/iter; time left: 27.4186s
Epoch: 3 cost time: 4.1s
Epoch: 3, Steps: 1243 | Train Loss: 0.0418019 Vali Loss: 4.5713091 Test Loss: 19.2929764
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0071826
	speed: 0.0090s/iter; time left: 77.2188s
	iters: 200, epoch: 4 | loss: 0.0474485
	speed: 0.0030s/iter; time left: 25.4025s
	iters: 300, epoch: 4 | loss: 0.0193652
	speed: 0.0030s/iter; time left: 24.7973s
	iters: 400, epoch: 4 | loss: 0.0159141
	speed: 0.0030s/iter; time left: 25.3206s
	iters: 500, epoch: 4 | loss: 0.0125891
	speed: 0.0032s/iter; time left: 26.3230s
	iters: 600, epoch: 4 | loss: 0.0602383
	speed: 0.0030s/iter; time left: 24.4149s
	iters: 700, epoch: 4 | loss: 0.0820611
	speed: 0.0044s/iter; time left: 35.0524s
	iters: 800, epoch: 4 | loss: 0.0183701
	speed: 0.0037s/iter; time left: 29.6234s
	iters: 900, epoch: 4 | loss: 0.0271803
	speed: 0.0047s/iter; time left: 36.4831s
	iters: 1000, epoch: 4 | loss: 0.0111462
	speed: 0.0039s/iter; time left: 30.0618s
	iters: 1100, epoch: 4 | loss: 0.0361875
	speed: 0.0034s/iter; time left: 25.4686s
	iters: 1200, epoch: 4 | loss: 0.0433061
	speed: 0.0031s/iter; time left: 23.3647s
Epoch: 4 cost time: 4.4s
Epoch: 4, Steps: 1243 | Train Loss: 0.0398897 Vali Loss: 4.5755982 Test Loss: 18.9465542
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0241623
	speed: 0.0085s/iter; time left: 62.8635s
	iters: 200, epoch: 5 | loss: 0.0260904
	speed: 0.0031s/iter; time left: 22.6663s
	iters: 300, epoch: 5 | loss: 0.0397238
	speed: 0.0045s/iter; time left: 32.4579s
	iters: 400, epoch: 5 | loss: 0.0138709
	speed: 0.0030s/iter; time left: 21.0720s
	iters: 500, epoch: 5 | loss: 0.0445117
	speed: 0.0031s/iter; time left: 21.2994s
	iters: 600, epoch: 5 | loss: 0.0282845
	speed: 0.0044s/iter; time left: 30.1138s
	iters: 700, epoch: 5 | loss: 0.1561582
	speed: 0.0037s/iter; time left: 25.2293s
	iters: 800, epoch: 5 | loss: 0.0089099
	speed: 0.0035s/iter; time left: 23.1918s
	iters: 900, epoch: 5 | loss: 0.0164417
	speed: 0.0034s/iter; time left: 22.6232s
	iters: 1000, epoch: 5 | loss: 0.0785231
	speed: 0.0044s/iter; time left: 28.2434s
	iters: 1100, epoch: 5 | loss: 0.0350335
	speed: 0.0045s/iter; time left: 28.7075s
	iters: 1200, epoch: 5 | loss: 0.0138449
	speed: 0.0033s/iter; time left: 20.3924s
Epoch: 5 cost time: 4.5s
Epoch: 5, Steps: 1243 | Train Loss: 0.0386963 Vali Loss: 4.7877083 Test Loss: 19.9498272
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : GD_336_720_S_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2425

Final Metrics:

DLinear_FITS MSE: 17.582903  MAE: 3.279742   SE: 37.847149  RRMSE: 0.271519   RMAE: 0.212370   (numpy)
DLinear_FITS MSE: 17.582905  MAE: 3.279741   SE: 37.847149  RRMSE: 0.271519   RMAE: 0.212370   (torch)

Repeat       MSE: 20.162743  MAE: 3.575489   SE: 46.713753  RRMSE: 0.290756   RMAE: 0.231521   (numpy)
Repeat       MSE: 20.162741  MAE: 3.575489   SE: 46.713760  RRMSE: 0.290756   RMAE: 0.231521   (torch)

Shapes: pred (2424, 720, 1), true (2424, 720, 1), naive_pred (2424, 720, 1), gt (2424, 1056, 1), metrics {'DLinear_FITS': {'mse': 17.582903, 'mae': 3.2797418, 'se': 37.84715, 'relative_rmse': 0.27151874, 'relative_mae': 0.21237049, 'mse_torch': 17.582904815673828, 'mae_torch': 3.279741048812866, 'se_torch': 37.84714889526367, 'relative_rmse_torch': 0.27151873830080747, 'relative_mae_torch': 0.21237043166544964}, 'Repeat': {'mse': 20.162743, 'mae': 3.5754886, 'se': 46.713753, 'relative_rmse': 0.29075643, 'relative_mae': 0.23152073, 'mse_torch': 20.16274070739746, 'mae_torch': 3.575488805770874, 'se_torch': 46.71376037597656, 'relative_rmse_torch': 0.29075639592843516, 'relative_mae_torch': 0.23152074806984826}}
