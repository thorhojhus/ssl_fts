Args in experiment:
Namespace(is_training=1, model_id='exchange_rate_336_720_M_channels_8', model='DLinear_FITS', data='custom', root_path='./dataset/', data_path='exchange_rate.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
exchange_rate_336_720_M_channels_8
Use CPU
FITS cutoff frequency: 49

Model(
  (decomposition): SeriesDecomp(
    (moving_avg): MovingAvg(
      (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=49, out_features=154, bias=True)
  )
  (Linear_Seasonal): Linear(in_features=336, out_features=720, bias=True)
  (Linear_Trend): Linear(in_features=336, out_features=720, bias=True)
)

>>>>>>>start training : exchange_rate_336_720_M_channels_8>>>>>>>>>>>>>>>>>>>>>>>>>>

train 4256
val 41
test 798
	iters: 100, epoch: 1 | loss: 0.7682103
	speed: 0.0132s/iter; time left: 68.6670s
	iters: 200, epoch: 1 | loss: 0.4520999
	speed: 0.0097s/iter; time left: 49.6214s
	iters: 300, epoch: 1 | loss: 0.5236138
	speed: 0.0101s/iter; time left: 50.7758s
	iters: 400, epoch: 1 | loss: 0.5816818
	speed: 0.0095s/iter; time left: 46.9372s
	iters: 500, epoch: 1 | loss: 0.6393548
	speed: 0.0110s/iter; time left: 52.8607s
Epoch: 1 cost time: 5.5s
Epoch: 1, Steps: 532 | Train Loss: 0.6318489 Vali Loss: 4.2222872 Test Loss: 1.5748826
Validation loss decreased (inf --> 4.222287).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.5476567
	speed: 0.0192s/iter; time left: 89.9994s
	iters: 200, epoch: 2 | loss: 0.4314909
	speed: 0.0085s/iter; time left: 39.1616s
	iters: 300, epoch: 2 | loss: 0.6996039
	speed: 0.0094s/iter; time left: 42.1036s
	iters: 400, epoch: 2 | loss: 0.6298603
	speed: 0.0097s/iter; time left: 42.4091s
	iters: 500, epoch: 2 | loss: 0.5330616
	speed: 0.0104s/iter; time left: 44.4947s
Epoch: 2 cost time: 5.2s
Epoch: 2, Steps: 532 | Train Loss: 0.5659069 Vali Loss: 3.6949284 Test Loss: 1.1655424
Validation loss decreased (4.222287 --> 3.694928).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.5636044
	speed: 0.0210s/iter; time left: 87.3785s
	iters: 200, epoch: 3 | loss: 0.7299379
	speed: 0.0093s/iter; time left: 37.8216s
	iters: 300, epoch: 3 | loss: 0.3963475
	speed: 0.0099s/iter; time left: 39.0008s
	iters: 400, epoch: 3 | loss: 0.5681641
	speed: 0.0101s/iter; time left: 38.9961s
	iters: 500, epoch: 3 | loss: 0.6268137
	speed: 0.0097s/iter; time left: 36.2968s
Epoch: 3 cost time: 5.6s
Epoch: 3, Steps: 532 | Train Loss: 0.5556470 Vali Loss: 3.9942346 Test Loss: 1.3603617
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.5118002
	speed: 0.0172s/iter; time left: 62.4259s
	iters: 200, epoch: 4 | loss: 0.4922279
	speed: 0.0120s/iter; time left: 42.2088s
	iters: 300, epoch: 4 | loss: 0.3841543
	speed: 0.0110s/iter; time left: 37.5273s
	iters: 400, epoch: 4 | loss: 0.5744175
	speed: 0.0104s/iter; time left: 34.4186s
	iters: 500, epoch: 4 | loss: 0.3523079
	speed: 0.0099s/iter; time left: 31.8565s
Epoch: 4 cost time: 5.7s
Epoch: 4, Steps: 532 | Train Loss: 0.5508215 Vali Loss: 3.5734856 Test Loss: 1.0743341
Validation loss decreased (3.694928 --> 3.573486).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.4498046
	speed: 0.0160s/iter; time left: 49.3941s
	iters: 200, epoch: 5 | loss: 0.4754164
	speed: 0.0211s/iter; time left: 63.1233s
	iters: 300, epoch: 5 | loss: 0.4574233
	speed: 0.0303s/iter; time left: 87.7761s
	iters: 400, epoch: 5 | loss: 0.4480920
	speed: 0.0163s/iter; time left: 45.6095s
	iters: 500, epoch: 5 | loss: 0.6898295
	speed: 0.0229s/iter; time left: 61.6687s
Epoch: 5 cost time: 10.3s
Epoch: 5, Steps: 532 | Train Loss: 0.5484225 Vali Loss: 3.4931972 Test Loss: 1.0227329
Validation loss decreased (3.573486 --> 3.493197).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.4679888
	speed: 0.0206s/iter; time left: 52.7251s
	iters: 200, epoch: 6 | loss: 0.4995545
	speed: 0.0109s/iter; time left: 26.8790s
	iters: 300, epoch: 6 | loss: 0.5172523
	speed: 0.0106s/iter; time left: 25.0661s
	iters: 400, epoch: 6 | loss: 0.5933162
	speed: 0.0107s/iter; time left: 24.2642s
	iters: 500, epoch: 6 | loss: 0.4955724
	speed: 0.0098s/iter; time left: 21.1960s
Epoch: 6 cost time: 5.8s
Epoch: 6, Steps: 532 | Train Loss: 0.5476608 Vali Loss: 3.3859985 Test Loss: 0.9624358
Validation loss decreased (3.493197 --> 3.385998).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.7336938
	speed: 0.0185s/iter; time left: 37.4437s
	iters: 200, epoch: 7 | loss: 0.5925007
	speed: 0.0126s/iter; time left: 24.2357s
	iters: 300, epoch: 7 | loss: 0.6462903
	speed: 0.0092s/iter; time left: 16.9121s
	iters: 400, epoch: 7 | loss: 0.4690056
	speed: 0.0092s/iter; time left: 15.9412s
	iters: 500, epoch: 7 | loss: 0.6506144
	speed: 0.0117s/iter; time left: 19.0580s
Epoch: 7 cost time: 5.7s
Epoch: 7, Steps: 532 | Train Loss: 0.5469639 Vali Loss: 3.5475106 Test Loss: 1.0531963
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.5855791
	speed: 0.0165s/iter; time left: 24.7359s
	iters: 200, epoch: 8 | loss: 0.4535218
	speed: 0.0098s/iter; time left: 13.6820s
	iters: 300, epoch: 8 | loss: 0.6873021
	speed: 0.0098s/iter; time left: 12.6556s
	iters: 400, epoch: 8 | loss: 0.6113371
	speed: 0.0108s/iter; time left: 12.9041s
	iters: 500, epoch: 8 | loss: 0.5541048
	speed: 0.0096s/iter; time left: 10.5482s
Epoch: 8 cost time: 5.3s
Epoch: 8, Steps: 532 | Train Loss: 0.5466202 Vali Loss: 3.6448638 Test Loss: 1.1182822
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.6563718
	speed: 0.0168s/iter; time left: 16.1953s
	iters: 200, epoch: 9 | loss: 0.4587416
	speed: 0.0095s/iter; time left: 8.2439s
	iters: 300, epoch: 9 | loss: 0.6033822
	speed: 0.0109s/iter; time left: 8.3566s
	iters: 400, epoch: 9 | loss: 0.5964652
	speed: 0.0099s/iter; time left: 6.5844s
	iters: 500, epoch: 9 | loss: 0.4218687
	speed: 0.0101s/iter; time left: 5.7052s
Epoch: 9 cost time: 5.4s
Epoch: 9, Steps: 532 | Train Loss: 0.5463343 Vali Loss: 3.6172366 Test Loss: 1.1048868
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : exchange_rate_336_720_M_channels_8<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 798

Final Metrics:

DLinear_FITS MSE: 0.962436   MAE: 0.735548   SE: 1.485080   RRMSE: 0.691195   RMAE: 0.518233   (numpy)
DLinear_FITS MSE: 0.962436   MAE: 0.735548   SE: 1.485080   RRMSE: 0.691195   RMAE: 0.518233   (torch)

Repeat       MSE: 0.812772   MAE: 0.677462   SE: 1.780517   RRMSE: 0.635183   RMAE: 0.477309   (numpy)
Repeat       MSE: 0.812772   MAE: 0.677462   SE: 1.780517   RRMSE: 0.635183   RMAE: 0.477309   (torch)

Shapes: pred (792, 720, 8), true (792, 720, 8), naive_pred (792, 720, 8), gt (792, 1056, 8), metrics {'DLinear_FITS': {'mse': 0.9624359, 'mae': 0.7355477, 'se': 1.4850796, 'relative_rmse': 0.69119465, 'relative_mae': 0.5182333, 'mse_torch': 0.962435781955719, 'mae_torch': 0.7355477213859558, 'se_torch': 1.4850796461105347, 'relative_rmse_torch': 0.6911946146469335, 'relative_mae_torch': 0.5182333044577719}, 'Repeat': {'mse': 0.81277204, 'mae': 0.67746186, 'se': 1.7805175, 'relative_rmse': 0.635183, 'relative_mae': 0.47730866, 'mse_torch': 0.8127721548080444, 'mae_torch': 0.6774619221687317, 'se_torch': 1.7805174589157104, 'relative_rmse_torch': 0.6351830106679126, 'relative_mae_torch': 0.4773087052846645}}
