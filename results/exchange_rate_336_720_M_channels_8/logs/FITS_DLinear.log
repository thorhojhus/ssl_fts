Args in experiment:
Namespace(is_training=1, model_id='exchange_rate_336_720_M_channels_8', model='FITS_DLinear', data='custom', root_path='./dataset/', data_path='exchange_rate.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
exchange_rate_336_720_M_channels_8
Use CPU

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=168, out_features=528, bias=True)
  )
  (dlinear): Model(
    (decompsition): series_decomp(
      (moving_avg): moving_avg(
        (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
      )
    )
    (Linear_Seasonal): Linear(in_features=336, out_features=720, bias=True)
    (Linear_Trend): Linear(in_features=336, out_features=720, bias=True)
    (Linear_Decoder): Linear(in_features=336, out_features=720, bias=True)
  )
)

>>>>>>>start training : exchange_rate_336_720_M_channels_8>>>>>>>>>>>>>>>>>>>>>>>>>>

train 4256
val 41
test 798
	iters: 100, epoch: 1 | loss: 0.6979865
	speed: 0.0117s/iter; time left: 60.8266s
	iters: 200, epoch: 1 | loss: 0.7787716
	speed: 0.0079s/iter; time left: 40.3394s
	iters: 300, epoch: 1 | loss: 0.4870316
	speed: 0.0068s/iter; time left: 33.9640s
	iters: 400, epoch: 1 | loss: 0.6620155
	speed: 0.0078s/iter; time left: 38.6229s
	iters: 500, epoch: 1 | loss: 0.5066384
	speed: 0.0069s/iter; time left: 33.0306s
Epoch: 1 cost time: 4.0s
Epoch: 1, Steps: 532 | Train Loss: 0.5749154 Vali Loss: 3.6970031 Test Loss: 0.9580168
Validation loss decreased (inf --> 3.697003).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.5593910
	speed: 0.0144s/iter; time left: 67.5757s
	iters: 200, epoch: 2 | loss: 0.5561631
	speed: 0.0070s/iter; time left: 32.3097s
	iters: 300, epoch: 2 | loss: 0.3801125
	speed: 0.0112s/iter; time left: 50.2676s
	iters: 400, epoch: 2 | loss: 0.6438953
	speed: 0.0066s/iter; time left: 29.0096s
	iters: 500, epoch: 2 | loss: 0.4631935
	speed: 0.0094s/iter; time left: 40.1325s
Epoch: 2 cost time: 4.3s
Epoch: 2, Steps: 532 | Train Loss: 0.5597952 Vali Loss: 3.9471505 Test Loss: 1.2323377
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.5137656
	speed: 0.0119s/iter; time left: 49.3821s
	iters: 200, epoch: 3 | loss: 0.5780509
	speed: 0.0085s/iter; time left: 34.3797s
	iters: 300, epoch: 3 | loss: 0.6791294
	speed: 0.0070s/iter; time left: 27.7402s
	iters: 400, epoch: 3 | loss: 0.5605381
	speed: 0.0069s/iter; time left: 26.5458s
	iters: 500, epoch: 3 | loss: 0.4215261
	speed: 0.0066s/iter; time left: 24.8441s
Epoch: 3 cost time: 3.8s
Epoch: 3, Steps: 532 | Train Loss: 0.5530450 Vali Loss: 3.8869622 Test Loss: 1.1897981
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.5179462
	speed: 0.0146s/iter; time left: 52.9107s
	iters: 200, epoch: 4 | loss: 0.5768820
	speed: 0.0074s/iter; time left: 25.9140s
	iters: 300, epoch: 4 | loss: 0.6896210
	speed: 0.0066s/iter; time left: 22.7688s
	iters: 400, epoch: 4 | loss: 0.5222732
	speed: 0.0062s/iter; time left: 20.4787s
	iters: 500, epoch: 4 | loss: 0.5195463
	speed: 0.0063s/iter; time left: 20.4769s
Epoch: 4 cost time: 3.7s
Epoch: 4, Steps: 532 | Train Loss: 0.5493449 Vali Loss: 3.6111379 Test Loss: 1.0005908
Validation loss decreased (3.697003 --> 3.611138).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.6212180
	speed: 0.0114s/iter; time left: 35.3060s
	iters: 200, epoch: 5 | loss: 0.6441243
	speed: 0.0062s/iter; time left: 18.5150s
	iters: 300, epoch: 5 | loss: 0.6827067
	speed: 0.0070s/iter; time left: 20.1833s
	iters: 400, epoch: 5 | loss: 0.4326709
	speed: 0.0096s/iter; time left: 26.9181s
	iters: 500, epoch: 5 | loss: 0.4941525
	speed: 0.0079s/iter; time left: 21.2609s
Epoch: 5 cost time: 3.9s
Epoch: 5, Steps: 532 | Train Loss: 0.5476132 Vali Loss: 3.5265057 Test Loss: 0.9608530
Validation loss decreased (3.611138 --> 3.526506).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.5937285
	speed: 0.0130s/iter; time left: 33.3872s
	iters: 200, epoch: 6 | loss: 0.4638220
	speed: 0.0074s/iter; time left: 18.1972s
	iters: 300, epoch: 6 | loss: 0.5182941
	speed: 0.0070s/iter; time left: 16.4262s
	iters: 400, epoch: 6 | loss: 0.6743314
	speed: 0.0063s/iter; time left: 14.3363s
	iters: 500, epoch: 6 | loss: 0.5259095
	speed: 0.0060s/iter; time left: 13.0195s
Epoch: 6 cost time: 3.6s
Epoch: 6, Steps: 532 | Train Loss: 0.5471286 Vali Loss: 3.8328309 Test Loss: 1.1741042
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.3952178
	speed: 0.0108s/iter; time left: 21.8769s
	iters: 200, epoch: 7 | loss: 0.7639579
	speed: 0.0057s/iter; time left: 11.0698s
	iters: 300, epoch: 7 | loss: 0.4974650
	speed: 0.0058s/iter; time left: 10.6669s
	iters: 400, epoch: 7 | loss: 0.6576071
	speed: 0.0062s/iter; time left: 10.6518s
	iters: 500, epoch: 7 | loss: 0.5823266
	speed: 0.0074s/iter; time left: 11.9931s
Epoch: 7 cost time: 3.3s
Epoch: 7, Steps: 532 | Train Loss: 0.5464761 Vali Loss: 3.6282947 Test Loss: 1.0227621
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.6668542
	speed: 0.0108s/iter; time left: 16.1336s
	iters: 200, epoch: 8 | loss: 0.6306334
	speed: 0.0059s/iter; time left: 8.2785s
	iters: 300, epoch: 8 | loss: 0.5864643
	speed: 0.0081s/iter; time left: 10.4727s
	iters: 400, epoch: 8 | loss: 0.5655026
	speed: 0.0064s/iter; time left: 7.7118s
	iters: 500, epoch: 8 | loss: 0.6304771
	speed: 0.0062s/iter; time left: 6.8393s
Epoch: 8 cost time: 3.4s
Epoch: 8, Steps: 532 | Train Loss: 0.5462634 Vali Loss: 3.7376473 Test Loss: 1.0972844
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : exchange_rate_336_720_M_channels_8<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 798

Final Metrics:

FITS_DLinear MSE: 0.960853   MAE: 0.735964   SE: 1.728438   RRMSE: 0.690626   RMAE: 0.518527   (numpy)
FITS_DLinear MSE: 0.960853   MAE: 0.735964   SE: 1.728438   RRMSE: 0.690626   RMAE: 0.518527   (torch)

Repeat       MSE: 0.812772   MAE: 0.677462   SE: 1.780517   RRMSE: 0.635183   RMAE: 0.477309   (numpy)
Repeat       MSE: 0.812772   MAE: 0.677462   SE: 1.780517   RRMSE: 0.635183   RMAE: 0.477309   (torch)

Shapes: pred (792, 720, 8), true (792, 720, 8), naive_pred (792, 720, 8), gt (792, 1056, 8), metrics {'FITS_DLinear': {'mse': 0.96085334, 'mae': 0.735964, 'se': 1.7284378, 'relative_rmse': 0.69062614, 'relative_mae': 0.5185266, 'mse_torch': 0.960852861404419, 'mae_torch': 0.735964298248291, 'se_torch': 1.7284377813339233, 'relative_rmse_torch': 0.6906259759797548, 'relative_mae_torch': 0.5185268054742957}, 'Repeat': {'mse': 0.81277204, 'mae': 0.67746186, 'se': 1.7805175, 'relative_rmse': 0.635183, 'relative_mae': 0.47730866, 'mse_torch': 0.8127721548080444, 'mae_torch': 0.6774619221687317, 'se_torch': 1.7805174589157104, 'relative_rmse_torch': 0.6351830106679126, 'relative_mae_torch': 0.4773087052846645}}
