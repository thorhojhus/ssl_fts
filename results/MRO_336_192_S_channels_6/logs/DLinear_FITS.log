Args in experiment:
Namespace(is_training=1, model_id='MRO_336_192_S_channels_6', model='DLinear_FITS', data='custom', root_path='./dataset/', data_path='MRO.csv', features='S', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
MRO_336_192_S_channels_6
Use CPU
FITS cutoff frequency: 49

Model(
  (decomposition): SeriesDecomp(
    (moving_avg): MovingAvg(
      (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=49, out_features=77, bias=True)
  )
  (Linear_Seasonal): Linear(in_features=336, out_features=192, bias=True)
  (Linear_Trend): Linear(in_features=336, out_features=192, bias=True)
)

>>>>>>>start training : MRO_336_192_S_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10479
val 1383
test 2953
	iters: 100, epoch: 1 | loss: 0.0707117
	speed: 0.0060s/iter; time left: 77.3582s
	iters: 200, epoch: 1 | loss: 0.0685879
	speed: 0.0026s/iter; time left: 33.2460s
	iters: 300, epoch: 1 | loss: 0.0178450
	speed: 0.0019s/iter; time left: 23.7393s
	iters: 400, epoch: 1 | loss: 0.0682386
	speed: 0.0019s/iter; time left: 23.5582s
	iters: 500, epoch: 1 | loss: 0.0436104
	speed: 0.0020s/iter; time left: 24.7758s
	iters: 600, epoch: 1 | loss: 0.1134655
	speed: 0.0018s/iter; time left: 22.9021s
	iters: 700, epoch: 1 | loss: 0.0383242
	speed: 0.0019s/iter; time left: 23.1750s
	iters: 800, epoch: 1 | loss: 0.0750952
	speed: 0.0020s/iter; time left: 24.6702s
	iters: 900, epoch: 1 | loss: 0.1014476
	speed: 0.0021s/iter; time left: 25.9302s
	iters: 1000, epoch: 1 | loss: 0.1003467
	speed: 0.0020s/iter; time left: 24.3782s
	iters: 1100, epoch: 1 | loss: 0.0423507
	speed: 0.0018s/iter; time left: 22.0350s
	iters: 1200, epoch: 1 | loss: 0.0634230
	speed: 0.0024s/iter; time left: 28.4818s
	iters: 1300, epoch: 1 | loss: 0.0512202
	speed: 0.0024s/iter; time left: 28.7132s
Epoch: 1 cost time: 2.7s
Epoch: 1, Steps: 1309 | Train Loss: 0.0713918 Vali Loss: 4.9390717 Test Loss: 6.3404536
Validation loss decreased (inf --> 4.939072).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0950385
	speed: 0.0055s/iter; time left: 64.5329s
	iters: 200, epoch: 2 | loss: 0.0384876
	speed: 0.0022s/iter; time left: 25.4821s
	iters: 300, epoch: 2 | loss: 0.0584999
	speed: 0.0020s/iter; time left: 23.1007s
	iters: 400, epoch: 2 | loss: 0.0452373
	speed: 0.0019s/iter; time left: 21.1707s
	iters: 500, epoch: 2 | loss: 0.0532214
	speed: 0.0025s/iter; time left: 28.4378s
	iters: 600, epoch: 2 | loss: 0.0253001
	speed: 0.0021s/iter; time left: 23.2418s
	iters: 700, epoch: 2 | loss: 0.0597744
	speed: 0.0022s/iter; time left: 23.9413s
	iters: 800, epoch: 2 | loss: 0.0683085
	speed: 0.0018s/iter; time left: 19.6745s
	iters: 900, epoch: 2 | loss: 0.0809756
	speed: 0.0022s/iter; time left: 23.4319s
	iters: 1000, epoch: 2 | loss: 0.0172077
	speed: 0.0017s/iter; time left: 18.7892s
	iters: 1100, epoch: 2 | loss: 0.0880520
	speed: 0.0019s/iter; time left: 20.3436s
	iters: 1200, epoch: 2 | loss: 0.0301032
	speed: 0.0019s/iter; time left: 19.9057s
	iters: 1300, epoch: 2 | loss: 0.0166413
	speed: 0.0019s/iter; time left: 19.6001s
Epoch: 2 cost time: 2.6s
Epoch: 2, Steps: 1309 | Train Loss: 0.0602549 Vali Loss: 5.2249470 Test Loss: 7.0071893
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0738378
	speed: 0.0052s/iter; time left: 53.7008s
	iters: 200, epoch: 3 | loss: 0.0766285
	speed: 0.0018s/iter; time left: 18.5782s
	iters: 300, epoch: 3 | loss: 0.0669936
	speed: 0.0021s/iter; time left: 20.9908s
	iters: 400, epoch: 3 | loss: 0.0378201
	speed: 0.0018s/iter; time left: 18.3607s
	iters: 500, epoch: 3 | loss: 0.2442969
	speed: 0.0020s/iter; time left: 19.8035s
	iters: 600, epoch: 3 | loss: 0.0787484
	speed: 0.0018s/iter; time left: 17.7489s
	iters: 700, epoch: 3 | loss: 0.0541828
	speed: 0.0018s/iter; time left: 17.4287s
	iters: 800, epoch: 3 | loss: 0.0214324
	speed: 0.0019s/iter; time left: 18.3608s
	iters: 900, epoch: 3 | loss: 0.0524784
	speed: 0.0022s/iter; time left: 21.2630s
	iters: 1000, epoch: 3 | loss: 0.0481199
	speed: 0.0021s/iter; time left: 20.3022s
	iters: 1100, epoch: 3 | loss: 0.2218703
	speed: 0.0031s/iter; time left: 28.6677s
	iters: 1200, epoch: 3 | loss: 0.0117270
	speed: 0.0038s/iter; time left: 34.9349s
	iters: 1300, epoch: 3 | loss: 0.0118117
	speed: 0.0018s/iter; time left: 16.4884s
Epoch: 3 cost time: 2.8s
Epoch: 3, Steps: 1309 | Train Loss: 0.0567137 Vali Loss: 4.6728730 Test Loss: 6.0089808
Validation loss decreased (4.939072 --> 4.672873).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0235925
	speed: 0.0054s/iter; time left: 49.1769s
	iters: 200, epoch: 4 | loss: 0.0572683
	speed: 0.0020s/iter; time left: 17.9255s
	iters: 300, epoch: 4 | loss: 0.0572122
	speed: 0.0025s/iter; time left: 22.5780s
	iters: 400, epoch: 4 | loss: 0.0630717
	speed: 0.0022s/iter; time left: 19.1823s
	iters: 500, epoch: 4 | loss: 0.0240338
	speed: 0.0019s/iter; time left: 16.8919s
	iters: 600, epoch: 4 | loss: 0.0424683
	speed: 0.0020s/iter; time left: 16.8134s
	iters: 700, epoch: 4 | loss: 0.1383822
	speed: 0.0034s/iter; time left: 28.7906s
	iters: 800, epoch: 4 | loss: 0.0528934
	speed: 0.0028s/iter; time left: 23.6825s
	iters: 900, epoch: 4 | loss: 0.0625103
	speed: 0.0022s/iter; time left: 18.4005s
	iters: 1000, epoch: 4 | loss: 0.0630551
	speed: 0.0027s/iter; time left: 22.4114s
	iters: 1100, epoch: 4 | loss: 0.1240820
	speed: 0.0030s/iter; time left: 23.8820s
	iters: 1200, epoch: 4 | loss: 0.0151976
	speed: 0.0023s/iter; time left: 18.5883s
	iters: 1300, epoch: 4 | loss: 0.0411334
	speed: 0.0020s/iter; time left: 15.6239s
Epoch: 4 cost time: 3.1s
Epoch: 4, Steps: 1309 | Train Loss: 0.0552216 Vali Loss: 4.5013919 Test Loss: 5.7958694
Validation loss decreased (4.672873 --> 4.501392).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1101893
	speed: 0.0056s/iter; time left: 43.2735s
	iters: 200, epoch: 5 | loss: 0.0283154
	speed: 0.0019s/iter; time left: 14.5525s
	iters: 300, epoch: 5 | loss: 0.0468508
	speed: 0.0019s/iter; time left: 14.5505s
	iters: 400, epoch: 5 | loss: 0.0243144
	speed: 0.0038s/iter; time left: 28.6315s
	iters: 500, epoch: 5 | loss: 0.0161094
	speed: 0.0024s/iter; time left: 17.6872s
	iters: 600, epoch: 5 | loss: 0.0718931
	speed: 0.0021s/iter; time left: 15.4529s
	iters: 700, epoch: 5 | loss: 0.2027245
	speed: 0.0021s/iter; time left: 14.8393s
	iters: 800, epoch: 5 | loss: 0.0519794
	speed: 0.0030s/iter; time left: 20.9538s
	iters: 900, epoch: 5 | loss: 0.0613491
	speed: 0.0021s/iter; time left: 14.3541s
	iters: 1000, epoch: 5 | loss: 0.0196929
	speed: 0.0019s/iter; time left: 13.2011s
	iters: 1100, epoch: 5 | loss: 0.0903378
	speed: 0.0019s/iter; time left: 13.0378s
	iters: 1200, epoch: 5 | loss: 0.0512414
	speed: 0.0018s/iter; time left: 12.1458s
	iters: 1300, epoch: 5 | loss: 0.1458881
	speed: 0.0019s/iter; time left: 12.7807s
Epoch: 5 cost time: 3.0s
Epoch: 5, Steps: 1309 | Train Loss: 0.0541458 Vali Loss: 4.4777813 Test Loss: 5.6732154
Validation loss decreased (4.501392 --> 4.477781).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0675128
	speed: 0.0053s/iter; time left: 34.4356s
	iters: 200, epoch: 6 | loss: 0.0459828
	speed: 0.0019s/iter; time left: 11.8251s
	iters: 300, epoch: 6 | loss: 0.0783906
	speed: 0.0021s/iter; time left: 13.3079s
	iters: 400, epoch: 6 | loss: 0.0776301
	speed: 0.0018s/iter; time left: 11.2091s
	iters: 500, epoch: 6 | loss: 0.0786297
	speed: 0.0021s/iter; time left: 12.8808s
	iters: 600, epoch: 6 | loss: 0.0445519
	speed: 0.0020s/iter; time left: 12.1103s
	iters: 700, epoch: 6 | loss: 0.0636554
	speed: 0.0030s/iter; time left: 17.4144s
	iters: 800, epoch: 6 | loss: 0.0262391
	speed: 0.0020s/iter; time left: 11.5687s
	iters: 900, epoch: 6 | loss: 0.0496695
	speed: 0.0033s/iter; time left: 18.9134s
	iters: 1000, epoch: 6 | loss: 0.0297410
	speed: 0.0042s/iter; time left: 23.4916s
	iters: 1100, epoch: 6 | loss: 0.0205445
	speed: 0.0042s/iter; time left: 22.8726s
	iters: 1200, epoch: 6 | loss: 0.0620963
	speed: 0.0025s/iter; time left: 13.2939s
	iters: 1300, epoch: 6 | loss: 0.0377362
	speed: 0.0022s/iter; time left: 11.4323s
Epoch: 6 cost time: 3.4s
Epoch: 6, Steps: 1309 | Train Loss: 0.0536652 Vali Loss: 4.4693985 Test Loss: 5.7136250
Validation loss decreased (4.477781 --> 4.469398).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2661085
	speed: 0.0081s/iter; time left: 41.4925s
	iters: 200, epoch: 7 | loss: 0.0940849
	speed: 0.0026s/iter; time left: 13.3342s
	iters: 300, epoch: 7 | loss: 0.0348980
	speed: 0.0046s/iter; time left: 22.5775s
	iters: 400, epoch: 7 | loss: 0.0326100
	speed: 0.0023s/iter; time left: 10.9075s
	iters: 500, epoch: 7 | loss: 0.0223663
	speed: 0.0021s/iter; time left: 9.9419s
	iters: 600, epoch: 7 | loss: 0.0392921
	speed: 0.0020s/iter; time left: 9.0511s
	iters: 700, epoch: 7 | loss: 0.0473264
	speed: 0.0027s/iter; time left: 12.2559s
	iters: 800, epoch: 7 | loss: 0.0526938
	speed: 0.0020s/iter; time left: 8.7481s
	iters: 900, epoch: 7 | loss: 0.0743827
	speed: 0.0023s/iter; time left: 10.1764s
	iters: 1000, epoch: 7 | loss: 0.0201596
	speed: 0.0020s/iter; time left: 8.2861s
	iters: 1100, epoch: 7 | loss: 0.2549347
	speed: 0.0018s/iter; time left: 7.5049s
	iters: 1200, epoch: 7 | loss: 0.0591184
	speed: 0.0041s/iter; time left: 16.7076s
	iters: 1300, epoch: 7 | loss: 0.0411364
	speed: 0.0031s/iter; time left: 12.1314s
Epoch: 7 cost time: 3.5s
Epoch: 7, Steps: 1309 | Train Loss: 0.0533915 Vali Loss: 4.6102118 Test Loss: 6.0788860
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0895149
	speed: 0.0065s/iter; time left: 24.9355s
	iters: 200, epoch: 8 | loss: 0.0635451
	speed: 0.0021s/iter; time left: 7.8290s
	iters: 300, epoch: 8 | loss: 0.0240774
	speed: 0.0020s/iter; time left: 7.1217s
	iters: 400, epoch: 8 | loss: 0.0173905
	speed: 0.0019s/iter; time left: 6.8030s
	iters: 500, epoch: 8 | loss: 0.0245995
	speed: 0.0025s/iter; time left: 8.6965s
	iters: 600, epoch: 8 | loss: 0.0315477
	speed: 0.0026s/iter; time left: 8.5426s
	iters: 700, epoch: 8 | loss: 0.0326179
	speed: 0.0022s/iter; time left: 7.1639s
	iters: 800, epoch: 8 | loss: 0.0747315
	speed: 0.0022s/iter; time left: 6.9770s
	iters: 900, epoch: 8 | loss: 0.0305921
	speed: 0.0025s/iter; time left: 7.4293s
	iters: 1000, epoch: 8 | loss: 0.0151170
	speed: 0.0019s/iter; time left: 5.6381s
	iters: 1100, epoch: 8 | loss: 0.0547120
	speed: 0.0021s/iter; time left: 6.0291s
	iters: 1200, epoch: 8 | loss: 0.0882586
	speed: 0.0022s/iter; time left: 6.0922s
	iters: 1300, epoch: 8 | loss: 0.0542144
	speed: 0.0027s/iter; time left: 7.0239s
Epoch: 8 cost time: 3.0s
Epoch: 8, Steps: 1309 | Train Loss: 0.0532943 Vali Loss: 4.5328655 Test Loss: 5.8910694
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0612390
	speed: 0.0058s/iter; time left: 14.6051s
	iters: 200, epoch: 9 | loss: 0.0334319
	speed: 0.0021s/iter; time left: 5.0235s
	iters: 300, epoch: 9 | loss: 0.0353439
	speed: 0.0021s/iter; time left: 4.9223s
	iters: 400, epoch: 9 | loss: 0.0782050
	speed: 0.0024s/iter; time left: 5.4183s
	iters: 500, epoch: 9 | loss: 0.0368471
	speed: 0.0029s/iter; time left: 6.2233s
	iters: 600, epoch: 9 | loss: 0.0225483
	speed: 0.0023s/iter; time left: 4.7251s
	iters: 700, epoch: 9 | loss: 0.0939254
	speed: 0.0026s/iter; time left: 4.9921s
	iters: 800, epoch: 9 | loss: 0.0231548
	speed: 0.0025s/iter; time left: 4.5733s
	iters: 900, epoch: 9 | loss: 0.0165722
	speed: 0.0028s/iter; time left: 4.8630s
	iters: 1000, epoch: 9 | loss: 0.0215147
	speed: 0.0022s/iter; time left: 3.4884s
	iters: 1100, epoch: 9 | loss: 0.0450136
	speed: 0.0022s/iter; time left: 3.3029s
	iters: 1200, epoch: 9 | loss: 0.0395676
	speed: 0.0020s/iter; time left: 2.7799s
	iters: 1300, epoch: 9 | loss: 0.0412615
	speed: 0.0019s/iter; time left: 2.4760s
Epoch: 9 cost time: 3.0s
Epoch: 9, Steps: 1309 | Train Loss: 0.0532502 Vali Loss: 4.5502853 Test Loss: 5.9646096
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : MRO_336_192_S_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2953

Final Metrics:

DLinear_FITS MSE: 5.713626   MAE: 1.824526   SE: 12.241936  RRMSE: 0.287565   RMAE: 0.219498   (numpy)
DLinear_FITS MSE: 5.713626   MAE: 1.824526   SE: 12.241936  RRMSE: 0.287565   RMAE: 0.219498   (torch)

Repeat       MSE: 5.362151   MAE: 1.761319   SE: 10.656660  RRMSE: 0.278580   RMAE: 0.211894   (numpy)
Repeat       MSE: 5.362151   MAE: 1.761319   SE: 10.656659  RRMSE: 0.278580   RMAE: 0.211894   (torch)

Shapes: pred (2952, 192, 1), true (2952, 192, 1), naive_pred (2952, 192, 1), gt (2952, 528, 1), metrics {'DLinear_FITS': {'mse': 5.7136264, 'mae': 1.8245257, 'se': 12.241936, 'relative_rmse': 0.287565, 'relative_mae': 0.21949776, 'mse_torch': 5.713626384735107, 'mae_torch': 1.824526071548462, 'se_torch': 12.241935729980469, 'relative_rmse_torch': 0.2875649957836327, 'relative_mae_torch': 0.21949780129811067}, 'Repeat': {'mse': 5.3621507, 'mae': 1.7613189, 'se': 10.65666, 'relative_rmse': 0.2785798, 'relative_mae': 0.21189372, 'mse_torch': 5.362151145935059, 'mae_torch': 1.7613186836242676, 'se_torch': 10.656659126281738, 'relative_rmse_torch': 0.27857980269196864, 'relative_mae_torch': 0.21189369911973907}}
