Args in experiment:
Namespace(is_training=1, model_id='GD_336_336_S_channels_6', model='FITS10', data='custom', root_path='./dataset/', data_path='GD.csv', features='S', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
GD_336_336_S_channels_6
Use CPU
FITS cutoff frequency: 10

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=10, out_features=20, bias=True)
  )
)

>>>>>>>start training : GD_336_336_S_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10335
val 1239
test 2809
	iters: 100, epoch: 1 | loss: 0.0154007
	speed: 0.0047s/iter; time left: 59.8013s
	iters: 200, epoch: 1 | loss: 0.0547618
	speed: 0.0004s/iter; time left: 4.5045s
	iters: 300, epoch: 1 | loss: 0.1001073
	speed: 0.0004s/iter; time left: 4.4184s
	iters: 400, epoch: 1 | loss: 0.0029570
	speed: 0.0004s/iter; time left: 4.3931s
	iters: 500, epoch: 1 | loss: 0.0771850
	speed: 0.0004s/iter; time left: 4.3445s
	iters: 600, epoch: 1 | loss: 0.1181986
	speed: 0.0003s/iter; time left: 4.2818s
	iters: 700, epoch: 1 | loss: 0.0974250
	speed: 0.0004s/iter; time left: 4.4732s
	iters: 800, epoch: 1 | loss: 0.0915520
	speed: 0.0004s/iter; time left: 4.6767s
	iters: 900, epoch: 1 | loss: 0.0532467
	speed: 0.0004s/iter; time left: 4.2527s
	iters: 1000, epoch: 1 | loss: 0.1640217
	speed: 0.0003s/iter; time left: 4.1686s
	iters: 1100, epoch: 1 | loss: 0.0244449
	speed: 0.0003s/iter; time left: 4.1119s
	iters: 1200, epoch: 1 | loss: 0.0717097
	speed: 0.0003s/iter; time left: 4.0645s
Epoch: 1 cost time: 0.5s
Epoch: 1, Steps: 1291 | Train Loss: 0.0702907 Vali Loss: 1.5004572 Test Loss: 10.5242023
Validation loss decreased (inf --> 1.500457).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0015550
	speed: 0.0017s/iter; time left: 19.0762s
	iters: 200, epoch: 2 | loss: 0.1534648
	speed: 0.0003s/iter; time left: 3.9643s
	iters: 300, epoch: 2 | loss: 0.1019198
	speed: 0.0004s/iter; time left: 3.9701s
	iters: 400, epoch: 2 | loss: 0.1646120
	speed: 0.0003s/iter; time left: 3.8926s
	iters: 500, epoch: 2 | loss: 0.0766589
	speed: 0.0003s/iter; time left: 3.8468s
	iters: 600, epoch: 2 | loss: 0.1008640
	speed: 0.0003s/iter; time left: 3.8129s
	iters: 700, epoch: 2 | loss: 0.0081802
	speed: 0.0003s/iter; time left: 3.7987s
	iters: 800, epoch: 2 | loss: 0.0710889
	speed: 0.0003s/iter; time left: 3.7460s
	iters: 900, epoch: 2 | loss: 0.1032682
	speed: 0.0003s/iter; time left: 3.6991s
	iters: 1000, epoch: 2 | loss: 0.0488887
	speed: 0.0003s/iter; time left: 3.6829s
	iters: 1100, epoch: 2 | loss: 0.0056608
	speed: 0.0003s/iter; time left: 3.6374s
	iters: 1200, epoch: 2 | loss: 0.0004330
	speed: 0.0004s/iter; time left: 3.7242s
Epoch: 2 cost time: 0.4s
Epoch: 2, Steps: 1291 | Train Loss: 0.0612985 Vali Loss: 1.4434111 Test Loss: 9.6948757
Validation loss decreased (1.500457 --> 1.443411).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0520893
	speed: 0.0016s/iter; time left: 16.7727s
	iters: 200, epoch: 3 | loss: 0.0305535
	speed: 0.0003s/iter; time left: 3.4927s
	iters: 300, epoch: 3 | loss: 0.0762944
	speed: 0.0003s/iter; time left: 3.4650s
	iters: 400, epoch: 3 | loss: 0.1389148
	speed: 0.0003s/iter; time left: 3.4145s
	iters: 500, epoch: 3 | loss: 0.0249599
	speed: 0.0003s/iter; time left: 3.3868s
	iters: 600, epoch: 3 | loss: 0.0740762
	speed: 0.0003s/iter; time left: 3.3368s
	iters: 700, epoch: 3 | loss: 0.0275076
	speed: 0.0003s/iter; time left: 3.3015s
	iters: 800, epoch: 3 | loss: 0.0859185
	speed: 0.0003s/iter; time left: 3.2783s
	iters: 900, epoch: 3 | loss: 0.0089502
	speed: 0.0003s/iter; time left: 3.2333s
	iters: 1000, epoch: 3 | loss: 0.0648273
	speed: 0.0003s/iter; time left: 3.1976s
	iters: 1100, epoch: 3 | loss: 0.1107685
	speed: 0.0003s/iter; time left: 3.1926s
	iters: 1200, epoch: 3 | loss: 0.1482623
	speed: 0.0003s/iter; time left: 3.1497s
Epoch: 3 cost time: 0.4s
Epoch: 3, Steps: 1291 | Train Loss: 0.0592840 Vali Loss: 1.4234358 Test Loss: 9.4445848
Validation loss decreased (1.443411 --> 1.423436).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0079870
	speed: 0.0017s/iter; time left: 14.8352s
	iters: 200, epoch: 4 | loss: 0.1056997
	speed: 0.0003s/iter; time left: 3.0621s
	iters: 300, epoch: 4 | loss: 0.0633605
	speed: 0.0003s/iter; time left: 3.0348s
	iters: 400, epoch: 4 | loss: 0.0259074
	speed: 0.0003s/iter; time left: 2.9953s
	iters: 500, epoch: 4 | loss: 0.0083786
	speed: 0.0003s/iter; time left: 2.9354s
	iters: 600, epoch: 4 | loss: 0.0473685
	speed: 0.0003s/iter; time left: 2.8958s
	iters: 700, epoch: 4 | loss: 0.0560921
	speed: 0.0003s/iter; time left: 2.8659s
	iters: 800, epoch: 4 | loss: 0.0788726
	speed: 0.0003s/iter; time left: 2.8658s
	iters: 900, epoch: 4 | loss: 0.0269117
	speed: 0.0003s/iter; time left: 2.7926s
	iters: 1000, epoch: 4 | loss: 0.0697200
	speed: 0.0003s/iter; time left: 2.7701s
	iters: 1100, epoch: 4 | loss: 0.0482282
	speed: 0.0003s/iter; time left: 2.7196s
	iters: 1200, epoch: 4 | loss: 0.0735558
	speed: 0.0003s/iter; time left: 2.6817s
Epoch: 4 cost time: 0.4s
Epoch: 4, Steps: 1291 | Train Loss: 0.0586059 Vali Loss: 1.4179667 Test Loss: 9.3710718
Validation loss decreased (1.423436 --> 1.417967).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0448944
	speed: 0.0016s/iter; time left: 12.5171s
	iters: 200, epoch: 5 | loss: 0.0846993
	speed: 0.0003s/iter; time left: 2.5885s
	iters: 300, epoch: 5 | loss: 0.0734320
	speed: 0.0004s/iter; time left: 2.7315s
	iters: 400, epoch: 5 | loss: 0.1571045
	speed: 0.0004s/iter; time left: 2.6872s
	iters: 500, epoch: 5 | loss: 0.0240932
	speed: 0.0003s/iter; time left: 2.5111s
	iters: 600, epoch: 5 | loss: 0.1007228
	speed: 0.0003s/iter; time left: 2.4974s
	iters: 700, epoch: 5 | loss: 0.0557546
	speed: 0.0003s/iter; time left: 2.4359s
	iters: 800, epoch: 5 | loss: 0.1625173
	speed: 0.0003s/iter; time left: 2.3882s
	iters: 900, epoch: 5 | loss: 0.0521271
	speed: 0.0003s/iter; time left: 2.3519s
	iters: 1000, epoch: 5 | loss: 0.0096082
	speed: 0.0003s/iter; time left: 2.3375s
	iters: 1100, epoch: 5 | loss: 0.0662624
	speed: 0.0003s/iter; time left: 2.2850s
	iters: 1200, epoch: 5 | loss: 0.0611204
	speed: 0.0003s/iter; time left: 2.2403s
Epoch: 5 cost time: 0.5s
Epoch: 5, Steps: 1291 | Train Loss: 0.0582264 Vali Loss: 1.4194702 Test Loss: 9.3330374
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1180911
	speed: 0.0016s/iter; time left: 10.4355s
	iters: 200, epoch: 6 | loss: 0.0777702
	speed: 0.0003s/iter; time left: 2.1529s
	iters: 300, epoch: 6 | loss: 0.0057874
	speed: 0.0003s/iter; time left: 2.1169s
	iters: 400, epoch: 6 | loss: 0.0015765
	speed: 0.0003s/iter; time left: 2.0823s
	iters: 500, epoch: 6 | loss: 0.0133403
	speed: 0.0003s/iter; time left: 2.0588s
	iters: 600, epoch: 6 | loss: 0.0543634
	speed: 0.0003s/iter; time left: 2.0187s
	iters: 700, epoch: 6 | loss: 0.0327757
	speed: 0.0003s/iter; time left: 1.9918s
	iters: 800, epoch: 6 | loss: 0.1146485
	speed: 0.0003s/iter; time left: 1.9453s
	iters: 900, epoch: 6 | loss: 0.0922752
	speed: 0.0003s/iter; time left: 1.9114s
	iters: 1000, epoch: 6 | loss: 0.0640384
	speed: 0.0003s/iter; time left: 1.8782s
	iters: 1100, epoch: 6 | loss: 0.0047772
	speed: 0.0003s/iter; time left: 1.8380s
	iters: 1200, epoch: 6 | loss: 0.0717277
	speed: 0.0003s/iter; time left: 1.8082s
Epoch: 6 cost time: 0.4s
Epoch: 6, Steps: 1291 | Train Loss: 0.0581950 Vali Loss: 1.4202305 Test Loss: 9.3172531
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0580607
	speed: 0.0017s/iter; time left: 8.4563s
	iters: 200, epoch: 7 | loss: 0.0520903
	speed: 0.0003s/iter; time left: 1.7137s
	iters: 300, epoch: 7 | loss: 0.0824415
	speed: 0.0003s/iter; time left: 1.6738s
	iters: 400, epoch: 7 | loss: 0.0323840
	speed: 0.0003s/iter; time left: 1.6439s
	iters: 500, epoch: 7 | loss: 0.1378839
	speed: 0.0003s/iter; time left: 1.6116s
	iters: 600, epoch: 7 | loss: 0.0729626
	speed: 0.0003s/iter; time left: 1.5754s
	iters: 700, epoch: 7 | loss: 0.0972278
	speed: 0.0003s/iter; time left: 1.5332s
	iters: 800, epoch: 7 | loss: 0.0469222
	speed: 0.0003s/iter; time left: 1.5002s
	iters: 900, epoch: 7 | loss: 0.1414406
	speed: 0.0003s/iter; time left: 1.4728s
	iters: 1000, epoch: 7 | loss: 0.1055130
	speed: 0.0003s/iter; time left: 1.4381s
	iters: 1100, epoch: 7 | loss: 0.0224269
	speed: 0.0003s/iter; time left: 1.3940s
	iters: 1200, epoch: 7 | loss: 0.0454253
	speed: 0.0003s/iter; time left: 1.3587s
Epoch: 7 cost time: 0.4s
Epoch: 7, Steps: 1291 | Train Loss: 0.0580750 Vali Loss: 1.4149613 Test Loss: 9.3090725
Validation loss decreased (1.417967 --> 1.414961).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0195476
	speed: 0.0017s/iter; time left: 6.3186s
	iters: 200, epoch: 8 | loss: 0.0117643
	speed: 0.0003s/iter; time left: 1.2590s
	iters: 300, epoch: 8 | loss: 0.1391310
	speed: 0.0003s/iter; time left: 1.2324s
	iters: 400, epoch: 8 | loss: 0.0016770
	speed: 0.0003s/iter; time left: 1.1898s
	iters: 500, epoch: 8 | loss: 0.1960033
	speed: 0.0003s/iter; time left: 1.1579s
	iters: 600, epoch: 8 | loss: 0.1153084
	speed: 0.0003s/iter; time left: 1.1242s
	iters: 700, epoch: 8 | loss: 0.1319846
	speed: 0.0003s/iter; time left: 1.0906s
	iters: 800, epoch: 8 | loss: 0.0126738
	speed: 0.0003s/iter; time left: 1.0568s
	iters: 900, epoch: 8 | loss: 0.0515906
	speed: 0.0003s/iter; time left: 1.0204s
	iters: 1000, epoch: 8 | loss: 0.0417409
	speed: 0.0003s/iter; time left: 0.9898s
	iters: 1100, epoch: 8 | loss: 0.0200887
	speed: 0.0003s/iter; time left: 0.9517s
	iters: 1200, epoch: 8 | loss: 0.0514600
	speed: 0.0003s/iter; time left: 0.9185s
Epoch: 8 cost time: 0.4s
Epoch: 8, Steps: 1291 | Train Loss: 0.0580631 Vali Loss: 1.4165635 Test Loss: 9.3056450
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0406543
	speed: 0.0017s/iter; time left: 4.1574s
	iters: 200, epoch: 9 | loss: 0.0468466
	speed: 0.0003s/iter; time left: 0.8203s
	iters: 300, epoch: 9 | loss: 0.0254459
	speed: 0.0003s/iter; time left: 0.7890s
	iters: 400, epoch: 9 | loss: 0.0695820
	speed: 0.0003s/iter; time left: 0.7530s
	iters: 500, epoch: 9 | loss: 0.0164581
	speed: 0.0003s/iter; time left: 0.7161s
	iters: 600, epoch: 9 | loss: 0.0104550
	speed: 0.0003s/iter; time left: 0.6837s
	iters: 700, epoch: 9 | loss: 0.2369274
	speed: 0.0003s/iter; time left: 0.6465s
	iters: 800, epoch: 9 | loss: 0.0506077
	speed: 0.0003s/iter; time left: 0.6144s
	iters: 900, epoch: 9 | loss: 0.1029875
	speed: 0.0003s/iter; time left: 0.5766s
	iters: 1000, epoch: 9 | loss: 0.0056778
	speed: 0.0003s/iter; time left: 0.5423s
	iters: 1100, epoch: 9 | loss: 0.0630592
	speed: 0.0003s/iter; time left: 0.5111s
	iters: 1200, epoch: 9 | loss: 0.0553012
	speed: 0.0003s/iter; time left: 0.4767s
Epoch: 9 cost time: 0.4s
Epoch: 9, Steps: 1291 | Train Loss: 0.0580707 Vali Loss: 1.4182874 Test Loss: 9.3035526
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0644423
	speed: 0.0016s/iter; time left: 1.9471s
	iters: 200, epoch: 10 | loss: 0.1076652
	speed: 0.0003s/iter; time left: 0.3768s
	iters: 300, epoch: 10 | loss: 0.1107929
	speed: 0.0003s/iter; time left: 0.3417s
	iters: 400, epoch: 10 | loss: 0.0704628
	speed: 0.0003s/iter; time left: 0.3068s
	iters: 500, epoch: 10 | loss: 0.0159964
	speed: 0.0003s/iter; time left: 0.2741s
	iters: 600, epoch: 10 | loss: 0.0498646
	speed: 0.0003s/iter; time left: 0.2384s
	iters: 700, epoch: 10 | loss: 0.0556385
	speed: 0.0003s/iter; time left: 0.2042s
	iters: 800, epoch: 10 | loss: 0.1714587
	speed: 0.0003s/iter; time left: 0.1688s
	iters: 900, epoch: 10 | loss: 0.0074876
	speed: 0.0003s/iter; time left: 0.1347s
	iters: 1000, epoch: 10 | loss: 0.0159817
	speed: 0.0003s/iter; time left: 0.1008s
	iters: 1100, epoch: 10 | loss: 0.0064721
	speed: 0.0003s/iter; time left: 0.0659s
	iters: 1200, epoch: 10 | loss: 0.1120770
	speed: 0.0003s/iter; time left: 0.0317s
Epoch: 10 cost time: 0.4s
Epoch: 10, Steps: 1291 | Train Loss: 0.0579702 Vali Loss: 1.4140667 Test Loss: 9.3026237
Validation loss decreased (1.414961 --> 1.414067).  Saving model ...
Updating learning rate to 9.765625e-07
>>>>>>>testing : GD_336_336_S_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2809

Final Metrics:

FITS10       MSE: 9.302624   MAE: 2.393988   SE: 21.951395  RRMSE: 0.198006   RMAE: 0.155416   (numpy)
FITS10       MSE: 9.302624   MAE: 2.393988   SE: 21.951395  RRMSE: 0.198006   RMAE: 0.155416   (torch)

Repeat       MSE: 7.578791   MAE: 2.093492   SE: 17.440411  RRMSE: 0.178721   RMAE: 0.135908   (numpy)
Repeat       MSE: 7.578791   MAE: 2.093491   SE: 17.440411  RRMSE: 0.178721   RMAE: 0.135908   (torch)

Shapes: pred (2808, 336, 1), true (2808, 336, 1), naive_pred (2808, 336, 1), gt (2808, 672, 1), metrics {'FITS10': {'mse': 9.302624, 'mae': 2.3939884, 'se': 21.951395, 'relative_rmse': 0.19800551, 'relative_mae': 0.15541631, 'mse_torch': 9.302623748779297, 'mae_torch': 2.3939878940582275, 'se_torch': 21.95139503479004, 'relative_rmse_torch': 0.19800552255195736, 'relative_mae_torch': 0.15541628559845724}, 'Repeat': {'mse': 7.5787907, 'mae': 2.0934916, 'se': 17.44041, 'relative_rmse': 0.17872058, 'relative_mae': 0.13590825, 'mse_torch': 7.578790664672852, 'mae_torch': 2.093491315841675, 'se_torch': 17.440410614013672, 'relative_rmse_torch': 0.1787205659566264, 'relative_mae_torch': 0.13590822453541873}}
