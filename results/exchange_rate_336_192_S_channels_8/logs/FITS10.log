Args in experiment:
Namespace(is_training=1, model_id='exchange_rate_336_192_S_channels_8', model='FITS10', data='custom', root_path='./dataset/', data_path='exchange_rate.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
exchange_rate_336_192_S_channels_8
Use CPU
FITS cutoff frequency: 10

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=10, out_features=15, bias=True)
  )
)

>>>>>>>start training : exchange_rate_336_192_S_channels_8>>>>>>>>>>>>>>>>>>>>>>>>>>

train 4784
val 569
test 1326
	iters: 100, epoch: 1 | loss: 0.8820218
	speed: 0.0039s/iter; time left: 22.9734s
	iters: 200, epoch: 1 | loss: 0.5405317
	speed: 0.0004s/iter; time left: 2.1474s
	iters: 300, epoch: 1 | loss: 0.6038075
	speed: 0.0004s/iter; time left: 1.9891s
	iters: 400, epoch: 1 | loss: 0.3942164
	speed: 0.0004s/iter; time left: 1.9707s
	iters: 500, epoch: 1 | loss: 0.1781131
	speed: 0.0003s/iter; time left: 1.9102s
Epoch: 1 cost time: 0.2s
Epoch: 1, Steps: 598 | Train Loss: 0.4922323 Vali Loss: 0.2220003 Test Loss: 0.2685812
Validation loss decreased (inf --> 0.222000).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3961234
	speed: 0.0012s/iter; time left: 6.2573s
	iters: 200, epoch: 2 | loss: 0.2324388
	speed: 0.0003s/iter; time left: 1.8080s
	iters: 300, epoch: 2 | loss: 0.2689618
	speed: 0.0004s/iter; time left: 1.7910s
	iters: 400, epoch: 2 | loss: 0.1604991
	speed: 0.0003s/iter; time left: 1.7195s
	iters: 500, epoch: 2 | loss: 0.1696824
	speed: 0.0003s/iter; time left: 1.6743s
Epoch: 2 cost time: 0.2s
Epoch: 2, Steps: 598 | Train Loss: 0.3777866 Vali Loss: 0.2158652 Test Loss: 0.2435116
Validation loss decreased (0.222000 --> 0.215865).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2224545
	speed: 0.0012s/iter; time left: 5.4142s
	iters: 200, epoch: 3 | loss: 0.2396961
	speed: 0.0003s/iter; time left: 1.5844s
	iters: 300, epoch: 3 | loss: 0.3269416
	speed: 0.0003s/iter; time left: 1.5084s
	iters: 400, epoch: 3 | loss: 0.3517600
	speed: 0.0003s/iter; time left: 1.4884s
	iters: 500, epoch: 3 | loss: 0.4042032
	speed: 0.0004s/iter; time left: 1.5177s
Epoch: 3 cost time: 0.2s
Epoch: 3, Steps: 598 | Train Loss: 0.3509121 Vali Loss: 0.2202395 Test Loss: 0.2382244
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2359554
	speed: 0.0012s/iter; time left: 4.7176s
	iters: 200, epoch: 4 | loss: 0.3634207
	speed: 0.0003s/iter; time left: 1.3750s
	iters: 300, epoch: 4 | loss: 0.1647933
	speed: 0.0003s/iter; time left: 1.3356s
	iters: 400, epoch: 4 | loss: 0.2277003
	speed: 0.0003s/iter; time left: 1.2967s
	iters: 500, epoch: 4 | loss: 0.4841422
	speed: 0.0004s/iter; time left: 1.3320s
Epoch: 4 cost time: 0.2s
Epoch: 4, Steps: 598 | Train Loss: 0.3409471 Vali Loss: 0.2222702 Test Loss: 0.2360429
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1794919
	speed: 0.0011s/iter; time left: 4.0087s
	iters: 200, epoch: 5 | loss: 0.3282035
	speed: 0.0003s/iter; time left: 1.1541s
	iters: 300, epoch: 5 | loss: 0.1552378
	speed: 0.0004s/iter; time left: 1.2628s
	iters: 400, epoch: 5 | loss: 0.2478255
	speed: 0.0004s/iter; time left: 1.1266s
	iters: 500, epoch: 5 | loss: 0.2810787
	speed: 0.0003s/iter; time left: 1.0709s
Epoch: 5 cost time: 0.2s
Epoch: 5, Steps: 598 | Train Loss: 0.3365363 Vali Loss: 0.2238036 Test Loss: 0.2351023
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : exchange_rate_336_192_S_channels_8<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1326

Final Metrics:

FITS10       MSE: 0.243512   MAE: 0.391130   SE: 0.507102   RRMSE: 0.296135   RMAE: 0.234721   (numpy)
FITS10       MSE: 0.243512   MAE: 0.391130   SE: 0.507102   RRMSE: 0.296135   RMAE: 0.234721   (torch)

Repeat       MSE: 0.188096   MAE: 0.332759   SE: 0.385642   RRMSE: 0.260268   RMAE: 0.199692   (numpy)
Repeat       MSE: 0.188096   MAE: 0.332759   SE: 0.385642   RRMSE: 0.260268   RMAE: 0.199692   (torch)

Shapes: pred (1320, 192, 1), true (1320, 192, 1), naive_pred (1320, 192, 1), gt (1320, 528, 1), metrics {'FITS10': {'mse': 0.24351166, 'mae': 0.39112985, 'se': 0.50710154, 'relative_rmse': 0.2961355, 'relative_mae': 0.23472078, 'mse_torch': 0.24351166188716888, 'mae_torch': 0.39112982153892517, 'se_torch': 0.5071015954017639, 'relative_rmse_torch': 0.2961354876375154, 'relative_mae_torch': 0.23472075965449699}, 'Repeat': {'mse': 0.18809567, 'mae': 0.33275875, 'se': 0.38564205, 'relative_rmse': 0.26026753, 'relative_mae': 0.19969173, 'mse_torch': 0.18809567391872406, 'mae_torch': 0.33275869488716125, 'se_torch': 0.38564202189445496, 'relative_rmse_torch': 0.2602675211774616, 'relative_mae_torch': 0.19969168635171541}}
