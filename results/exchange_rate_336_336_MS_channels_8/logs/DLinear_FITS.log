Args in experiment:
Namespace(is_training=1, model_id='exchange_rate_336_336_MS_channels_8', model='DLinear_FITS', data='custom', root_path='./dataset/', data_path='exchange_rate.csv', features='MS', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
exchange_rate_336_336_MS_channels_8
Use CPU
FITS cutoff frequency: 49

Model(
  (decomposition): SeriesDecomp(
    (moving_avg): MovingAvg(
      (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=49, out_features=98, bias=True)
  )
  (Linear_Seasonal): Linear(in_features=336, out_features=336, bias=True)
  (Linear_Trend): Linear(in_features=336, out_features=336, bias=True)
)

>>>>>>>start training : exchange_rate_336_336_MS_channels_8>>>>>>>>>>>>>>>>>>>>>>>>>>

train 4640
val 425
test 1182
	iters: 100, epoch: 1 | loss: 0.5808694
	speed: 0.0095s/iter; time left: 54.0108s
	iters: 200, epoch: 1 | loss: 0.7271120
	speed: 0.0056s/iter; time left: 31.4547s
	iters: 300, epoch: 1 | loss: 0.5658167
	speed: 0.0058s/iter; time left: 31.9625s
	iters: 400, epoch: 1 | loss: 1.1264353
	speed: 0.0059s/iter; time left: 31.7169s
	iters: 500, epoch: 1 | loss: 0.2878307
	speed: 0.0065s/iter; time left: 34.3065s
Epoch: 1 cost time: 3.5s
Epoch: 1, Steps: 580 | Train Loss: 0.5341514 Vali Loss: 0.9554017 Test Loss: 0.5195391
Validation loss decreased (inf --> 0.955402).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.7631706
	speed: 0.0153s/iter; time left: 78.5484s
	iters: 200, epoch: 2 | loss: 0.5411537
	speed: 0.0054s/iter; time left: 26.8793s
	iters: 300, epoch: 2 | loss: 0.3017924
	speed: 0.0064s/iter; time left: 31.6106s
	iters: 400, epoch: 2 | loss: 0.5236049
	speed: 0.0056s/iter; time left: 27.1112s
	iters: 500, epoch: 2 | loss: 0.4057892
	speed: 0.0067s/iter; time left: 31.4991s
Epoch: 2 cost time: 3.5s
Epoch: 2, Steps: 580 | Train Loss: 0.4722793 Vali Loss: 0.7562615 Test Loss: 0.4068631
Validation loss decreased (0.955402 --> 0.756262).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.6071334
	speed: 0.0146s/iter; time left: 66.3307s
	iters: 200, epoch: 3 | loss: 0.4056682
	speed: 0.0055s/iter; time left: 24.5455s
	iters: 300, epoch: 3 | loss: 0.7318030
	speed: 0.0047s/iter; time left: 20.3856s
	iters: 400, epoch: 3 | loss: 0.2698554
	speed: 0.0048s/iter; time left: 20.2757s
	iters: 500, epoch: 3 | loss: 0.6434864
	speed: 0.0044s/iter; time left: 18.3319s
Epoch: 3 cost time: 2.9s
Epoch: 3, Steps: 580 | Train Loss: 0.4542112 Vali Loss: 0.8036734 Test Loss: 0.4848812
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.5230644
	speed: 0.0120s/iter; time left: 47.4878s
	iters: 200, epoch: 4 | loss: 0.3935756
	speed: 0.0045s/iter; time left: 17.3900s
	iters: 300, epoch: 4 | loss: 0.3481635
	speed: 0.0046s/iter; time left: 17.1283s
	iters: 400, epoch: 4 | loss: 0.2300061
	speed: 0.0048s/iter; time left: 17.6851s
	iters: 500, epoch: 4 | loss: 0.5714913
	speed: 0.0052s/iter; time left: 18.5547s
Epoch: 4 cost time: 2.7s
Epoch: 4, Steps: 580 | Train Loss: 0.4421138 Vali Loss: 0.9426612 Test Loss: 0.6211919
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.5559368
	speed: 0.0135s/iter; time left: 45.6453s
	iters: 200, epoch: 5 | loss: 0.2991069
	speed: 0.0058s/iter; time left: 19.0190s
	iters: 300, epoch: 5 | loss: 0.5547252
	speed: 0.0045s/iter; time left: 14.2552s
	iters: 400, epoch: 5 | loss: 0.4579941
	speed: 0.0048s/iter; time left: 14.6422s
	iters: 500, epoch: 5 | loss: 0.7380474
	speed: 0.0050s/iter; time left: 14.9531s
Epoch: 5 cost time: 2.9s
Epoch: 5, Steps: 580 | Train Loss: 0.4378488 Vali Loss: 0.7383332 Test Loss: 0.4161130
Validation loss decreased (0.756262 --> 0.738333).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2741672
	speed: 0.0120s/iter; time left: 33.5667s
	iters: 200, epoch: 6 | loss: 0.2856589
	speed: 0.0050s/iter; time left: 13.4259s
	iters: 300, epoch: 6 | loss: 0.4639803
	speed: 0.0053s/iter; time left: 13.6768s
	iters: 400, epoch: 6 | loss: 0.6592235
	speed: 0.0054s/iter; time left: 13.5319s
	iters: 500, epoch: 6 | loss: 0.7375436
	speed: 0.0049s/iter; time left: 11.6537s
Epoch: 6 cost time: 2.9s
Epoch: 6, Steps: 580 | Train Loss: 0.4357794 Vali Loss: 0.7190663 Test Loss: 0.4043590
Validation loss decreased (0.738333 --> 0.719066).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.3419780
	speed: 0.0140s/iter; time left: 31.0668s
	iters: 200, epoch: 7 | loss: 0.3434885
	speed: 0.0054s/iter; time left: 11.4928s
	iters: 300, epoch: 7 | loss: 0.3008210
	speed: 0.0058s/iter; time left: 11.7344s
	iters: 400, epoch: 7 | loss: 0.4763177
	speed: 0.0059s/iter; time left: 11.2466s
	iters: 500, epoch: 7 | loss: 0.5003651
	speed: 0.0055s/iter; time left: 9.9895s
Epoch: 7 cost time: 3.1s
Epoch: 7, Steps: 580 | Train Loss: 0.4350047 Vali Loss: 0.7487018 Test Loss: 0.4310238
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.4880984
	speed: 0.0132s/iter; time left: 21.6119s
	iters: 200, epoch: 8 | loss: 0.3976166
	speed: 0.0052s/iter; time left: 7.9649s
	iters: 300, epoch: 8 | loss: 0.3223746
	speed: 0.0053s/iter; time left: 7.6724s
	iters: 400, epoch: 8 | loss: 0.2781191
	speed: 0.0048s/iter; time left: 6.4435s
	iters: 500, epoch: 8 | loss: 0.4716274
	speed: 0.0060s/iter; time left: 7.3840s
Epoch: 8 cost time: 3.0s
Epoch: 8, Steps: 580 | Train Loss: 0.4341253 Vali Loss: 0.7614785 Test Loss: 0.4374987
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.5409285
	speed: 0.0131s/iter; time left: 13.9452s
	iters: 200, epoch: 9 | loss: 0.6620269
	speed: 0.0056s/iter; time left: 5.3671s
	iters: 300, epoch: 9 | loss: 0.3592643
	speed: 0.0055s/iter; time left: 4.7751s
	iters: 400, epoch: 9 | loss: 0.2529877
	speed: 0.0052s/iter; time left: 3.9597s
	iters: 500, epoch: 9 | loss: 0.4575716
	speed: 0.0054s/iter; time left: 3.5735s
Epoch: 9 cost time: 3.1s
Epoch: 9, Steps: 580 | Train Loss: 0.4337749 Vali Loss: 0.7434211 Test Loss: 0.4243146
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : exchange_rate_336_336_MS_channels_8<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1182

Final Metrics:

DLinear_FITS MSE: 0.404359   MAE: 0.506041   SE: 0.758986   RRMSE: 0.381350   RMAE: 0.303477   (numpy)
DLinear_FITS MSE: 0.404359   MAE: 0.506041   SE: 0.758986   RRMSE: 0.381350   RMAE: 0.303477   (torch)

Repeat       MSE: 0.370203   MAE: 0.467749   SE: 0.809456   RRMSE: 0.364888   RMAE: 0.280513   (numpy)
Repeat       MSE: 0.370203   MAE: 0.467749   SE: 0.809456   RRMSE: 0.364888   RMAE: 0.280513   (torch)

Shapes: pred (1176, 336, 1), true (1176, 336, 1), naive_pred (1176, 336, 1), gt (1176, 672, 1), metrics {'DLinear_FITS': {'mse': 0.40435895, 'mae': 0.50604093, 'se': 0.7589856, 'relative_rmse': 0.38134977, 'relative_mae': 0.30347687, 'mse_torch': 0.40435904264450073, 'mae_torch': 0.5060410499572754, 'se_torch': 0.7589856386184692, 'relative_rmse_torch': 0.38134981339499524, 'relative_mae_torch': 0.30347694711762385}, 'Repeat': {'mse': 0.3702028, 'mae': 0.4677486, 'se': 0.80945605, 'relative_rmse': 0.36488822, 'relative_mae': 0.28051266, 'mse_torch': 0.3702028691768646, 'mae_torch': 0.4677485525608063, 'se_torch': 0.8094561100006104, 'relative_rmse_torch': 0.3648882247633194, 'relative_mae_torch': 0.2805126239498272}}
