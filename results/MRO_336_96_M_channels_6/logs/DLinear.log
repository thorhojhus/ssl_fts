Args in experiment:
Namespace(is_training=1, model_id='MRO_336_96_M_channels_6', model='DLinear', data='custom', root_path='./dataset/', data_path='MRO.csv', features='M', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
MRO_336_96_M_channels_6
Use CPU

Model(
  (decompsition): series_decomp(
    (moving_avg): moving_avg(
      (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (Linear_Seasonal): Linear(in_features=336, out_features=96, bias=True)
  (Linear_Trend): Linear(in_features=336, out_features=96, bias=True)
  (Linear_Decoder): Linear(in_features=336, out_features=96, bias=True)
)

>>>>>>>start training : MRO_336_96_M_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10575
val 1479
test 3049
	iters: 100, epoch: 1 | loss: 0.1978361
	speed: 0.0048s/iter; time left: 63.2555s
	iters: 200, epoch: 1 | loss: 0.1838611
	speed: 0.0017s/iter; time left: 22.2683s
	iters: 300, epoch: 1 | loss: 0.2160367
	speed: 0.0019s/iter; time left: 25.0632s
	iters: 400, epoch: 1 | loss: 0.1027010
	speed: 0.0015s/iter; time left: 19.2904s
	iters: 500, epoch: 1 | loss: 0.1665301
	speed: 0.0019s/iter; time left: 24.5878s
	iters: 600, epoch: 1 | loss: 0.1300395
	speed: 0.0016s/iter; time left: 19.9465s
	iters: 700, epoch: 1 | loss: 0.0838799
	speed: 0.0015s/iter; time left: 18.6707s
	iters: 800, epoch: 1 | loss: 0.2299041
	speed: 0.0017s/iter; time left: 21.0317s
	iters: 900, epoch: 1 | loss: 0.0815797
	speed: 0.0016s/iter; time left: 19.3633s
	iters: 1000, epoch: 1 | loss: 0.0828960
	speed: 0.0016s/iter; time left: 19.5630s
	iters: 1100, epoch: 1 | loss: 0.1321370
	speed: 0.0015s/iter; time left: 17.9480s
	iters: 1200, epoch: 1 | loss: 0.7209486
	speed: 0.0041s/iter; time left: 48.7506s
	iters: 1300, epoch: 1 | loss: 0.0845816
	speed: 0.0017s/iter; time left: 20.2962s
Epoch: 1 cost time: 2.4s
Epoch: 1, Steps: 1321 | Train Loss: 0.2111874 Vali Loss: 3.2283738 Test Loss: 4.7682171
Validation loss decreased (inf --> 3.228374).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2283717
	speed: 0.0071s/iter; time left: 84.0143s
	iters: 200, epoch: 2 | loss: 0.0675138
	speed: 0.0016s/iter; time left: 18.3232s
	iters: 300, epoch: 2 | loss: 0.1485656
	speed: 0.0016s/iter; time left: 18.9671s
	iters: 400, epoch: 2 | loss: 0.5816991
	speed: 0.0026s/iter; time left: 30.3955s
	iters: 500, epoch: 2 | loss: 0.2234337
	speed: 0.0017s/iter; time left: 19.3870s
	iters: 600, epoch: 2 | loss: 0.1106173
	speed: 0.0024s/iter; time left: 27.0244s
	iters: 700, epoch: 2 | loss: 0.2538243
	speed: 0.0019s/iter; time left: 21.1136s
	iters: 800, epoch: 2 | loss: 0.0866214
	speed: 0.0016s/iter; time left: 18.1252s
	iters: 900, epoch: 2 | loss: 0.2307791
	speed: 0.0015s/iter; time left: 16.5246s
	iters: 1000, epoch: 2 | loss: 0.1689217
	speed: 0.0015s/iter; time left: 16.7042s
	iters: 1100, epoch: 2 | loss: 0.0972637
	speed: 0.0017s/iter; time left: 17.9330s
	iters: 1200, epoch: 2 | loss: 0.1421973
	speed: 0.0026s/iter; time left: 28.1982s
	iters: 1300, epoch: 2 | loss: 0.0692764
	speed: 0.0020s/iter; time left: 20.6864s
Epoch: 2 cost time: 2.5s
Epoch: 2, Steps: 1321 | Train Loss: 0.2032156 Vali Loss: 2.6625729 Test Loss: 3.9535222
Validation loss decreased (3.228374 --> 2.662573).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1116174
	speed: 0.0089s/iter; time left: 92.7382s
	iters: 200, epoch: 3 | loss: 0.1286984
	speed: 0.0018s/iter; time left: 18.6736s
	iters: 300, epoch: 3 | loss: 0.1499000
	speed: 0.0015s/iter; time left: 14.9988s
	iters: 400, epoch: 3 | loss: 0.1124237
	speed: 0.0026s/iter; time left: 26.7478s
	iters: 500, epoch: 3 | loss: 0.3856055
	speed: 0.0019s/iter; time left: 19.6143s
	iters: 600, epoch: 3 | loss: 0.1305943
	speed: 0.0015s/iter; time left: 15.2194s
	iters: 700, epoch: 3 | loss: 0.5983231
	speed: 0.0016s/iter; time left: 15.7347s
	iters: 800, epoch: 3 | loss: 0.1857056
	speed: 0.0015s/iter; time left: 14.5186s
	iters: 900, epoch: 3 | loss: 0.8365649
	speed: 0.0015s/iter; time left: 14.7218s
	iters: 1000, epoch: 3 | loss: 0.1520504
	speed: 0.0017s/iter; time left: 16.2467s
	iters: 1100, epoch: 3 | loss: 0.1294784
	speed: 0.0016s/iter; time left: 15.1519s
	iters: 1200, epoch: 3 | loss: 0.1696172
	speed: 0.0015s/iter; time left: 14.2394s
	iters: 1300, epoch: 3 | loss: 0.1300285
	speed: 0.0026s/iter; time left: 23.9038s
Epoch: 3 cost time: 2.4s
Epoch: 3, Steps: 1321 | Train Loss: 0.1969730 Vali Loss: 2.6209278 Test Loss: 3.8315132
Validation loss decreased (2.662573 --> 2.620928).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0733590
	speed: 0.0070s/iter; time left: 63.6698s
	iters: 200, epoch: 4 | loss: 0.1363543
	speed: 0.0018s/iter; time left: 16.1632s
	iters: 300, epoch: 4 | loss: 0.1766208
	speed: 0.0029s/iter; time left: 25.9892s
	iters: 400, epoch: 4 | loss: 0.0851440
	speed: 0.0019s/iter; time left: 16.6298s
	iters: 500, epoch: 4 | loss: 0.1077093
	speed: 0.0016s/iter; time left: 14.1627s
	iters: 600, epoch: 4 | loss: 0.1508788
	speed: 0.0018s/iter; time left: 15.4965s
	iters: 700, epoch: 4 | loss: 0.1189945
	speed: 0.0017s/iter; time left: 14.3485s
	iters: 800, epoch: 4 | loss: 0.0657580
	speed: 0.0017s/iter; time left: 14.7748s
	iters: 900, epoch: 4 | loss: 0.0889818
	speed: 0.0030s/iter; time left: 24.7592s
	iters: 1000, epoch: 4 | loss: 0.1827313
	speed: 0.0035s/iter; time left: 29.0002s
	iters: 1100, epoch: 4 | loss: 0.1636284
	speed: 0.0027s/iter; time left: 22.2369s
	iters: 1200, epoch: 4 | loss: 0.1230893
	speed: 0.0021s/iter; time left: 17.0191s
	iters: 1300, epoch: 4 | loss: 0.0812874
	speed: 0.0016s/iter; time left: 12.7418s
Epoch: 4 cost time: 2.8s
Epoch: 4, Steps: 1321 | Train Loss: 0.1932804 Vali Loss: 2.5901649 Test Loss: 3.8459363
Validation loss decreased (2.620928 --> 2.590165).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.5175145
	speed: 0.0098s/iter; time left: 76.4291s
	iters: 200, epoch: 5 | loss: 0.0641233
	speed: 0.0015s/iter; time left: 11.3480s
	iters: 300, epoch: 5 | loss: 0.0800549
	speed: 0.0018s/iter; time left: 13.9268s
	iters: 400, epoch: 5 | loss: 0.1505803
	speed: 0.0015s/iter; time left: 11.6402s
	iters: 500, epoch: 5 | loss: 0.2466069
	speed: 0.0018s/iter; time left: 13.0079s
	iters: 600, epoch: 5 | loss: 0.1778371
	speed: 0.0016s/iter; time left: 11.9445s
	iters: 700, epoch: 5 | loss: 0.2061818
	speed: 0.0015s/iter; time left: 11.0212s
	iters: 800, epoch: 5 | loss: 0.6423294
	speed: 0.0015s/iter; time left: 10.4302s
	iters: 900, epoch: 5 | loss: 0.1292595
	speed: 0.0015s/iter; time left: 10.5838s
	iters: 1000, epoch: 5 | loss: 0.1209414
	speed: 0.0015s/iter; time left: 10.1983s
	iters: 1100, epoch: 5 | loss: 0.1092488
	speed: 0.0015s/iter; time left: 10.1136s
	iters: 1200, epoch: 5 | loss: 0.1549764
	speed: 0.0016s/iter; time left: 10.7141s
	iters: 1300, epoch: 5 | loss: 0.0618236
	speed: 0.0015s/iter; time left: 9.8588s
Epoch: 5 cost time: 2.1s
Epoch: 5, Steps: 1321 | Train Loss: 0.1916183 Vali Loss: 2.5598226 Test Loss: 3.8262932
Validation loss decreased (2.590165 --> 2.559823).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0961989
	speed: 0.0064s/iter; time left: 41.5853s
	iters: 200, epoch: 6 | loss: 0.1552996
	speed: 0.0017s/iter; time left: 11.1185s
	iters: 300, epoch: 6 | loss: 0.2018477
	speed: 0.0016s/iter; time left: 9.9325s
	iters: 400, epoch: 6 | loss: 0.0903807
	speed: 0.0016s/iter; time left: 9.8441s
	iters: 500, epoch: 6 | loss: 0.0987905
	speed: 0.0015s/iter; time left: 9.1411s
	iters: 600, epoch: 6 | loss: 0.1851187
	speed: 0.0019s/iter; time left: 11.1980s
	iters: 700, epoch: 6 | loss: 0.4852107
	speed: 0.0016s/iter; time left: 9.2399s
	iters: 800, epoch: 6 | loss: 0.1085140
	speed: 0.0018s/iter; time left: 10.6659s
	iters: 900, epoch: 6 | loss: 0.1572359
	speed: 0.0016s/iter; time left: 9.2642s
	iters: 1000, epoch: 6 | loss: 0.1383938
	speed: 0.0015s/iter; time left: 8.3037s
	iters: 1100, epoch: 6 | loss: 0.1169967
	speed: 0.0016s/iter; time left: 8.6242s
	iters: 1200, epoch: 6 | loss: 0.2772698
	speed: 0.0015s/iter; time left: 8.3323s
	iters: 1300, epoch: 6 | loss: 0.0663162
	speed: 0.0020s/iter; time left: 10.3557s
Epoch: 6 cost time: 2.2s
Epoch: 6, Steps: 1321 | Train Loss: 0.1909380 Vali Loss: 2.6065545 Test Loss: 3.8252101
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1312588
	speed: 0.0065s/iter; time left: 33.8260s
	iters: 200, epoch: 7 | loss: 0.1283983
	speed: 0.0015s/iter; time left: 7.7457s
	iters: 300, epoch: 7 | loss: 0.7604325
	speed: 0.0015s/iter; time left: 7.4686s
	iters: 400, epoch: 7 | loss: 0.1024948
	speed: 0.0015s/iter; time left: 7.4425s
	iters: 500, epoch: 7 | loss: 0.0805947
	speed: 0.0016s/iter; time left: 7.8155s
	iters: 600, epoch: 7 | loss: 0.1211693
	speed: 0.0015s/iter; time left: 6.9098s
	iters: 700, epoch: 7 | loss: 0.0886235
	speed: 0.0015s/iter; time left: 6.7441s
	iters: 800, epoch: 7 | loss: 0.4567984
	speed: 0.0015s/iter; time left: 6.7413s
	iters: 900, epoch: 7 | loss: 0.4500403
	speed: 0.0015s/iter; time left: 6.6987s
	iters: 1000, epoch: 7 | loss: 0.1010412
	speed: 0.0018s/iter; time left: 7.5298s
	iters: 1100, epoch: 7 | loss: 0.2472493
	speed: 0.0017s/iter; time left: 7.1836s
	iters: 1200, epoch: 7 | loss: 0.1824368
	speed: 0.0015s/iter; time left: 6.1701s
	iters: 1300, epoch: 7 | loss: 0.0499170
	speed: 0.0015s/iter; time left: 6.0105s
Epoch: 7 cost time: 2.0s
Epoch: 7, Steps: 1321 | Train Loss: 0.1904562 Vali Loss: 2.6196346 Test Loss: 3.8319895
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0739407
	speed: 0.0065s/iter; time left: 25.1782s
	iters: 200, epoch: 8 | loss: 0.1253028
	speed: 0.0040s/iter; time left: 15.0413s
	iters: 300, epoch: 8 | loss: 0.1831432
	speed: 0.0025s/iter; time left: 9.1003s
	iters: 400, epoch: 8 | loss: 0.0395744
	speed: 0.0025s/iter; time left: 8.7416s
	iters: 500, epoch: 8 | loss: 0.1888628
	speed: 0.0018s/iter; time left: 6.0870s
	iters: 600, epoch: 8 | loss: 0.0911558
	speed: 0.0015s/iter; time left: 5.0818s
	iters: 700, epoch: 8 | loss: 0.0713012
	speed: 0.0015s/iter; time left: 4.9107s
	iters: 800, epoch: 8 | loss: 0.1460623
	speed: 0.0016s/iter; time left: 4.9364s
	iters: 900, epoch: 8 | loss: 0.1349931
	speed: 0.0015s/iter; time left: 4.4958s
	iters: 1000, epoch: 8 | loss: 0.1424406
	speed: 0.0016s/iter; time left: 4.8709s
	iters: 1100, epoch: 8 | loss: 0.2783897
	speed: 0.0016s/iter; time left: 4.7052s
	iters: 1200, epoch: 8 | loss: 0.1526328
	speed: 0.0016s/iter; time left: 4.4048s
	iters: 1300, epoch: 8 | loss: 0.1197965
	speed: 0.0015s/iter; time left: 3.8920s
Epoch: 8 cost time: 2.5s
Epoch: 8, Steps: 1321 | Train Loss: 0.1902108 Vali Loss: 2.5655890 Test Loss: 3.8113742
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : MRO_336_96_M_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3049

Final Metrics:

DLinear      MSE: 3.826293   MAE: 1.269952   SE: 5.770272   RRMSE: 0.334966   RMAE: 0.217470   (numpy)
DLinear      MSE: 3.826293   MAE: 1.269952   SE: 5.770272   RRMSE: 0.334966   RMAE: 0.217470   (torch)

Repeat       MSE: 4.465144   MAE: 1.246157   SE: 6.730308   RRMSE: 0.361851   RMAE: 0.213395   (numpy)
Repeat       MSE: 4.465145   MAE: 1.246157   SE: 6.730307   RRMSE: 0.361851   RMAE: 0.213395   (torch)

Shapes: pred (3048, 96, 6), true (3048, 96, 6), naive_pred (3048, 96, 6), gt (3048, 432, 6), metrics {'DLinear': {'mse': 3.8262935, 'mae': 1.269952, 'se': 5.770272, 'relative_rmse': 0.33496633, 'relative_mae': 0.21746999, 'mse_torch': 3.8262932300567627, 'mae_torch': 1.2699521780014038, 'se_torch': 5.7702717781066895, 'relative_rmse_torch': 0.33496630651112513, 'relative_mae_torch': 0.21747000632906896}, 'Repeat': {'mse': 4.465144, 'mae': 1.2461567, 'se': 6.7303076, 'relative_rmse': 0.36185098, 'relative_mae': 0.21339521, 'mse_torch': 4.465144634246826, 'mae_torch': 1.2461566925048828, 'se_torch': 6.730307102203369, 'relative_rmse_torch': 0.3618509901943064, 'relative_mae_torch': 0.21339520377258564}}
