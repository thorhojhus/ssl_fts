Args in experiment:
Namespace(is_training=1, model_id='GD_336_192_M_channels_6', model='DLinear', data='custom', root_path='./dataset/', data_path='GD.csv', features='M', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
GD_336_192_M_channels_6
Use CPU

Model(
  (decompsition): series_decomp(
    (moving_avg): moving_avg(
      (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (Linear_Seasonal): Linear(in_features=336, out_features=192, bias=True)
  (Linear_Trend): Linear(in_features=336, out_features=192, bias=True)
  (Linear_Decoder): Linear(in_features=336, out_features=192, bias=True)
)

>>>>>>>start training : GD_336_192_M_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10479
val 1383
test 2953
	iters: 100, epoch: 1 | loss: 0.1630155
	speed: 0.0061s/iter; time left: 79.2265s
	iters: 200, epoch: 1 | loss: 0.1987545
	speed: 0.0026s/iter; time left: 33.9974s
	iters: 300, epoch: 1 | loss: 0.0842690
	speed: 0.0029s/iter; time left: 36.9033s
	iters: 400, epoch: 1 | loss: 0.1531530
	speed: 0.0028s/iter; time left: 35.1699s
	iters: 500, epoch: 1 | loss: 0.1241129
	speed: 0.0033s/iter; time left: 41.2164s
	iters: 600, epoch: 1 | loss: 0.1652605
	speed: 0.0031s/iter; time left: 38.2332s
	iters: 700, epoch: 1 | loss: 0.1343955
	speed: 0.0029s/iter; time left: 35.4743s
	iters: 800, epoch: 1 | loss: 0.1615075
	speed: 0.0031s/iter; time left: 38.0139s
	iters: 900, epoch: 1 | loss: 0.3422290
	speed: 0.0047s/iter; time left: 56.9702s
	iters: 1000, epoch: 1 | loss: 0.1355055
	speed: 0.0023s/iter; time left: 28.1504s
	iters: 1100, epoch: 1 | loss: 0.1364447
	speed: 0.0027s/iter; time left: 32.4133s
	iters: 1200, epoch: 1 | loss: 0.1166149
	speed: 0.0025s/iter; time left: 29.3182s
	iters: 1300, epoch: 1 | loss: 0.1433433
	speed: 0.0024s/iter; time left: 28.7999s
Epoch: 1 cost time: 3.8s
Epoch: 1, Steps: 1309 | Train Loss: 0.1714951 Vali Loss: 1.3200072 Test Loss: 3.9652219
Validation loss decreased (inf --> 1.320007).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1404038
	speed: 0.0073s/iter; time left: 85.5460s
	iters: 200, epoch: 2 | loss: 0.0614148
	speed: 0.0020s/iter; time left: 23.4891s
	iters: 300, epoch: 2 | loss: 0.0927143
	speed: 0.0025s/iter; time left: 28.2132s
	iters: 400, epoch: 2 | loss: 0.0910491
	speed: 0.0021s/iter; time left: 24.1904s
	iters: 500, epoch: 2 | loss: 0.2926160
	speed: 0.0023s/iter; time left: 25.5713s
	iters: 600, epoch: 2 | loss: 0.1692734
	speed: 0.0023s/iter; time left: 25.2899s
	iters: 700, epoch: 2 | loss: 0.1982697
	speed: 0.0024s/iter; time left: 27.1097s
	iters: 800, epoch: 2 | loss: 0.1399409
	speed: 0.0021s/iter; time left: 22.9258s
	iters: 900, epoch: 2 | loss: 0.0831018
	speed: 0.0023s/iter; time left: 24.9889s
	iters: 1000, epoch: 2 | loss: 0.1227862
	speed: 0.0020s/iter; time left: 21.4611s
	iters: 1100, epoch: 2 | loss: 0.2011812
	speed: 0.0020s/iter; time left: 21.0707s
	iters: 1200, epoch: 2 | loss: 0.0980021
	speed: 0.0023s/iter; time left: 24.7358s
	iters: 1300, epoch: 2 | loss: 0.1550635
	speed: 0.0021s/iter; time left: 22.3628s
Epoch: 2 cost time: 2.9s
Epoch: 2, Steps: 1309 | Train Loss: 0.1680854 Vali Loss: 0.9278655 Test Loss: 2.4323606
Validation loss decreased (1.320007 --> 0.927866).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1297160
	speed: 0.0078s/iter; time left: 81.0548s
	iters: 200, epoch: 3 | loss: 0.1297644
	speed: 0.0024s/iter; time left: 24.4789s
	iters: 300, epoch: 3 | loss: 0.1015108
	speed: 0.0023s/iter; time left: 23.7758s
	iters: 400, epoch: 3 | loss: 0.0804361
	speed: 0.0023s/iter; time left: 23.5189s
	iters: 500, epoch: 3 | loss: 0.1061312
	speed: 0.0027s/iter; time left: 27.1026s
	iters: 600, epoch: 3 | loss: 0.2474958
	speed: 0.0028s/iter; time left: 27.3536s
	iters: 700, epoch: 3 | loss: 0.2628138
	speed: 0.0028s/iter; time left: 27.7841s
	iters: 800, epoch: 3 | loss: 0.1152527
	speed: 0.0034s/iter; time left: 32.6762s
	iters: 900, epoch: 3 | loss: 0.2133466
	speed: 0.0029s/iter; time left: 27.9915s
	iters: 1000, epoch: 3 | loss: 0.2394266
	speed: 0.0025s/iter; time left: 23.5999s
	iters: 1100, epoch: 3 | loss: 0.1580252
	speed: 0.0024s/iter; time left: 22.4432s
	iters: 1200, epoch: 3 | loss: 0.2075540
	speed: 0.0030s/iter; time left: 27.3877s
	iters: 1300, epoch: 3 | loss: 0.1877861
	speed: 0.0024s/iter; time left: 21.7377s
Epoch: 3 cost time: 3.5s
Epoch: 3, Steps: 1309 | Train Loss: 0.1618619 Vali Loss: 1.0787104 Test Loss: 3.0784767
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0540404
	speed: 0.0109s/iter; time left: 98.7399s
	iters: 200, epoch: 4 | loss: 0.1210846
	speed: 0.0106s/iter; time left: 94.8122s
	iters: 300, epoch: 4 | loss: 0.1528390
	speed: 0.0213s/iter; time left: 188.9526s
	iters: 400, epoch: 4 | loss: 0.0718170
	speed: 0.0257s/iter; time left: 225.5721s
	iters: 500, epoch: 4 | loss: 0.3208000
	speed: 0.0271s/iter; time left: 234.7554s
	iters: 600, epoch: 4 | loss: 0.1340033
	speed: 0.0166s/iter; time left: 142.0267s
	iters: 700, epoch: 4 | loss: 0.1172469
	speed: 0.0039s/iter; time left: 33.3722s
	iters: 800, epoch: 4 | loss: 0.2024315
	speed: 0.0026s/iter; time left: 21.4588s
	iters: 900, epoch: 4 | loss: 0.0718304
	speed: 0.0025s/iter; time left: 20.8740s
	iters: 1000, epoch: 4 | loss: 0.0900781
	speed: 0.0022s/iter; time left: 18.2552s
	iters: 1100, epoch: 4 | loss: 0.0918994
	speed: 0.0037s/iter; time left: 29.6105s
	iters: 1200, epoch: 4 | loss: 0.3046718
	speed: 0.0023s/iter; time left: 18.2693s
	iters: 1300, epoch: 4 | loss: 0.1738168
	speed: 0.0027s/iter; time left: 21.3544s
Epoch: 4 cost time: 12.5s
Epoch: 4, Steps: 1309 | Train Loss: 0.1578114 Vali Loss: 0.8692709 Test Loss: 3.1450639
Validation loss decreased (0.927866 --> 0.869271).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1160289
	speed: 0.0076s/iter; time left: 58.9504s
	iters: 200, epoch: 5 | loss: 0.1206684
	speed: 0.0024s/iter; time left: 18.2491s
	iters: 300, epoch: 5 | loss: 0.2959651
	speed: 0.0021s/iter; time left: 16.1831s
	iters: 400, epoch: 5 | loss: 0.0817692
	speed: 0.0022s/iter; time left: 16.7334s
	iters: 500, epoch: 5 | loss: 0.1134561
	speed: 0.0023s/iter; time left: 16.5534s
	iters: 600, epoch: 5 | loss: 0.0618967
	speed: 0.0022s/iter; time left: 15.7884s
	iters: 700, epoch: 5 | loss: 0.0567961
	speed: 0.0026s/iter; time left: 18.3650s
	iters: 800, epoch: 5 | loss: 0.1332192
	speed: 0.0021s/iter; time left: 15.1012s
	iters: 900, epoch: 5 | loss: 0.1195669
	speed: 0.0085s/iter; time left: 59.0072s
	iters: 1000, epoch: 5 | loss: 0.1125997
	speed: 0.0123s/iter; time left: 84.4243s
	iters: 1100, epoch: 5 | loss: 0.1113762
	speed: 0.0178s/iter; time left: 119.9659s
	iters: 1200, epoch: 5 | loss: 0.0944365
	speed: 0.0190s/iter; time left: 126.5057s
	iters: 1300, epoch: 5 | loss: 0.0919999
	speed: 0.0208s/iter; time left: 136.5470s
Epoch: 5 cost time: 9.8s
Epoch: 5, Steps: 1309 | Train Loss: 0.1562942 Vali Loss: 0.9423775 Test Loss: 2.4325037
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1164729
	speed: 0.0851s/iter; time left: 548.6363s
	iters: 200, epoch: 6 | loss: 0.5367226
	speed: 0.0273s/iter; time left: 173.3871s
	iters: 300, epoch: 6 | loss: 0.1659870
	speed: 0.0286s/iter; time left: 178.7525s
	iters: 400, epoch: 6 | loss: 0.1477595
	speed: 0.0247s/iter; time left: 151.6645s
	iters: 500, epoch: 6 | loss: 0.1725020
	speed: 0.0043s/iter; time left: 26.0399s
	iters: 600, epoch: 6 | loss: 0.1208759
	speed: 0.0029s/iter; time left: 17.1339s
	iters: 700, epoch: 6 | loss: 0.1787789
	speed: 0.0024s/iter; time left: 14.0331s
	iters: 800, epoch: 6 | loss: 0.2075197
	speed: 0.0024s/iter; time left: 14.0132s
	iters: 900, epoch: 6 | loss: 0.1349519
	speed: 0.0021s/iter; time left: 11.8589s
	iters: 1000, epoch: 6 | loss: 0.1524165
	speed: 0.0022s/iter; time left: 12.4289s
	iters: 1100, epoch: 6 | loss: 0.0703583
	speed: 0.0023s/iter; time left: 12.4150s
	iters: 1200, epoch: 6 | loss: 0.0942365
	speed: 0.0022s/iter; time left: 11.5609s
	iters: 1300, epoch: 6 | loss: 0.1345117
	speed: 0.0023s/iter; time left: 12.2156s
Epoch: 6 cost time: 13.1s
Epoch: 6, Steps: 1309 | Train Loss: 0.1551993 Vali Loss: 0.8412348 Test Loss: 2.4296927
Validation loss decreased (0.869271 --> 0.841235).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.3054274
	speed: 0.0094s/iter; time left: 48.0611s
	iters: 200, epoch: 7 | loss: 0.1410641
	speed: 0.0022s/iter; time left: 11.0096s
	iters: 300, epoch: 7 | loss: 0.1167924
	speed: 0.0022s/iter; time left: 11.0369s
	iters: 400, epoch: 7 | loss: 0.0997056
	speed: 0.0022s/iter; time left: 10.5913s
	iters: 500, epoch: 7 | loss: 0.0819306
	speed: 0.0024s/iter; time left: 11.5328s
	iters: 600, epoch: 7 | loss: 0.3674305
	speed: 0.0022s/iter; time left: 10.1506s
	iters: 700, epoch: 7 | loss: 0.1375314
	speed: 0.0024s/iter; time left: 11.0950s
	iters: 800, epoch: 7 | loss: 0.2559153
	speed: 0.0023s/iter; time left: 9.9911s
	iters: 900, epoch: 7 | loss: 0.0785479
	speed: 0.0023s/iter; time left: 9.9226s
	iters: 1000, epoch: 7 | loss: 0.1418245
	speed: 0.0023s/iter; time left: 9.7823s
	iters: 1100, epoch: 7 | loss: 0.0852078
	speed: 0.0023s/iter; time left: 9.7193s
	iters: 1200, epoch: 7 | loss: 0.0799595
	speed: 0.0022s/iter; time left: 8.8221s
	iters: 1300, epoch: 7 | loss: 0.0909280
	speed: 0.0023s/iter; time left: 8.8939s
Epoch: 7 cost time: 3.0s
Epoch: 7, Steps: 1309 | Train Loss: 0.1547669 Vali Loss: 0.8827996 Test Loss: 2.3145289
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2956426
	speed: 0.0079s/iter; time left: 30.0816s
	iters: 200, epoch: 8 | loss: 0.2706141
	speed: 0.0023s/iter; time left: 8.5112s
	iters: 300, epoch: 8 | loss: 0.1588497
	speed: 0.0024s/iter; time left: 8.6678s
	iters: 400, epoch: 8 | loss: 0.0547939
	speed: 0.0022s/iter; time left: 7.7314s
	iters: 500, epoch: 8 | loss: 0.1157751
	speed: 0.0027s/iter; time left: 9.1575s
	iters: 600, epoch: 8 | loss: 0.3049809
	speed: 0.0023s/iter; time left: 7.5185s
	iters: 700, epoch: 8 | loss: 0.1457459
	speed: 0.0027s/iter; time left: 8.7516s
	iters: 800, epoch: 8 | loss: 0.0770579
	speed: 0.0021s/iter; time left: 6.6879s
	iters: 900, epoch: 8 | loss: 0.0814037
	speed: 0.0031s/iter; time left: 9.3011s
	iters: 1000, epoch: 8 | loss: 0.1078595
	speed: 0.0023s/iter; time left: 6.8299s
	iters: 1100, epoch: 8 | loss: 0.1375544
	speed: 0.0023s/iter; time left: 6.5899s
	iters: 1200, epoch: 8 | loss: 0.2189958
	speed: 0.0023s/iter; time left: 6.4044s
	iters: 1300, epoch: 8 | loss: 0.0898421
	speed: 0.0022s/iter; time left: 5.8891s
Epoch: 8 cost time: 3.2s
Epoch: 8, Steps: 1309 | Train Loss: 0.1544547 Vali Loss: 0.9114756 Test Loss: 2.3334296
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1028022
	speed: 0.0073s/iter; time left: 18.2789s
	iters: 200, epoch: 9 | loss: 0.1455494
	speed: 0.0025s/iter; time left: 5.9811s
	iters: 300, epoch: 9 | loss: 0.2119870
	speed: 0.0024s/iter; time left: 5.4553s
	iters: 400, epoch: 9 | loss: 0.1464937
	speed: 0.0022s/iter; time left: 4.9011s
	iters: 500, epoch: 9 | loss: 0.1889764
	speed: 0.0024s/iter; time left: 5.0616s
	iters: 600, epoch: 9 | loss: 0.1675824
	speed: 0.0023s/iter; time left: 4.6625s
	iters: 700, epoch: 9 | loss: 0.0757332
	speed: 0.0024s/iter; time left: 4.5124s
	iters: 800, epoch: 9 | loss: 0.1496141
	speed: 0.0024s/iter; time left: 4.4142s
	iters: 900, epoch: 9 | loss: 0.3006307
	speed: 0.0023s/iter; time left: 3.9282s
	iters: 1000, epoch: 9 | loss: 0.2418497
	speed: 0.0021s/iter; time left: 3.3964s
	iters: 1100, epoch: 9 | loss: 0.1176955
	speed: 0.0026s/iter; time left: 3.8961s
	iters: 1200, epoch: 9 | loss: 0.1552184
	speed: 0.0021s/iter; time left: 3.0260s
	iters: 1300, epoch: 9 | loss: 0.1669560
	speed: 0.0023s/iter; time left: 2.9980s
Epoch: 9 cost time: 3.0s
Epoch: 9, Steps: 1309 | Train Loss: 0.1543932 Vali Loss: 0.8687466 Test Loss: 2.3174200
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : GD_336_192_M_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2953

Final Metrics:

DLinear      MSE: 2.429693   MAE: 1.152969   SE: 4.824863   RRMSE: 0.156628   RMAE: 0.115854   (numpy)
DLinear      MSE: 2.429693   MAE: 1.152969   SE: 4.824863   RRMSE: 0.156628   RMAE: 0.115854   (torch)

Repeat       MSE: 2.249958   MAE: 1.076820   SE: 4.923409   RRMSE: 0.150723   RMAE: 0.108202   (numpy)
Repeat       MSE: 2.249958   MAE: 1.076820   SE: 4.923409   RRMSE: 0.150723   RMAE: 0.108202   (torch)

Shapes: pred (2952, 192, 6), true (2952, 192, 6), naive_pred (2952, 192, 6), gt (2952, 528, 6), metrics {'DLinear': {'mse': 2.4296935, 'mae': 1.1529692, 'se': 4.8248634, 'relative_rmse': 0.1566279, 'relative_mae': 0.11585401, 'mse_torch': 2.4296927452087402, 'mae_torch': 1.1529693603515625, 'se_torch': 4.824862957000732, 'relative_rmse_torch': 0.15662786559091238, 'relative_mae_torch': 0.1158540225669717}, 'Repeat': {'mse': 2.2499583, 'mae': 1.07682, 'se': 4.9234085, 'relative_rmse': 0.15072337, 'relative_mae': 0.10820229, 'mse_torch': 2.2499582767486572, 'mae_torch': 1.0768200159072876, 'se_torch': 4.923408508300781, 'relative_rmse_torch': 0.15072336572861303, 'relative_mae_torch': 0.10820229462598197}}
