Args in experiment:
Namespace(is_training=1, model_id='MRO_336_720_MS_channels_6', model='DLinear_FITS', data='custom', root_path='./dataset/', data_path='MRO.csv', features='MS', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
MRO_336_720_MS_channels_6
Use CPU
FITS cutoff frequency: 49

Model(
  (decomposition): SeriesDecomp(
    (moving_avg): MovingAvg(
      (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=49, out_features=154, bias=True)
  )
  (Linear_Seasonal): Linear(in_features=336, out_features=720, bias=True)
  (Linear_Trend): Linear(in_features=336, out_features=720, bias=True)
)

>>>>>>>start training : MRO_336_720_MS_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 9951
val 855
test 2425
	iters: 100, epoch: 1 | loss: 0.4332385
	speed: 0.0102s/iter; time left: 126.0358s
	iters: 200, epoch: 1 | loss: 0.1271793
	speed: 0.0071s/iter; time left: 86.9212s
	iters: 300, epoch: 1 | loss: 0.1023227
	speed: 0.0072s/iter; time left: 87.5221s
	iters: 400, epoch: 1 | loss: 0.1288279
	speed: 0.0067s/iter; time left: 81.1752s
	iters: 500, epoch: 1 | loss: 0.1927281
	speed: 0.0069s/iter; time left: 82.3270s
	iters: 600, epoch: 1 | loss: 0.1159155
	speed: 0.0083s/iter; time left: 98.1218s
	iters: 700, epoch: 1 | loss: 0.2568341
	speed: 0.0068s/iter; time left: 80.2569s
	iters: 800, epoch: 1 | loss: 0.0771294
	speed: 0.0069s/iter; time left: 80.6368s
	iters: 900, epoch: 1 | loss: 0.0556552
	speed: 0.0071s/iter; time left: 82.1899s
	iters: 1000, epoch: 1 | loss: 0.1307700
	speed: 0.0068s/iter; time left: 77.4586s
	iters: 1100, epoch: 1 | loss: 0.1062624
	speed: 0.0075s/iter; time left: 84.6582s
	iters: 1200, epoch: 1 | loss: 0.2207653
	speed: 0.0070s/iter; time left: 78.5694s
Epoch: 1 cost time: 8.9s
Epoch: 1, Steps: 1243 | Train Loss: 0.1555388 Vali Loss: 12.8101025 Test Loss: 23.2142353
Validation loss decreased (inf --> 12.810102).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0717779
	speed: 0.0210s/iter; time left: 233.3243s
	iters: 200, epoch: 2 | loss: 0.0329482
	speed: 0.0079s/iter; time left: 86.6016s
	iters: 300, epoch: 2 | loss: 0.1306872
	speed: 0.0072s/iter; time left: 78.0673s
	iters: 400, epoch: 2 | loss: 0.1659930
	speed: 0.0077s/iter; time left: 83.3815s
	iters: 500, epoch: 2 | loss: 0.1260529
	speed: 0.0068s/iter; time left: 72.4493s
	iters: 600, epoch: 2 | loss: 0.1964865
	speed: 0.0079s/iter; time left: 83.2382s
	iters: 700, epoch: 2 | loss: 0.1249960
	speed: 0.0069s/iter; time left: 72.0304s
	iters: 800, epoch: 2 | loss: 0.2052855
	speed: 0.0072s/iter; time left: 74.7342s
	iters: 900, epoch: 2 | loss: 0.0419334
	speed: 0.0074s/iter; time left: 75.6248s
	iters: 1000, epoch: 2 | loss: 0.1252251
	speed: 0.0069s/iter; time left: 70.1279s
	iters: 1100, epoch: 2 | loss: 0.1608452
	speed: 0.0069s/iter; time left: 69.4524s
	iters: 1200, epoch: 2 | loss: 0.1510362
	speed: 0.0076s/iter; time left: 75.9882s
Epoch: 2 cost time: 9.1s
Epoch: 2, Steps: 1243 | Train Loss: 0.1368968 Vali Loss: 12.1521864 Test Loss: 22.7116985
Validation loss decreased (12.810102 --> 12.152186).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1326897
	speed: 0.0209s/iter; time left: 206.2224s
	iters: 200, epoch: 3 | loss: 0.2104333
	speed: 0.0083s/iter; time left: 80.8980s
	iters: 300, epoch: 3 | loss: 0.0862109
	speed: 0.0081s/iter; time left: 77.9249s
	iters: 400, epoch: 3 | loss: 0.1468582
	speed: 0.0072s/iter; time left: 68.2536s
	iters: 500, epoch: 3 | loss: 0.0980690
	speed: 0.0074s/iter; time left: 69.5222s
	iters: 600, epoch: 3 | loss: 0.1028535
	speed: 0.0071s/iter; time left: 66.5192s
	iters: 700, epoch: 3 | loss: 0.1888946
	speed: 0.0068s/iter; time left: 63.2473s
	iters: 800, epoch: 3 | loss: 0.1253630
	speed: 0.0073s/iter; time left: 66.9754s
	iters: 900, epoch: 3 | loss: 0.0559966
	speed: 0.0072s/iter; time left: 64.8665s
	iters: 1000, epoch: 3 | loss: 0.0746895
	speed: 0.0065s/iter; time left: 58.5590s
	iters: 1100, epoch: 3 | loss: 0.0851212
	speed: 0.0069s/iter; time left: 60.7184s
	iters: 1200, epoch: 3 | loss: 0.0292015
	speed: 0.0075s/iter; time left: 66.0119s
Epoch: 3 cost time: 9.1s
Epoch: 3, Steps: 1243 | Train Loss: 0.1326877 Vali Loss: 12.1350050 Test Loss: 22.4781055
Validation loss decreased (12.152186 --> 12.135005).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0734050
	speed: 0.0209s/iter; time left: 179.9168s
	iters: 200, epoch: 4 | loss: 0.2453654
	speed: 0.0079s/iter; time left: 67.1286s
	iters: 300, epoch: 4 | loss: 0.0484894
	speed: 0.0069s/iter; time left: 58.3479s
	iters: 400, epoch: 4 | loss: 0.1914401
	speed: 0.0073s/iter; time left: 60.2390s
	iters: 500, epoch: 4 | loss: 0.0596488
	speed: 0.0068s/iter; time left: 56.1633s
	iters: 600, epoch: 4 | loss: 0.1050608
	speed: 0.0073s/iter; time left: 59.4489s
	iters: 700, epoch: 4 | loss: 0.2977941
	speed: 0.0073s/iter; time left: 58.7801s
	iters: 800, epoch: 4 | loss: 0.1242039
	speed: 0.0072s/iter; time left: 57.1637s
	iters: 900, epoch: 4 | loss: 0.0882342
	speed: 0.0078s/iter; time left: 61.0919s
	iters: 1000, epoch: 4 | loss: 0.0894215
	speed: 0.0073s/iter; time left: 56.0168s
	iters: 1100, epoch: 4 | loss: 0.1970093
	speed: 0.0081s/iter; time left: 61.9164s
	iters: 1200, epoch: 4 | loss: 0.1572731
	speed: 0.0077s/iter; time left: 57.6324s
Epoch: 4 cost time: 9.2s
Epoch: 4, Steps: 1243 | Train Loss: 0.1311647 Vali Loss: 11.7748871 Test Loss: 22.1637211
Validation loss decreased (12.135005 --> 11.774887).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0732609
	speed: 0.0227s/iter; time left: 167.1204s
	iters: 200, epoch: 5 | loss: 0.0894036
	speed: 0.0073s/iter; time left: 52.8655s
	iters: 300, epoch: 5 | loss: 0.1414734
	speed: 0.0077s/iter; time left: 55.2246s
	iters: 400, epoch: 5 | loss: 0.0811708
	speed: 0.0077s/iter; time left: 54.5660s
	iters: 500, epoch: 5 | loss: 0.1174771
	speed: 0.0072s/iter; time left: 50.1985s
	iters: 600, epoch: 5 | loss: 0.0925784
	speed: 0.0073s/iter; time left: 50.3767s
	iters: 700, epoch: 5 | loss: 0.2835183
	speed: 0.0073s/iter; time left: 49.4951s
	iters: 800, epoch: 5 | loss: 0.0696457
	speed: 0.0072s/iter; time left: 47.7568s
	iters: 900, epoch: 5 | loss: 0.1354562
	speed: 0.0072s/iter; time left: 47.0510s
	iters: 1000, epoch: 5 | loss: 0.1321312
	speed: 0.0070s/iter; time left: 45.1774s
	iters: 1100, epoch: 5 | loss: 0.1034648
	speed: 0.0078s/iter; time left: 49.6224s
	iters: 1200, epoch: 5 | loss: 0.0580736
	speed: 0.0080s/iter; time left: 49.9366s
Epoch: 5 cost time: 9.4s
Epoch: 5, Steps: 1243 | Train Loss: 0.1299231 Vali Loss: 10.7487726 Test Loss: 19.9857292
Validation loss decreased (11.774887 --> 10.748773).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1761585
	speed: 0.0206s/iter; time left: 125.7563s
	iters: 200, epoch: 6 | loss: 0.1072032
	speed: 0.0068s/iter; time left: 41.1108s
	iters: 300, epoch: 6 | loss: 0.1163341
	speed: 0.0073s/iter; time left: 43.0261s
	iters: 400, epoch: 6 | loss: 0.1500673
	speed: 0.0069s/iter; time left: 40.3217s
	iters: 500, epoch: 6 | loss: 0.1301049
	speed: 0.0070s/iter; time left: 40.2047s
	iters: 600, epoch: 6 | loss: 0.1920045
	speed: 0.0075s/iter; time left: 42.2354s
	iters: 700, epoch: 6 | loss: 0.2235863
	speed: 0.0074s/iter; time left: 40.8710s
	iters: 800, epoch: 6 | loss: 0.0997562
	speed: 0.0068s/iter; time left: 36.9454s
	iters: 900, epoch: 6 | loss: 0.0893410
	speed: 0.0072s/iter; time left: 38.2537s
	iters: 1000, epoch: 6 | loss: 0.0701381
	speed: 0.0072s/iter; time left: 37.7236s
	iters: 1100, epoch: 6 | loss: 0.1000855
	speed: 0.0070s/iter; time left: 35.9682s
	iters: 1200, epoch: 6 | loss: 0.1203658
	speed: 0.0074s/iter; time left: 37.2664s
Epoch: 6 cost time: 8.9s
Epoch: 6, Steps: 1243 | Train Loss: 0.1294586 Vali Loss: 11.8735294 Test Loss: 22.3272152
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0548984
	speed: 0.0213s/iter; time left: 103.5723s
	iters: 200, epoch: 7 | loss: 0.0926630
	speed: 0.0069s/iter; time left: 32.7513s
	iters: 300, epoch: 7 | loss: 0.0922849
	speed: 0.0071s/iter; time left: 33.3634s
	iters: 400, epoch: 7 | loss: 0.0930141
	speed: 0.0071s/iter; time left: 32.5761s
	iters: 500, epoch: 7 | loss: 0.2205079
	speed: 0.0074s/iter; time left: 32.9716s
	iters: 600, epoch: 7 | loss: 0.0563462
	speed: 0.0071s/iter; time left: 31.2411s
	iters: 700, epoch: 7 | loss: 0.0670182
	speed: 0.0074s/iter; time left: 31.5202s
	iters: 800, epoch: 7 | loss: 0.1056377
	speed: 0.0067s/iter; time left: 27.9558s
	iters: 900, epoch: 7 | loss: 0.2142849
	speed: 0.0072s/iter; time left: 29.4715s
	iters: 1000, epoch: 7 | loss: 0.1355100
	speed: 0.0071s/iter; time left: 28.3226s
	iters: 1100, epoch: 7 | loss: 0.1604186
	speed: 0.0070s/iter; time left: 27.3019s
	iters: 1200, epoch: 7 | loss: 0.0315705
	speed: 0.0073s/iter; time left: 27.6128s
Epoch: 7 cost time: 8.9s
Epoch: 7, Steps: 1243 | Train Loss: 0.1291224 Vali Loss: 11.8283396 Test Loss: 22.2380238
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0772110
	speed: 0.0213s/iter; time left: 77.3295s
	iters: 200, epoch: 8 | loss: 0.0226513
	speed: 0.0068s/iter; time left: 23.9070s
	iters: 300, epoch: 8 | loss: 0.0982865
	speed: 0.0067s/iter; time left: 23.0555s
	iters: 400, epoch: 8 | loss: 0.1049734
	speed: 0.0082s/iter; time left: 27.3727s
	iters: 500, epoch: 8 | loss: 0.0708654
	speed: 0.0070s/iter; time left: 22.5609s
	iters: 600, epoch: 8 | loss: 0.1505860
	speed: 0.0069s/iter; time left: 21.4475s
	iters: 700, epoch: 8 | loss: 0.1425061
	speed: 0.0072s/iter; time left: 21.9257s
	iters: 800, epoch: 8 | loss: 0.1006484
	speed: 0.0071s/iter; time left: 20.7138s
	iters: 900, epoch: 8 | loss: 0.1284005
	speed: 0.0069s/iter; time left: 19.4114s
	iters: 1000, epoch: 8 | loss: 0.1111461
	speed: 0.0077s/iter; time left: 21.0599s
	iters: 1100, epoch: 8 | loss: 0.2309290
	speed: 0.0073s/iter; time left: 19.3004s
	iters: 1200, epoch: 8 | loss: 0.2082419
	speed: 0.0072s/iter; time left: 18.1716s
Epoch: 8 cost time: 9.0s
Epoch: 8, Steps: 1243 | Train Loss: 0.1288874 Vali Loss: 11.8634720 Test Loss: 22.3266220
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : MRO_336_720_MS_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2425

Final Metrics:

DLinear_FITS MSE: 19.985725  MAE: 3.499062   SE: 34.044544  RRMSE: 0.593472   RMAE: 0.464507   (numpy)
DLinear_FITS MSE: 19.985729  MAE: 3.499061   SE: 34.044548  RRMSE: 0.593473   RMAE: 0.464507   (torch)

Repeat       MSE: 23.184877  MAE: 3.680038   SE: 39.829136  RRMSE: 0.639209   RMAE: 0.488532   (numpy)
Repeat       MSE: 23.184883  MAE: 3.680040   SE: 39.829136  RRMSE: 0.639209   RMAE: 0.488532   (torch)

Shapes: pred (2424, 720, 1), true (2424, 720, 1), naive_pred (2424, 720, 1), gt (2424, 1056, 1), metrics {'DLinear_FITS': {'mse': 19.985725, 'mae': 3.4990618, 'se': 34.044544, 'relative_rmse': 0.5934725, 'relative_mae': 0.46450698, 'mse_torch': 19.985729217529297, 'mae_torch': 3.499061107635498, 'se_torch': 34.04454803466797, 'relative_rmse_torch': 0.5934725512572075, 'relative_mae_torch': 0.4645068948423782}, 'Repeat': {'mse': 23.184877, 'mae': 3.680038, 'se': 39.829136, 'relative_rmse': 0.6392092, 'relative_mae': 0.48853192, 'mse_torch': 23.18488311767578, 'mae_torch': 3.680039882659912, 'se_torch': 39.82913589477539, 'relative_rmse_torch': 0.6392093119291181, 'relative_mae_torch': 0.4885321651171737}}
