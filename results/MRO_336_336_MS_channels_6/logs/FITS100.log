Args in experiment:
Namespace(is_training=1, model_id='MRO_336_336_MS_channels_6', model='FITS100', data='custom', root_path='./dataset/', data_path='MRO.csv', features='MS', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
MRO_336_336_MS_channels_6
Use CPU
FITS cutoff frequency: 100

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=100, out_features=200, bias=True)
  )
)

>>>>>>>start training : MRO_336_336_MS_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10335
val 1239
test 2809
	iters: 100, epoch: 1 | loss: 0.1005295
	speed: 0.0058s/iter; time left: 73.7121s
	iters: 200, epoch: 1 | loss: 0.0721222
	speed: 0.0025s/iter; time left: 31.6230s
	iters: 300, epoch: 1 | loss: 0.0612074
	speed: 0.0022s/iter; time left: 27.5772s
	iters: 400, epoch: 1 | loss: 0.0817606
	speed: 0.0021s/iter; time left: 25.6663s
	iters: 500, epoch: 1 | loss: 0.1845268
	speed: 0.0020s/iter; time left: 25.1730s
	iters: 600, epoch: 1 | loss: 0.1271825
	speed: 0.0022s/iter; time left: 27.6345s
	iters: 700, epoch: 1 | loss: 0.0995920
	speed: 0.0022s/iter; time left: 26.3961s
	iters: 800, epoch: 1 | loss: 0.2134987
	speed: 0.0021s/iter; time left: 24.8575s
	iters: 900, epoch: 1 | loss: 0.0458687
	speed: 0.0020s/iter; time left: 24.5383s
	iters: 1000, epoch: 1 | loss: 0.0470695
	speed: 0.0021s/iter; time left: 25.3563s
	iters: 1100, epoch: 1 | loss: 0.0346911
	speed: 0.0024s/iter; time left: 28.8177s
	iters: 1200, epoch: 1 | loss: 0.1896564
	speed: 0.0024s/iter; time left: 28.3443s
Epoch: 1 cost time: 2.9s
Epoch: 1, Steps: 1291 | Train Loss: 0.1203721 Vali Loss: 8.5349092 Test Loss: 11.7287941
Validation loss decreased (inf --> 8.534909).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0355677
	speed: 0.0105s/iter; time left: 120.4218s
	iters: 200, epoch: 2 | loss: 0.1215187
	speed: 0.0026s/iter; time left: 29.4742s
	iters: 300, epoch: 2 | loss: 0.0916338
	speed: 0.0027s/iter; time left: 30.7994s
	iters: 400, epoch: 2 | loss: 0.0794483
	speed: 0.0032s/iter; time left: 35.3778s
	iters: 500, epoch: 2 | loss: 0.0428756
	speed: 0.0032s/iter; time left: 35.4105s
	iters: 600, epoch: 2 | loss: 0.0563978
	speed: 0.0022s/iter; time left: 24.7456s
	iters: 700, epoch: 2 | loss: 0.1939820
	speed: 0.0024s/iter; time left: 26.3928s
	iters: 800, epoch: 2 | loss: 0.0156468
	speed: 0.0022s/iter; time left: 23.6784s
	iters: 900, epoch: 2 | loss: 0.1833787
	speed: 0.0024s/iter; time left: 26.1179s
	iters: 1000, epoch: 2 | loss: 0.0177162
	speed: 0.0023s/iter; time left: 24.7802s
	iters: 1100, epoch: 2 | loss: 0.0553828
	speed: 0.0022s/iter; time left: 23.2202s
	iters: 1200, epoch: 2 | loss: 0.0834635
	speed: 0.0025s/iter; time left: 26.1510s
Epoch: 2 cost time: 3.4s
Epoch: 2, Steps: 1291 | Train Loss: 0.1070879 Vali Loss: 8.2151937 Test Loss: 11.2193193
Validation loss decreased (8.534909 --> 8.215194).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0424310
	speed: 0.0105s/iter; time left: 107.1948s
	iters: 200, epoch: 3 | loss: 0.0504911
	speed: 0.0024s/iter; time left: 24.4201s
	iters: 300, epoch: 3 | loss: 0.0497319
	speed: 0.0022s/iter; time left: 22.3169s
	iters: 400, epoch: 3 | loss: 0.0454565
	speed: 0.0024s/iter; time left: 23.4182s
	iters: 500, epoch: 3 | loss: 0.2695997
	speed: 0.0030s/iter; time left: 29.0861s
	iters: 600, epoch: 3 | loss: 0.0686782
	speed: 0.0026s/iter; time left: 25.5051s
	iters: 700, epoch: 3 | loss: 0.0426382
	speed: 0.0023s/iter; time left: 22.5631s
	iters: 800, epoch: 3 | loss: 0.0633816
	speed: 0.0021s/iter; time left: 19.8364s
	iters: 900, epoch: 3 | loss: 0.1197405
	speed: 0.0021s/iter; time left: 19.4210s
	iters: 1000, epoch: 3 | loss: 0.0421591
	speed: 0.0022s/iter; time left: 20.4215s
	iters: 1100, epoch: 3 | loss: 0.0759019
	speed: 0.0021s/iter; time left: 18.9410s
	iters: 1200, epoch: 3 | loss: 0.0090694
	speed: 0.0021s/iter; time left: 19.4592s
Epoch: 3 cost time: 3.0s
Epoch: 3, Steps: 1291 | Train Loss: 0.1039299 Vali Loss: 8.0463095 Test Loss: 11.0147820
Validation loss decreased (8.215194 --> 8.046309).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0345435
	speed: 0.0095s/iter; time left: 84.6157s
	iters: 200, epoch: 4 | loss: 0.0223618
	speed: 0.0022s/iter; time left: 19.1862s
	iters: 300, epoch: 4 | loss: 0.1042853
	speed: 0.0023s/iter; time left: 20.2692s
	iters: 400, epoch: 4 | loss: 0.1166831
	speed: 0.0024s/iter; time left: 20.5905s
	iters: 500, epoch: 4 | loss: 0.0805837
	speed: 0.0028s/iter; time left: 23.9662s
	iters: 600, epoch: 4 | loss: 0.0378693
	speed: 0.0022s/iter; time left: 18.2677s
	iters: 700, epoch: 4 | loss: 0.1182217
	speed: 0.0024s/iter; time left: 19.9121s
	iters: 800, epoch: 4 | loss: 0.0283981
	speed: 0.0023s/iter; time left: 19.3408s
	iters: 900, epoch: 4 | loss: 0.0957588
	speed: 0.0020s/iter; time left: 16.6451s
	iters: 1000, epoch: 4 | loss: 0.0600264
	speed: 0.0019s/iter; time left: 15.5941s
	iters: 1100, epoch: 4 | loss: 0.0797145
	speed: 0.0022s/iter; time left: 17.4568s
	iters: 1200, epoch: 4 | loss: 0.0912164
	speed: 0.0021s/iter; time left: 16.8451s
Epoch: 4 cost time: 2.9s
Epoch: 4, Steps: 1291 | Train Loss: 0.1026880 Vali Loss: 8.0287485 Test Loss: 10.9696627
Validation loss decreased (8.046309 --> 8.028749).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.1202779
	speed: 0.0094s/iter; time left: 71.7243s
	iters: 200, epoch: 5 | loss: 0.2063946
	speed: 0.0025s/iter; time left: 18.8391s
	iters: 300, epoch: 5 | loss: 0.2296575
	speed: 0.0022s/iter; time left: 16.3212s
	iters: 400, epoch: 5 | loss: 0.1645895
	speed: 0.0023s/iter; time left: 17.2294s
	iters: 500, epoch: 5 | loss: 0.1553595
	speed: 0.0024s/iter; time left: 17.5274s
	iters: 600, epoch: 5 | loss: 0.0488649
	speed: 0.0022s/iter; time left: 15.6260s
	iters: 700, epoch: 5 | loss: 0.0751965
	speed: 0.0022s/iter; time left: 15.2559s
	iters: 800, epoch: 5 | loss: 0.0484251
	speed: 0.0022s/iter; time left: 15.3739s
	iters: 900, epoch: 5 | loss: 0.1038527
	speed: 0.0022s/iter; time left: 15.2160s
	iters: 1000, epoch: 5 | loss: 0.2771895
	speed: 0.0023s/iter; time left: 15.1957s
	iters: 1100, epoch: 5 | loss: 0.0453051
	speed: 0.0025s/iter; time left: 16.5738s
	iters: 1200, epoch: 5 | loss: 0.1945250
	speed: 0.0023s/iter; time left: 14.7811s
Epoch: 5 cost time: 2.9s
Epoch: 5, Steps: 1291 | Train Loss: 0.1022112 Vali Loss: 8.0129461 Test Loss: 10.9137383
Validation loss decreased (8.028749 --> 8.012946).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1412529
	speed: 0.0089s/iter; time left: 56.6921s
	iters: 200, epoch: 6 | loss: 0.0551684
	speed: 0.0022s/iter; time left: 13.7325s
	iters: 300, epoch: 6 | loss: 0.0416520
	speed: 0.0022s/iter; time left: 13.2435s
	iters: 400, epoch: 6 | loss: 0.0698270
	speed: 0.0022s/iter; time left: 13.4218s
	iters: 500, epoch: 6 | loss: 0.1632760
	speed: 0.0027s/iter; time left: 15.8326s
	iters: 600, epoch: 6 | loss: 0.0506007
	speed: 0.0021s/iter; time left: 12.2782s
	iters: 700, epoch: 6 | loss: 0.0520122
	speed: 0.0029s/iter; time left: 16.8144s
	iters: 800, epoch: 6 | loss: 0.0233144
	speed: 0.0024s/iter; time left: 13.4242s
	iters: 900, epoch: 6 | loss: 0.1221118
	speed: 0.0020s/iter; time left: 11.3855s
	iters: 1000, epoch: 6 | loss: 0.0382939
	speed: 0.0022s/iter; time left: 12.2728s
	iters: 1100, epoch: 6 | loss: 0.1305997
	speed: 0.0023s/iter; time left: 12.1522s
	iters: 1200, epoch: 6 | loss: 0.0367143
	speed: 0.0025s/iter; time left: 13.0471s
Epoch: 6 cost time: 3.0s
Epoch: 6, Steps: 1291 | Train Loss: 0.1018923 Vali Loss: 7.9896722 Test Loss: 10.9041443
Validation loss decreased (8.012946 --> 7.989672).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1216035
	speed: 0.0099s/iter; time left: 50.3756s
	iters: 200, epoch: 7 | loss: 0.0624724
	speed: 0.0021s/iter; time left: 10.4616s
	iters: 300, epoch: 7 | loss: 0.0203968
	speed: 0.0020s/iter; time left: 9.7628s
	iters: 400, epoch: 7 | loss: 0.0586073
	speed: 0.0021s/iter; time left: 9.8908s
	iters: 500, epoch: 7 | loss: 0.0722610
	speed: 0.0024s/iter; time left: 11.0027s
	iters: 600, epoch: 7 | loss: 0.0379588
	speed: 0.0022s/iter; time left: 10.2185s
	iters: 700, epoch: 7 | loss: 0.0570020
	speed: 0.0021s/iter; time left: 9.3492s
	iters: 800, epoch: 7 | loss: 0.0837628
	speed: 0.0027s/iter; time left: 11.8276s
	iters: 900, epoch: 7 | loss: 0.1624752
	speed: 0.0022s/iter; time left: 9.3312s
	iters: 1000, epoch: 7 | loss: 0.0381786
	speed: 0.0022s/iter; time left: 9.0204s
	iters: 1100, epoch: 7 | loss: 0.1626705
	speed: 0.0023s/iter; time left: 9.3991s
	iters: 1200, epoch: 7 | loss: 0.0698176
	speed: 0.0024s/iter; time left: 9.3785s
Epoch: 7 cost time: 2.9s
Epoch: 7, Steps: 1291 | Train Loss: 0.1018658 Vali Loss: 7.9856791 Test Loss: 10.8956919
Validation loss decreased (7.989672 --> 7.985679).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1437835
	speed: 0.0093s/iter; time left: 35.0395s
	iters: 200, epoch: 8 | loss: 0.0679667
	speed: 0.0027s/iter; time left: 9.7647s
	iters: 300, epoch: 8 | loss: 0.0754783
	speed: 0.0024s/iter; time left: 8.7166s
	iters: 400, epoch: 8 | loss: 0.0557428
	speed: 0.0026s/iter; time left: 9.0698s
	iters: 500, epoch: 8 | loss: 0.0678512
	speed: 0.0028s/iter; time left: 9.4089s
	iters: 600, epoch: 8 | loss: 0.0758137
	speed: 0.0025s/iter; time left: 8.3010s
	iters: 700, epoch: 8 | loss: 0.0407683
	speed: 0.0023s/iter; time left: 7.2377s
	iters: 800, epoch: 8 | loss: 0.0813963
	speed: 0.0023s/iter; time left: 7.0225s
	iters: 900, epoch: 8 | loss: 0.1725730
	speed: 0.0023s/iter; time left: 6.7062s
	iters: 1000, epoch: 8 | loss: 0.1013195
	speed: 0.0027s/iter; time left: 7.7786s
	iters: 1100, epoch: 8 | loss: 0.0575035
	speed: 0.0025s/iter; time left: 7.0409s
	iters: 1200, epoch: 8 | loss: 0.0506314
	speed: 0.0025s/iter; time left: 6.5515s
Epoch: 8 cost time: 3.2s
Epoch: 8, Steps: 1291 | Train Loss: 0.1018031 Vali Loss: 7.9704604 Test Loss: 10.8918839
Validation loss decreased (7.985679 --> 7.970460).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.1433297
	speed: 0.0100s/iter; time left: 24.9493s
	iters: 200, epoch: 9 | loss: 0.2049725
	speed: 0.0024s/iter; time left: 5.6724s
	iters: 300, epoch: 9 | loss: 0.1349393
	speed: 0.0030s/iter; time left: 6.9420s
	iters: 400, epoch: 9 | loss: 0.0395784
	speed: 0.0022s/iter; time left: 4.8450s
	iters: 500, epoch: 9 | loss: 0.0328009
	speed: 0.0022s/iter; time left: 4.5850s
	iters: 600, epoch: 9 | loss: 0.0306900
	speed: 0.0023s/iter; time left: 4.6119s
	iters: 700, epoch: 9 | loss: 0.0378628
	speed: 0.0023s/iter; time left: 4.2563s
	iters: 800, epoch: 9 | loss: 0.1715503
	speed: 0.0024s/iter; time left: 4.3360s
	iters: 900, epoch: 9 | loss: 0.1844199
	speed: 0.0024s/iter; time left: 4.1176s
	iters: 1000, epoch: 9 | loss: 0.0600788
	speed: 0.0021s/iter; time left: 3.2628s
	iters: 1100, epoch: 9 | loss: 0.0469586
	speed: 0.0024s/iter; time left: 3.6087s
	iters: 1200, epoch: 9 | loss: 0.3272181
	speed: 0.0025s/iter; time left: 3.4030s
Epoch: 9 cost time: 3.1s
Epoch: 9, Steps: 1291 | Train Loss: 0.1016692 Vali Loss: 7.9776721 Test Loss: 10.8898296
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.1584853
	speed: 0.0096s/iter; time left: 11.4445s
	iters: 200, epoch: 10 | loss: 0.0819426
	speed: 0.0022s/iter; time left: 2.3743s
	iters: 300, epoch: 10 | loss: 0.0274118
	speed: 0.0021s/iter; time left: 2.0633s
	iters: 400, epoch: 10 | loss: 0.1480203
	speed: 0.0022s/iter; time left: 1.9267s
	iters: 500, epoch: 10 | loss: 0.0640552
	speed: 0.0022s/iter; time left: 1.7081s
	iters: 600, epoch: 10 | loss: 0.0285123
	speed: 0.0025s/iter; time left: 1.7009s
	iters: 700, epoch: 10 | loss: 0.0536955
	speed: 0.0021s/iter; time left: 1.2267s
	iters: 800, epoch: 10 | loss: 0.1202182
	speed: 0.0021s/iter; time left: 1.0130s
	iters: 900, epoch: 10 | loss: 0.0818973
	speed: 0.0023s/iter; time left: 0.9053s
	iters: 1000, epoch: 10 | loss: 0.1257447
	speed: 0.0019s/iter; time left: 0.5652s
	iters: 1100, epoch: 10 | loss: 0.0771792
	speed: 0.0021s/iter; time left: 0.3959s
	iters: 1200, epoch: 10 | loss: 0.1213424
	speed: 0.0021s/iter; time left: 0.1926s
Epoch: 10 cost time: 2.8s
Epoch: 10, Steps: 1291 | Train Loss: 0.1017233 Vali Loss: 7.9745951 Test Loss: 10.8889294
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
>>>>>>>testing : MRO_336_336_MS_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2809

Final Metrics:

FITS100      MSE: 10.891885  MAE: 2.545341   SE: 20.770012  RRMSE: 0.404434   RMAE: 0.311919   (numpy)
FITS100      MSE: 10.891884  MAE: 2.545341   SE: 20.770012  RRMSE: 0.404434   RMAE: 0.311919   (torch)

Repeat       MSE: 10.261215  MAE: 2.420922   SE: 21.428272  RRMSE: 0.392551   RMAE: 0.296672   (numpy)
Repeat       MSE: 10.261217  MAE: 2.420922   SE: 21.428272  RRMSE: 0.392551   RMAE: 0.296672   (torch)

Shapes: pred (2808, 336, 1), true (2808, 336, 1), naive_pred (2808, 336, 1), gt (2808, 672, 1), metrics {'FITS100': {'mse': 10.891885, 'mae': 2.545341, 'se': 20.770012, 'relative_rmse': 0.40443423, 'relative_mae': 0.3119194, 'mse_torch': 10.891883850097656, 'mae_torch': 2.5453412532806396, 'se_torch': 20.77001190185547, 'relative_rmse_torch': 0.40443422439835314, 'relative_mae_torch': 0.31191942052054283}, 'Repeat': {'mse': 10.261215, 'mae': 2.4209218, 'se': 21.428272, 'relative_rmse': 0.39255074, 'relative_mae': 0.2966724, 'mse_torch': 10.26121711730957, 'mae_torch': 2.420921564102173, 'se_torch': 21.428272247314453, 'relative_rmse_torch': 0.3925507735448641, 'relative_mae_torch': 0.2966723815233658}}
