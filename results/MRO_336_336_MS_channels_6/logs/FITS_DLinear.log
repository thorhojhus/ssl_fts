Args in experiment:
Namespace(is_training=1, model_id='MRO_336_336_MS_channels_6', model='FITS_DLinear', data='custom', root_path='./dataset/', data_path='MRO.csv', features='MS', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
MRO_336_336_MS_channels_6
Use CPU

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=168, out_features=336, bias=True)
  )
  (dlinear): Model(
    (decompsition): series_decomp(
      (moving_avg): moving_avg(
        (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
      )
    )
    (Linear_Seasonal): Linear(in_features=336, out_features=336, bias=True)
    (Linear_Trend): Linear(in_features=336, out_features=336, bias=True)
    (Linear_Decoder): Linear(in_features=336, out_features=336, bias=True)
  )
)

>>>>>>>start training : MRO_336_336_MS_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10335
val 1239
test 2809
	iters: 100, epoch: 1 | loss: 0.0552336
	speed: 0.0071s/iter; time left: 91.2431s
	iters: 200, epoch: 1 | loss: 0.0730760
	speed: 0.0038s/iter; time left: 48.6009s
	iters: 300, epoch: 1 | loss: 0.0639803
	speed: 0.0036s/iter; time left: 45.0713s
	iters: 400, epoch: 1 | loss: 0.0496654
	speed: 0.0036s/iter; time left: 45.6256s
	iters: 500, epoch: 1 | loss: 0.0623535
	speed: 0.0037s/iter; time left: 45.7228s
	iters: 600, epoch: 1 | loss: 0.1151935
	speed: 0.0042s/iter; time left: 51.2643s
	iters: 700, epoch: 1 | loss: 0.0637172
	speed: 0.0043s/iter; time left: 52.0888s
	iters: 800, epoch: 1 | loss: 0.1628788
	speed: 0.0037s/iter; time left: 44.2347s
	iters: 900, epoch: 1 | loss: 0.0288503
	speed: 0.0039s/iter; time left: 47.2747s
	iters: 1000, epoch: 1 | loss: 0.0803232
	speed: 0.0038s/iter; time left: 44.8368s
	iters: 1100, epoch: 1 | loss: 0.1157890
	speed: 0.0040s/iter; time left: 47.4943s
	iters: 1200, epoch: 1 | loss: 0.0956293
	speed: 0.0039s/iter; time left: 45.5578s
Epoch: 1 cost time: 5.0s
Epoch: 1, Steps: 1291 | Train Loss: 0.1041503 Vali Loss: 8.9887314 Test Loss: 13.5170107
Validation loss decreased (inf --> 8.988731).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0425731
	speed: 0.0179s/iter; time left: 206.3836s
	iters: 200, epoch: 2 | loss: 0.0963629
	speed: 0.0040s/iter; time left: 45.1898s
	iters: 300, epoch: 2 | loss: 0.1205702
	speed: 0.0039s/iter; time left: 43.8760s
	iters: 400, epoch: 2 | loss: 0.0670729
	speed: 0.0039s/iter; time left: 44.0433s
	iters: 500, epoch: 2 | loss: 0.0381262
	speed: 0.0042s/iter; time left: 47.0967s
	iters: 600, epoch: 2 | loss: 0.1196883
	speed: 0.0048s/iter; time left: 52.5689s
	iters: 700, epoch: 2 | loss: 0.0376096
	speed: 0.0038s/iter; time left: 41.2781s
	iters: 800, epoch: 2 | loss: 0.0322236
	speed: 0.0040s/iter; time left: 43.4037s
	iters: 900, epoch: 2 | loss: 0.2325039
	speed: 0.0037s/iter; time left: 40.1614s
	iters: 1000, epoch: 2 | loss: 0.1238767
	speed: 0.0040s/iter; time left: 42.1892s
	iters: 1100, epoch: 2 | loss: 0.0431611
	speed: 0.0040s/iter; time left: 42.0735s
	iters: 1200, epoch: 2 | loss: 0.1601309
	speed: 0.0038s/iter; time left: 40.0483s
Epoch: 2 cost time: 5.2s
Epoch: 2, Steps: 1291 | Train Loss: 0.0971921 Vali Loss: 7.6296148 Test Loss: 10.8156414
Validation loss decreased (8.988731 --> 7.629615).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0850171
	speed: 0.0165s/iter; time left: 168.4950s
	iters: 200, epoch: 3 | loss: 0.1623055
	speed: 0.0039s/iter; time left: 39.7528s
	iters: 300, epoch: 3 | loss: 0.1433334
	speed: 0.0036s/iter; time left: 36.2773s
	iters: 400, epoch: 3 | loss: 0.1910530
	speed: 0.0041s/iter; time left: 40.9571s
	iters: 500, epoch: 3 | loss: 0.0272262
	speed: 0.0037s/iter; time left: 36.0891s
	iters: 600, epoch: 3 | loss: 0.1216215
	speed: 0.0039s/iter; time left: 37.8843s
	iters: 700, epoch: 3 | loss: 0.0741091
	speed: 0.0057s/iter; time left: 54.4167s
	iters: 800, epoch: 3 | loss: 0.1389557
	speed: 0.0040s/iter; time left: 38.5319s
	iters: 900, epoch: 3 | loss: 0.1384856
	speed: 0.0036s/iter; time left: 34.0688s
	iters: 1000, epoch: 3 | loss: 0.0532200
	speed: 0.0036s/iter; time left: 33.9344s
	iters: 1100, epoch: 3 | loss: 0.1418731
	speed: 0.0042s/iter; time left: 38.6356s
	iters: 1200, epoch: 3 | loss: 0.0889634
	speed: 0.0044s/iter; time left: 39.7508s
Epoch: 3 cost time: 5.2s
Epoch: 3, Steps: 1291 | Train Loss: 0.0927129 Vali Loss: 7.7579618 Test Loss: 10.3547592
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0901558
	speed: 0.0201s/iter; time left: 179.3030s
	iters: 200, epoch: 4 | loss: 0.1128573
	speed: 0.0049s/iter; time left: 43.4290s
	iters: 300, epoch: 4 | loss: 0.0237662
	speed: 0.0047s/iter; time left: 40.8789s
	iters: 400, epoch: 4 | loss: 0.0976873
	speed: 0.0045s/iter; time left: 39.2909s
	iters: 500, epoch: 4 | loss: 0.1055759
	speed: 0.0040s/iter; time left: 33.8814s
	iters: 600, epoch: 4 | loss: 0.0977488
	speed: 0.0038s/iter; time left: 31.8384s
	iters: 700, epoch: 4 | loss: 0.0406455
	speed: 0.0037s/iter; time left: 30.7882s
	iters: 800, epoch: 4 | loss: 0.1570472
	speed: 0.0039s/iter; time left: 31.7737s
	iters: 900, epoch: 4 | loss: 0.1408104
	speed: 0.0037s/iter; time left: 30.1559s
	iters: 1000, epoch: 4 | loss: 0.0563581
	speed: 0.0037s/iter; time left: 29.5110s
	iters: 1100, epoch: 4 | loss: 0.0787305
	speed: 0.0044s/iter; time left: 34.7255s
	iters: 1200, epoch: 4 | loss: 0.0455229
	speed: 0.0037s/iter; time left: 28.9130s
Epoch: 4 cost time: 5.3s
Epoch: 4, Steps: 1291 | Train Loss: 0.0901670 Vali Loss: 7.6189852 Test Loss: 10.7492294
Validation loss decreased (7.629615 --> 7.618985).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0270335
	speed: 0.0179s/iter; time left: 137.1827s
	iters: 200, epoch: 5 | loss: 0.0312067
	speed: 0.0035s/iter; time left: 26.2792s
	iters: 300, epoch: 5 | loss: 0.1048534
	speed: 0.0038s/iter; time left: 27.9454s
	iters: 400, epoch: 5 | loss: 0.1623250
	speed: 0.0035s/iter; time left: 25.9074s
	iters: 500, epoch: 5 | loss: 0.0396713
	speed: 0.0039s/iter; time left: 28.1013s
	iters: 600, epoch: 5 | loss: 0.0182274
	speed: 0.0039s/iter; time left: 28.1501s
	iters: 700, epoch: 5 | loss: 0.1171297
	speed: 0.0039s/iter; time left: 27.7620s
	iters: 800, epoch: 5 | loss: 0.0874160
	speed: 0.0038s/iter; time left: 26.1197s
	iters: 900, epoch: 5 | loss: 0.0510488
	speed: 0.0037s/iter; time left: 25.5949s
	iters: 1000, epoch: 5 | loss: 0.0273954
	speed: 0.0038s/iter; time left: 25.3695s
	iters: 1100, epoch: 5 | loss: 0.2100479
	speed: 0.0044s/iter; time left: 28.9880s
	iters: 1200, epoch: 5 | loss: 0.0186787
	speed: 0.0039s/iter; time left: 25.7998s
Epoch: 5 cost time: 5.0s
Epoch: 5, Steps: 1291 | Train Loss: 0.0891477 Vali Loss: 7.5427437 Test Loss: 10.4735813
Validation loss decreased (7.618985 --> 7.542744).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0310516
	speed: 0.0192s/iter; time left: 121.7507s
	iters: 200, epoch: 6 | loss: 0.0816285
	speed: 0.0036s/iter; time left: 22.4492s
	iters: 300, epoch: 6 | loss: 0.0420765
	speed: 0.0038s/iter; time left: 23.3391s
	iters: 400, epoch: 6 | loss: 0.0475093
	speed: 0.0040s/iter; time left: 24.2483s
	iters: 500, epoch: 6 | loss: 0.0623682
	speed: 0.0037s/iter; time left: 22.3214s
	iters: 600, epoch: 6 | loss: 0.0855034
	speed: 0.0041s/iter; time left: 24.0461s
	iters: 700, epoch: 6 | loss: 0.0863109
	speed: 0.0040s/iter; time left: 22.8267s
	iters: 800, epoch: 6 | loss: 0.0593385
	speed: 0.0038s/iter; time left: 21.5886s
	iters: 900, epoch: 6 | loss: 0.1024252
	speed: 0.0039s/iter; time left: 21.5793s
	iters: 1000, epoch: 6 | loss: 0.2615871
	speed: 0.0039s/iter; time left: 21.2087s
	iters: 1100, epoch: 6 | loss: 0.0180788
	speed: 0.0043s/iter; time left: 23.0471s
	iters: 1200, epoch: 6 | loss: 0.1106325
	speed: 0.0036s/iter; time left: 18.8695s
Epoch: 6 cost time: 5.0s
Epoch: 6, Steps: 1291 | Train Loss: 0.0885615 Vali Loss: 7.6129341 Test Loss: 10.7441063
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0633120
	speed: 0.0169s/iter; time left: 85.3821s
	iters: 200, epoch: 7 | loss: 0.0508453
	speed: 0.0037s/iter; time left: 18.2116s
	iters: 300, epoch: 7 | loss: 0.0697489
	speed: 0.0038s/iter; time left: 18.6411s
	iters: 400, epoch: 7 | loss: 0.1732437
	speed: 0.0037s/iter; time left: 17.4091s
	iters: 500, epoch: 7 | loss: 0.0294712
	speed: 0.0038s/iter; time left: 17.8982s
	iters: 600, epoch: 7 | loss: 0.0219324
	speed: 0.0039s/iter; time left: 17.6438s
	iters: 700, epoch: 7 | loss: 0.0635993
	speed: 0.0039s/iter; time left: 17.5362s
	iters: 800, epoch: 7 | loss: 0.1460652
	speed: 0.0037s/iter; time left: 16.2391s
	iters: 900, epoch: 7 | loss: 0.0777105
	speed: 0.0039s/iter; time left: 16.8175s
	iters: 1000, epoch: 7 | loss: 0.1135395
	speed: 0.0036s/iter; time left: 14.9657s
	iters: 1100, epoch: 7 | loss: 0.0747308
	speed: 0.0039s/iter; time left: 15.9091s
	iters: 1200, epoch: 7 | loss: 0.0400011
	speed: 0.0038s/iter; time left: 14.8938s
Epoch: 7 cost time: 4.9s
Epoch: 7, Steps: 1291 | Train Loss: 0.0881771 Vali Loss: 7.7305212 Test Loss: 11.1043663
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1184203
	speed: 0.0165s/iter; time left: 62.4388s
	iters: 200, epoch: 8 | loss: 0.1618941
	speed: 0.0041s/iter; time left: 14.9561s
	iters: 300, epoch: 8 | loss: 0.0448686
	speed: 0.0038s/iter; time left: 13.5694s
	iters: 400, epoch: 8 | loss: 0.0463684
	speed: 0.0036s/iter; time left: 12.4776s
	iters: 500, epoch: 8 | loss: 0.0348881
	speed: 0.0036s/iter; time left: 11.9920s
	iters: 600, epoch: 8 | loss: 0.1090493
	speed: 0.0045s/iter; time left: 14.6590s
	iters: 700, epoch: 8 | loss: 0.1199677
	speed: 0.0039s/iter; time left: 12.4747s
	iters: 800, epoch: 8 | loss: 0.1884449
	speed: 0.0037s/iter; time left: 11.4081s
	iters: 900, epoch: 8 | loss: 0.0488457
	speed: 0.0036s/iter; time left: 10.8485s
	iters: 1000, epoch: 8 | loss: 0.0851332
	speed: 0.0036s/iter; time left: 10.4186s
	iters: 1100, epoch: 8 | loss: 0.0807576
	speed: 0.0036s/iter; time left: 10.0389s
	iters: 1200, epoch: 8 | loss: 0.0499813
	speed: 0.0041s/iter; time left: 10.9035s
Epoch: 8 cost time: 5.1s
Epoch: 8, Steps: 1291 | Train Loss: 0.0880531 Vali Loss: 7.5661983 Test Loss: 10.6747551
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : MRO_336_336_MS_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2809

Final Metrics:

FITS_DLinear MSE: 10.473580  MAE: 2.466445   SE: 23.334311  RRMSE: 0.396592   RMAE: 0.302251   (numpy)
FITS_DLinear MSE: 10.473582  MAE: 2.466446   SE: 23.334311  RRMSE: 0.396592   RMAE: 0.302251   (torch)

Repeat       MSE: 10.261215  MAE: 2.420922   SE: 21.428272  RRMSE: 0.392551   RMAE: 0.296672   (numpy)
Repeat       MSE: 10.261217  MAE: 2.420922   SE: 21.428272  RRMSE: 0.392551   RMAE: 0.296672   (torch)

Shapes: pred (2808, 336, 1), true (2808, 336, 1), naive_pred (2808, 336, 1), gt (2808, 672, 1), metrics {'FITS_DLinear': {'mse': 10.47358, 'mae': 2.4664452, 'se': 23.33431, 'relative_rmse': 0.39659202, 'relative_mae': 0.3022511, 'mse_torch': 10.47358226776123, 'mae_torch': 2.4664456844329834, 'se_torch': 23.33431053161621, 'relative_rmse_torch': 0.39659206736503794, 'relative_mae_torch': 0.30225114516261925}, 'Repeat': {'mse': 10.261215, 'mae': 2.4209218, 'se': 21.428272, 'relative_rmse': 0.39255074, 'relative_mae': 0.2966724, 'mse_torch': 10.26121711730957, 'mae_torch': 2.420921564102173, 'se_torch': 21.428272247314453, 'relative_rmse_torch': 0.3925507735448641, 'relative_mae_torch': 0.2966723815233658}}
