Args in experiment:
Namespace(is_training=1, model_id='GD_336_96_S_channels_6', model='FITS100', data='custom', root_path='./dataset/', data_path='GD.csv', features='S', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
GD_336_96_S_channels_6
Use CPU
FITS cutoff frequency: 100

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=100, out_features=128, bias=True)
  )
)

>>>>>>>start training : GD_336_96_S_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10575
val 1479
test 3049
	iters: 100, epoch: 1 | loss: 0.0452295
	speed: 0.0040s/iter; time left: 51.8207s
	iters: 200, epoch: 1 | loss: 0.0529929
	speed: 0.0010s/iter; time left: 13.6397s
	iters: 300, epoch: 1 | loss: 0.0044536
	speed: 0.0008s/iter; time left: 10.0815s
	iters: 400, epoch: 1 | loss: 0.0798873
	speed: 0.0011s/iter; time left: 14.3964s
	iters: 500, epoch: 1 | loss: 0.0103205
	speed: 0.0008s/iter; time left: 10.1427s
	iters: 600, epoch: 1 | loss: 0.0534544
	speed: 0.0007s/iter; time left: 9.1875s
	iters: 700, epoch: 1 | loss: 0.0007641
	speed: 0.0007s/iter; time left: 9.3455s
	iters: 800, epoch: 1 | loss: 0.0009136
	speed: 0.0007s/iter; time left: 9.1402s
	iters: 900, epoch: 1 | loss: 0.0307348
	speed: 0.0007s/iter; time left: 9.0492s
	iters: 1000, epoch: 1 | loss: 0.0003479
	speed: 0.0008s/iter; time left: 9.3290s
	iters: 1100, epoch: 1 | loss: 0.0309360
	speed: 0.0008s/iter; time left: 9.1644s
	iters: 1200, epoch: 1 | loss: 0.0018800
	speed: 0.0012s/iter; time left: 14.3607s
	iters: 1300, epoch: 1 | loss: 0.0389520
	speed: 0.0008s/iter; time left: 9.1715s
Epoch: 1 cost time: 1.1s
Epoch: 1, Steps: 1321 | Train Loss: 0.0236555 Vali Loss: 0.5257629 Test Loss: 2.6278167
Validation loss decreased (inf --> 0.525763).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0313479
	speed: 0.0028s/iter; time left: 33.4729s
	iters: 200, epoch: 2 | loss: 0.0009399
	speed: 0.0008s/iter; time left: 8.8680s
	iters: 300, epoch: 2 | loss: 0.0045771
	speed: 0.0008s/iter; time left: 8.9122s
	iters: 400, epoch: 2 | loss: 0.0160415
	speed: 0.0009s/iter; time left: 9.8235s
	iters: 500, epoch: 2 | loss: 0.0146910
	speed: 0.0008s/iter; time left: 8.6059s
	iters: 600, epoch: 2 | loss: 0.0207045
	speed: 0.0007s/iter; time left: 8.4674s
	iters: 700, epoch: 2 | loss: 0.0009994
	speed: 0.0007s/iter; time left: 8.2550s
	iters: 800, epoch: 2 | loss: 0.0085467
	speed: 0.0008s/iter; time left: 9.0546s
	iters: 900, epoch: 2 | loss: 0.0165457
	speed: 0.0008s/iter; time left: 8.5268s
	iters: 1000, epoch: 2 | loss: 0.0139604
	speed: 0.0008s/iter; time left: 8.8825s
	iters: 1100, epoch: 2 | loss: 0.0270734
	speed: 0.0007s/iter; time left: 7.7568s
	iters: 1200, epoch: 2 | loss: 0.0211763
	speed: 0.0010s/iter; time left: 10.6021s
	iters: 1300, epoch: 2 | loss: 0.1591932
	speed: 0.0007s/iter; time left: 7.8765s
Epoch: 2 cost time: 1.0s
Epoch: 2, Steps: 1321 | Train Loss: 0.0171032 Vali Loss: 0.5037082 Test Loss: 2.4792259
Validation loss decreased (0.525763 --> 0.503708).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0278201
	speed: 0.0028s/iter; time left: 29.1770s
	iters: 200, epoch: 3 | loss: 0.0119413
	speed: 0.0007s/iter; time left: 7.7553s
	iters: 300, epoch: 3 | loss: 0.0174928
	speed: 0.0007s/iter; time left: 7.5431s
	iters: 400, epoch: 3 | loss: 0.0088469
	speed: 0.0008s/iter; time left: 7.8106s
	iters: 500, epoch: 3 | loss: 0.0184418
	speed: 0.0007s/iter; time left: 7.1255s
	iters: 600, epoch: 3 | loss: 0.0226125
	speed: 0.0009s/iter; time left: 9.1164s
	iters: 700, epoch: 3 | loss: 0.0508948
	speed: 0.0007s/iter; time left: 7.3593s
	iters: 800, epoch: 3 | loss: 0.0005031
	speed: 0.0008s/iter; time left: 7.5438s
	iters: 900, epoch: 3 | loss: 0.0233832
	speed: 0.0007s/iter; time left: 7.2312s
	iters: 1000, epoch: 3 | loss: 0.0009113
	speed: 0.0008s/iter; time left: 7.5257s
	iters: 1100, epoch: 3 | loss: 0.0030931
	speed: 0.0007s/iter; time left: 6.6611s
	iters: 1200, epoch: 3 | loss: 0.0131766
	speed: 0.0008s/iter; time left: 7.2077s
	iters: 1300, epoch: 3 | loss: 0.0082817
	speed: 0.0008s/iter; time left: 7.3253s
Epoch: 3 cost time: 1.0s
Epoch: 3, Steps: 1321 | Train Loss: 0.0159933 Vali Loss: 0.4921156 Test Loss: 2.4594281
Validation loss decreased (0.503708 --> 0.492116).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0433338
	speed: 0.0028s/iter; time left: 25.5097s
	iters: 200, epoch: 4 | loss: 0.0030329
	speed: 0.0008s/iter; time left: 6.9322s
	iters: 300, epoch: 4 | loss: 0.0009705
	speed: 0.0008s/iter; time left: 7.3305s
	iters: 400, epoch: 4 | loss: 0.0078999
	speed: 0.0008s/iter; time left: 6.8117s
	iters: 500, epoch: 4 | loss: 0.0005875
	speed: 0.0008s/iter; time left: 6.6847s
	iters: 600, epoch: 4 | loss: 0.1043225
	speed: 0.0008s/iter; time left: 7.1361s
	iters: 700, epoch: 4 | loss: 0.0043706
	speed: 0.0010s/iter; time left: 8.2228s
	iters: 800, epoch: 4 | loss: 0.0016059
	speed: 0.0008s/iter; time left: 6.4354s
	iters: 900, epoch: 4 | loss: 0.0248480
	speed: 0.0010s/iter; time left: 7.9780s
	iters: 1000, epoch: 4 | loss: 0.0150577
	speed: 0.0007s/iter; time left: 6.0929s
	iters: 1100, epoch: 4 | loss: 0.0343258
	speed: 0.0008s/iter; time left: 6.5626s
	iters: 1200, epoch: 4 | loss: 0.0017002
	speed: 0.0008s/iter; time left: 6.6521s
	iters: 1300, epoch: 4 | loss: 0.0195248
	speed: 0.0007s/iter; time left: 5.6987s
Epoch: 4 cost time: 1.1s
Epoch: 4, Steps: 1321 | Train Loss: 0.0156498 Vali Loss: 0.4991109 Test Loss: 2.4050422
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0173704
	speed: 0.0028s/iter; time left: 21.9731s
	iters: 200, epoch: 5 | loss: 0.0034827
	speed: 0.0008s/iter; time left: 6.0118s
	iters: 300, epoch: 5 | loss: 0.0398499
	speed: 0.0008s/iter; time left: 5.9144s
	iters: 400, epoch: 5 | loss: 0.0103674
	speed: 0.0008s/iter; time left: 5.7138s
	iters: 500, epoch: 5 | loss: 0.0076987
	speed: 0.0018s/iter; time left: 13.2756s
	iters: 600, epoch: 5 | loss: 0.0195837
	speed: 0.0013s/iter; time left: 9.7234s
	iters: 700, epoch: 5 | loss: 0.0070959
	speed: 0.0008s/iter; time left: 5.5336s
	iters: 800, epoch: 5 | loss: 0.0188428
	speed: 0.0007s/iter; time left: 5.2963s
	iters: 900, epoch: 5 | loss: 0.0320435
	speed: 0.0007s/iter; time left: 5.1607s
	iters: 1000, epoch: 5 | loss: 0.0147840
	speed: 0.0007s/iter; time left: 5.1706s
	iters: 1100, epoch: 5 | loss: 0.0013695
	speed: 0.0008s/iter; time left: 5.3963s
	iters: 1200, epoch: 5 | loss: 0.0175919
	speed: 0.0010s/iter; time left: 6.6088s
	iters: 1300, epoch: 5 | loss: 0.0233609
	speed: 0.0008s/iter; time left: 5.1035s
Epoch: 5 cost time: 1.2s
Epoch: 5, Steps: 1321 | Train Loss: 0.0154785 Vali Loss: 0.4959881 Test Loss: 2.3986692
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0250004
	speed: 0.0030s/iter; time left: 19.5304s
	iters: 200, epoch: 6 | loss: 0.0148238
	speed: 0.0008s/iter; time left: 5.3108s
	iters: 300, epoch: 6 | loss: 0.0025333
	speed: 0.0007s/iter; time left: 4.6394s
	iters: 400, epoch: 6 | loss: 0.0129287
	speed: 0.0008s/iter; time left: 4.8769s
	iters: 500, epoch: 6 | loss: 0.0253752
	speed: 0.0008s/iter; time left: 4.5997s
	iters: 600, epoch: 6 | loss: 0.0815898
	speed: 0.0007s/iter; time left: 4.3837s
	iters: 700, epoch: 6 | loss: 0.0030245
	speed: 0.0008s/iter; time left: 4.4756s
	iters: 800, epoch: 6 | loss: 0.0210994
	speed: 0.0008s/iter; time left: 4.6298s
	iters: 900, epoch: 6 | loss: 0.0261112
	speed: 0.0008s/iter; time left: 4.2887s
	iters: 1000, epoch: 6 | loss: 0.0115235
	speed: 0.0007s/iter; time left: 4.0863s
	iters: 1100, epoch: 6 | loss: 0.0139148
	speed: 0.0007s/iter; time left: 4.0095s
	iters: 1200, epoch: 6 | loss: 0.0110867
	speed: 0.0007s/iter; time left: 3.9435s
	iters: 1300, epoch: 6 | loss: 0.0011501
	speed: 0.0007s/iter; time left: 3.8539s
Epoch: 6 cost time: 1.0s
Epoch: 6, Steps: 1321 | Train Loss: 0.0154086 Vali Loss: 0.4965135 Test Loss: 2.3957505
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : GD_336_96_S_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3049

Final Metrics:

FITS100      MSE: 2.459429   MAE: 1.152921   SE: 4.802197   RRMSE: 0.101651   RMAE: 0.074730   (numpy)
FITS100      MSE: 2.459428   MAE: 1.152921   SE: 4.802198   RRMSE: 0.101651   RMAE: 0.074730   (torch)

Repeat       MSE: 2.179713   MAE: 1.044575   SE: 4.422679   RRMSE: 0.095697   RMAE: 0.067707   (numpy)
Repeat       MSE: 2.179713   MAE: 1.044575   SE: 4.422679   RRMSE: 0.095697   RMAE: 0.067707   (torch)

Shapes: pred (3048, 96, 1), true (3048, 96, 1), naive_pred (3048, 96, 1), gt (3048, 432, 1), metrics {'FITS100': {'mse': 2.4594285, 'mae': 1.1529212, 'se': 4.8021975, 'relative_rmse': 0.10165149, 'relative_mae': 0.07473022, 'mse_torch': 2.459428310394287, 'mae_torch': 1.1529213190078735, 'se_torch': 4.8021979331970215, 'relative_rmse_torch': 0.10165148394629155, 'relative_mae_torch': 0.07473022829603918}, 'Repeat': {'mse': 2.179713, 'mae': 1.0445752, 'se': 4.4226794, 'relative_rmse': 0.09569655, 'relative_mae': 0.067707434, 'mse_torch': 2.179713249206543, 'mae_torch': 1.0445752143859863, 'se_torch': 4.4226789474487305, 'relative_rmse_torch': 0.09569655880903553, 'relative_mae_torch': 0.06770743411234963}}
