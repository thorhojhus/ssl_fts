Args in experiment:
Namespace(is_training=1, model_id='GD_336_336_MS_channels_6', model='FITS100', data='custom', root_path='./dataset/', data_path='GD.csv', features='MS', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
GD_336_336_MS_channels_6
Use CPU
FITS cutoff frequency: 100

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=100, out_features=200, bias=True)
  )
)

>>>>>>>start training : GD_336_336_MS_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10335
val 1239
test 2809
	iters: 100, epoch: 1 | loss: 0.0227217
	speed: 0.0060s/iter; time left: 77.2430s
	iters: 200, epoch: 1 | loss: 0.0104100
	speed: 0.0033s/iter; time left: 41.6669s
	iters: 300, epoch: 1 | loss: 0.0193136
	speed: 0.0047s/iter; time left: 59.6798s
	iters: 400, epoch: 1 | loss: 0.0249818
	speed: 0.0051s/iter; time left: 63.8655s
	iters: 500, epoch: 1 | loss: 0.1203526
	speed: 0.0031s/iter; time left: 38.9039s
	iters: 600, epoch: 1 | loss: 0.0544780
	speed: 0.0024s/iter; time left: 29.6129s
	iters: 700, epoch: 1 | loss: 0.0430245
	speed: 0.0022s/iter; time left: 27.4264s
	iters: 800, epoch: 1 | loss: 0.1212643
	speed: 0.0024s/iter; time left: 28.6067s
	iters: 900, epoch: 1 | loss: 0.0015839
	speed: 0.0023s/iter; time left: 28.1568s
	iters: 1000, epoch: 1 | loss: 0.0232206
	speed: 0.0022s/iter; time left: 25.7241s
	iters: 1100, epoch: 1 | loss: 0.0086769
	speed: 0.0022s/iter; time left: 26.5726s
	iters: 1200, epoch: 1 | loss: 0.0979447
	speed: 0.0021s/iter; time left: 24.1205s
Epoch: 1 cost time: 3.7s
Epoch: 1, Steps: 1291 | Train Loss: 0.0663398 Vali Loss: 1.4687682 Test Loss: 9.4402514
Validation loss decreased (inf --> 1.468768).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0226337
	speed: 0.0103s/iter; time left: 119.2318s
	iters: 200, epoch: 2 | loss: 0.0093806
	speed: 0.0023s/iter; time left: 26.1326s
	iters: 300, epoch: 2 | loss: 0.0617610
	speed: 0.0020s/iter; time left: 22.9990s
	iters: 400, epoch: 2 | loss: 0.0758065
	speed: 0.0021s/iter; time left: 23.4334s
	iters: 500, epoch: 2 | loss: 0.0057254
	speed: 0.0025s/iter; time left: 28.3280s
	iters: 600, epoch: 2 | loss: 0.0500957
	speed: 0.0020s/iter; time left: 21.9173s
	iters: 700, epoch: 2 | loss: 0.0502986
	speed: 0.0020s/iter; time left: 21.7861s
	iters: 800, epoch: 2 | loss: 0.0040578
	speed: 0.0022s/iter; time left: 23.9321s
	iters: 900, epoch: 2 | loss: 0.1248991
	speed: 0.0022s/iter; time left: 23.4926s
	iters: 1000, epoch: 2 | loss: 0.0036865
	speed: 0.0019s/iter; time left: 20.6598s
	iters: 1100, epoch: 2 | loss: 0.0577993
	speed: 0.0022s/iter; time left: 22.8136s
	iters: 1200, epoch: 2 | loss: 0.0859280
	speed: 0.0021s/iter; time left: 22.0123s
Epoch: 2 cost time: 2.8s
Epoch: 2, Steps: 1291 | Train Loss: 0.0586943 Vali Loss: 1.4403893 Test Loss: 8.8319407
Validation loss decreased (1.468768 --> 1.440389).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0203409
	speed: 0.0089s/iter; time left: 90.5767s
	iters: 200, epoch: 3 | loss: 0.0384729
	speed: 0.0023s/iter; time left: 23.6103s
	iters: 300, epoch: 3 | loss: 0.0235475
	speed: 0.0022s/iter; time left: 21.8465s
	iters: 400, epoch: 3 | loss: 0.0010318
	speed: 0.0024s/iter; time left: 23.3388s
	iters: 500, epoch: 3 | loss: 0.1126861
	speed: 0.0021s/iter; time left: 20.8359s
	iters: 600, epoch: 3 | loss: 0.0388781
	speed: 0.0023s/iter; time left: 22.8134s
	iters: 700, epoch: 3 | loss: 0.0036688
	speed: 0.0024s/iter; time left: 23.3245s
	iters: 800, epoch: 3 | loss: 0.1200059
	speed: 0.0023s/iter; time left: 21.4769s
	iters: 900, epoch: 3 | loss: 0.0097749
	speed: 0.0020s/iter; time left: 18.6266s
	iters: 1000, epoch: 3 | loss: 0.0286003
	speed: 0.0024s/iter; time left: 22.0361s
	iters: 1100, epoch: 3 | loss: 0.0251733
	speed: 0.0023s/iter; time left: 20.8183s
	iters: 1200, epoch: 3 | loss: 0.0006250
	speed: 0.0022s/iter; time left: 20.1667s
Epoch: 3 cost time: 2.9s
Epoch: 3, Steps: 1291 | Train Loss: 0.0568990 Vali Loss: 1.4206964 Test Loss: 8.7404985
Validation loss decreased (1.440389 --> 1.420696).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0356416
	speed: 0.0113s/iter; time left: 101.2470s
	iters: 200, epoch: 4 | loss: 0.0010964
	speed: 0.0023s/iter; time left: 20.5765s
	iters: 300, epoch: 4 | loss: 0.0237058
	speed: 0.0021s/iter; time left: 18.4838s
	iters: 400, epoch: 4 | loss: 0.0980308
	speed: 0.0027s/iter; time left: 23.6831s
	iters: 500, epoch: 4 | loss: 0.0043794
	speed: 0.0028s/iter; time left: 24.0118s
	iters: 600, epoch: 4 | loss: 0.0086857
	speed: 0.0023s/iter; time left: 19.2526s
	iters: 700, epoch: 4 | loss: 0.0640165
	speed: 0.0023s/iter; time left: 19.2948s
	iters: 800, epoch: 4 | loss: 0.0341904
	speed: 0.0020s/iter; time left: 16.1394s
	iters: 900, epoch: 4 | loss: 0.0442049
	speed: 0.0021s/iter; time left: 16.8855s
	iters: 1000, epoch: 4 | loss: 0.0651322
	speed: 0.0021s/iter; time left: 16.4997s
	iters: 1100, epoch: 4 | loss: 0.0337687
	speed: 0.0024s/iter; time left: 18.8227s
	iters: 1200, epoch: 4 | loss: 0.0652144
	speed: 0.0025s/iter; time left: 19.8808s
Epoch: 4 cost time: 3.1s
Epoch: 4, Steps: 1291 | Train Loss: 0.0561565 Vali Loss: 1.4148943 Test Loss: 8.7204208
Validation loss decreased (1.420696 --> 1.414894).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0424660
	speed: 0.0108s/iter; time left: 82.4460s
	iters: 200, epoch: 5 | loss: 0.0804088
	speed: 0.0030s/iter; time left: 22.7641s
	iters: 300, epoch: 5 | loss: 0.0959212
	speed: 0.0022s/iter; time left: 16.6261s
	iters: 400, epoch: 5 | loss: 0.0221276
	speed: 0.0021s/iter; time left: 15.3956s
	iters: 500, epoch: 5 | loss: 0.0384966
	speed: 0.0021s/iter; time left: 15.0588s
	iters: 600, epoch: 5 | loss: 0.0208396
	speed: 0.0023s/iter; time left: 16.4494s
	iters: 700, epoch: 5 | loss: 0.0501634
	speed: 0.0020s/iter; time left: 13.8800s
	iters: 800, epoch: 5 | loss: 0.0054980
	speed: 0.0019s/iter; time left: 13.4561s
	iters: 900, epoch: 5 | loss: 0.0135092
	speed: 0.0022s/iter; time left: 14.9037s
	iters: 1000, epoch: 5 | loss: 0.0897516
	speed: 0.0026s/iter; time left: 17.6344s
	iters: 1100, epoch: 5 | loss: 0.0059969
	speed: 0.0020s/iter; time left: 13.0919s
	iters: 1200, epoch: 5 | loss: 0.1853544
	speed: 0.0040s/iter; time left: 26.2088s
Epoch: 5 cost time: 3.1s
Epoch: 5, Steps: 1291 | Train Loss: 0.0559373 Vali Loss: 1.4085264 Test Loss: 8.7313490
Validation loss decreased (1.414894 --> 1.408526).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0656672
	speed: 0.0094s/iter; time left: 59.4842s
	iters: 200, epoch: 6 | loss: 0.0078326
	speed: 0.0021s/iter; time left: 12.9223s
	iters: 300, epoch: 6 | loss: 0.0095542
	speed: 0.0022s/iter; time left: 13.5429s
	iters: 400, epoch: 6 | loss: 0.0797243
	speed: 0.0025s/iter; time left: 15.4248s
	iters: 500, epoch: 6 | loss: 0.0723027
	speed: 0.0026s/iter; time left: 15.5723s
	iters: 600, epoch: 6 | loss: 0.0489454
	speed: 0.0022s/iter; time left: 12.6337s
	iters: 700, epoch: 6 | loss: 0.0524568
	speed: 0.0020s/iter; time left: 11.4748s
	iters: 800, epoch: 6 | loss: 0.0058313
	speed: 0.0022s/iter; time left: 12.6785s
	iters: 900, epoch: 6 | loss: 0.0958939
	speed: 0.0024s/iter; time left: 13.0649s
	iters: 1000, epoch: 6 | loss: 0.0236821
	speed: 0.0022s/iter; time left: 12.2340s
	iters: 1100, epoch: 6 | loss: 0.0823280
	speed: 0.0021s/iter; time left: 11.0289s
	iters: 1200, epoch: 6 | loss: 0.0486517
	speed: 0.0022s/iter; time left: 11.3123s
Epoch: 6 cost time: 3.1s
Epoch: 6, Steps: 1291 | Train Loss: 0.0557028 Vali Loss: 1.4037273 Test Loss: 8.7090597
Validation loss decreased (1.408526 --> 1.403727).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0212676
	speed: 0.0146s/iter; time left: 74.0872s
	iters: 200, epoch: 7 | loss: 0.0039620
	speed: 0.0022s/iter; time left: 10.8047s
	iters: 300, epoch: 7 | loss: 0.0076028
	speed: 0.0020s/iter; time left: 9.9691s
	iters: 400, epoch: 7 | loss: 0.0117029
	speed: 0.0023s/iter; time left: 10.8541s
	iters: 500, epoch: 7 | loss: 0.0728509
	speed: 0.0025s/iter; time left: 11.4397s
	iters: 600, epoch: 7 | loss: 0.0048740
	speed: 0.0027s/iter; time left: 12.4820s
	iters: 700, epoch: 7 | loss: 0.0722139
	speed: 0.0023s/iter; time left: 10.1257s
	iters: 800, epoch: 7 | loss: 0.0076506
	speed: 0.0027s/iter; time left: 11.7943s
	iters: 900, epoch: 7 | loss: 0.0876552
	speed: 0.0034s/iter; time left: 14.4502s
	iters: 1000, epoch: 7 | loss: 0.1103208
	speed: 0.0023s/iter; time left: 9.5222s
	iters: 1100, epoch: 7 | loss: 0.0493148
	speed: 0.0023s/iter; time left: 9.3704s
	iters: 1200, epoch: 7 | loss: 0.0156005
	speed: 0.0025s/iter; time left: 9.9554s
Epoch: 7 cost time: 3.1s
Epoch: 7, Steps: 1291 | Train Loss: 0.0557173 Vali Loss: 1.4052492 Test Loss: 8.7063456
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0788651
	speed: 0.0091s/iter; time left: 34.4577s
	iters: 200, epoch: 8 | loss: 0.0016477
	speed: 0.0020s/iter; time left: 7.3455s
	iters: 300, epoch: 8 | loss: 0.0598774
	speed: 0.0024s/iter; time left: 8.7369s
	iters: 400, epoch: 8 | loss: 0.0443857
	speed: 0.0021s/iter; time left: 7.3388s
	iters: 500, epoch: 8 | loss: 0.0515608
	speed: 0.0019s/iter; time left: 6.5663s
	iters: 600, epoch: 8 | loss: 0.0503547
	speed: 0.0020s/iter; time left: 6.4100s
	iters: 700, epoch: 8 | loss: 0.0509441
	speed: 0.0021s/iter; time left: 6.7637s
	iters: 800, epoch: 8 | loss: 0.0208490
	speed: 0.0020s/iter; time left: 6.0380s
	iters: 900, epoch: 8 | loss: 0.0699998
	speed: 0.0023s/iter; time left: 6.7735s
	iters: 1000, epoch: 8 | loss: 0.0629959
	speed: 0.0019s/iter; time left: 5.4097s
	iters: 1100, epoch: 8 | loss: 0.0852496
	speed: 0.0020s/iter; time left: 5.4105s
	iters: 1200, epoch: 8 | loss: 0.0316247
	speed: 0.0020s/iter; time left: 5.3639s
Epoch: 8 cost time: 2.7s
Epoch: 8, Steps: 1291 | Train Loss: 0.0556829 Vali Loss: 1.4011499 Test Loss: 8.7041626
Validation loss decreased (1.403727 --> 1.401150).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0465311
	speed: 0.0097s/iter; time left: 24.0623s
	iters: 200, epoch: 9 | loss: 0.0345397
	speed: 0.0028s/iter; time left: 6.5966s
	iters: 300, epoch: 9 | loss: 0.0595272
	speed: 0.0022s/iter; time left: 5.0655s
	iters: 400, epoch: 9 | loss: 0.0188290
	speed: 0.0021s/iter; time left: 4.4999s
	iters: 500, epoch: 9 | loss: 0.0253817
	speed: 0.0025s/iter; time left: 5.1202s
	iters: 600, epoch: 9 | loss: 0.0036136
	speed: 0.0030s/iter; time left: 6.0017s
	iters: 700, epoch: 9 | loss: 0.0005737
	speed: 0.0025s/iter; time left: 4.6431s
	iters: 800, epoch: 9 | loss: 0.0587616
	speed: 0.0037s/iter; time left: 6.6487s
	iters: 900, epoch: 9 | loss: 0.1208099
	speed: 0.0023s/iter; time left: 3.8925s
	iters: 1000, epoch: 9 | loss: 0.1122100
	speed: 0.0023s/iter; time left: 3.5944s
	iters: 1100, epoch: 9 | loss: 0.0182346
	speed: 0.0018s/iter; time left: 2.6976s
	iters: 1200, epoch: 9 | loss: 0.0563077
	speed: 0.0018s/iter; time left: 2.4331s
Epoch: 9 cost time: 3.2s
Epoch: 9, Steps: 1291 | Train Loss: 0.0556137 Vali Loss: 1.4062028 Test Loss: 8.7030096
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0575302
	speed: 0.0100s/iter; time left: 11.8869s
	iters: 200, epoch: 10 | loss: 0.0125851
	speed: 0.0020s/iter; time left: 2.2382s
	iters: 300, epoch: 10 | loss: 0.0027665
	speed: 0.0019s/iter; time left: 1.9051s
	iters: 400, epoch: 10 | loss: 0.0684596
	speed: 0.0022s/iter; time left: 1.9753s
	iters: 500, epoch: 10 | loss: 0.0366623
	speed: 0.0020s/iter; time left: 1.6079s
	iters: 600, epoch: 10 | loss: 0.0056701
	speed: 0.0023s/iter; time left: 1.5682s
	iters: 700, epoch: 10 | loss: 0.0083727
	speed: 0.0113s/iter; time left: 6.6713s
	iters: 800, epoch: 10 | loss: 0.0061462
	speed: 0.0023s/iter; time left: 1.1159s
	iters: 900, epoch: 10 | loss: 0.0843492
	speed: 0.0036s/iter; time left: 1.4207s
	iters: 1000, epoch: 10 | loss: 0.0216434
	speed: 0.0021s/iter; time left: 0.6055s
	iters: 1100, epoch: 10 | loss: 0.0574614
	speed: 0.0029s/iter; time left: 0.5661s
	iters: 1200, epoch: 10 | loss: 0.0399020
	speed: 0.0027s/iter; time left: 0.2479s
Epoch: 10 cost time: 3.9s
Epoch: 10, Steps: 1291 | Train Loss: 0.0556465 Vali Loss: 1.4055120 Test Loss: 8.7022486
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
>>>>>>>testing : GD_336_336_MS_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2809

Final Metrics:

FITS100      MSE: 8.704164   MAE: 2.278315   SE: 17.655535  RRMSE: 0.191531   RMAE: 0.147907   (numpy)
FITS100      MSE: 8.704163   MAE: 2.278316   SE: 17.655535  RRMSE: 0.191531   RMAE: 0.147907   (torch)

Repeat       MSE: 7.578791   MAE: 2.093492   SE: 17.440411  RRMSE: 0.178721   RMAE: 0.135908   (numpy)
Repeat       MSE: 7.578791   MAE: 2.093491   SE: 17.440411  RRMSE: 0.178721   RMAE: 0.135908   (torch)

Shapes: pred (2808, 336, 1), true (2808, 336, 1), naive_pred (2808, 336, 1), gt (2808, 672, 1), metrics {'FITS100': {'mse': 8.704164, 'mae': 2.2783153, 'se': 17.655535, 'relative_rmse': 0.19153056, 'relative_mae': 0.14790688, 'mse_torch': 8.70416259765625, 'mae_torch': 2.278315782546997, 'se_torch': 17.655534744262695, 'relative_rmse_torch': 0.191530557561554, 'relative_mae_torch': 0.14790692017391815}, 'Repeat': {'mse': 7.5787907, 'mae': 2.0934916, 'se': 17.44041, 'relative_rmse': 0.17872058, 'relative_mae': 0.13590825, 'mse_torch': 7.578790664672852, 'mae_torch': 2.093491315841675, 'se_torch': 17.440410614013672, 'relative_rmse_torch': 0.1787205659566264, 'relative_mae_torch': 0.13590822453541873}}
