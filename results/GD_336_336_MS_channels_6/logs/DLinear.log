Args in experiment:
Namespace(is_training=1, model_id='GD_336_336_MS_channels_6', model='DLinear', data='custom', root_path='./dataset/', data_path='GD.csv', features='MS', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
GD_336_336_MS_channels_6
Use CPU

Model(
  (decompsition): series_decomp(
    (moving_avg): moving_avg(
      (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (Linear_Seasonal): Linear(in_features=336, out_features=336, bias=True)
  (Linear_Trend): Linear(in_features=336, out_features=336, bias=True)
  (Linear_Decoder): Linear(in_features=336, out_features=336, bias=True)
)

>>>>>>>start training : GD_336_336_MS_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10335
val 1239
test 2809
	iters: 100, epoch: 1 | loss: 0.0052822
	speed: 0.0060s/iter; time left: 76.6689s
	iters: 200, epoch: 1 | loss: 0.0146462
	speed: 0.0029s/iter; time left: 36.2432s
	iters: 300, epoch: 1 | loss: 0.0167286
	speed: 0.0030s/iter; time left: 38.2080s
	iters: 400, epoch: 1 | loss: 0.0486721
	speed: 0.0027s/iter; time left: 33.5099s
	iters: 500, epoch: 1 | loss: 0.0546882
	speed: 0.0026s/iter; time left: 32.0659s
	iters: 600, epoch: 1 | loss: 0.0163126
	speed: 0.0029s/iter; time left: 35.2016s
	iters: 700, epoch: 1 | loss: 0.0422334
	speed: 0.0030s/iter; time left: 36.1828s
	iters: 800, epoch: 1 | loss: 0.0084367
	speed: 0.0027s/iter; time left: 32.8122s
	iters: 900, epoch: 1 | loss: 0.0196963
	speed: 0.0030s/iter; time left: 35.6431s
	iters: 1000, epoch: 1 | loss: 0.0291104
	speed: 0.0030s/iter; time left: 35.9816s
	iters: 1100, epoch: 1 | loss: 0.0143553
	speed: 0.0028s/iter; time left: 32.4899s
	iters: 1200, epoch: 1 | loss: 0.0035605
	speed: 0.0032s/iter; time left: 37.9076s
Epoch: 1 cost time: 3.9s
Epoch: 1, Steps: 1291 | Train Loss: 0.0475163 Vali Loss: 2.0755572 Test Loss: 9.6241341
Validation loss decreased (inf --> 2.075557).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0160296
	speed: 0.0204s/iter; time left: 234.7831s
	iters: 200, epoch: 2 | loss: 0.0104817
	speed: 0.0029s/iter; time left: 33.6770s
	iters: 300, epoch: 2 | loss: 0.0204824
	speed: 0.0027s/iter; time left: 30.1097s
	iters: 400, epoch: 2 | loss: 0.1551865
	speed: 0.0028s/iter; time left: 31.7657s
	iters: 500, epoch: 2 | loss: 0.0155465
	speed: 0.0036s/iter; time left: 39.6700s
	iters: 600, epoch: 2 | loss: 0.1827371
	speed: 0.0040s/iter; time left: 44.6169s
	iters: 700, epoch: 2 | loss: 0.0204108
	speed: 0.0034s/iter; time left: 36.7126s
	iters: 800, epoch: 2 | loss: 0.0122000
	speed: 0.0033s/iter; time left: 35.3194s
	iters: 900, epoch: 2 | loss: 0.0797371
	speed: 0.0032s/iter; time left: 34.3412s
	iters: 1000, epoch: 2 | loss: 0.0159371
	speed: 0.0031s/iter; time left: 32.7445s
	iters: 1100, epoch: 2 | loss: 0.0920077
	speed: 0.0030s/iter; time left: 31.8379s
	iters: 1200, epoch: 2 | loss: 0.0238008
	speed: 0.0032s/iter; time left: 33.6087s
Epoch: 2 cost time: 4.1s
Epoch: 2, Steps: 1291 | Train Loss: 0.0419931 Vali Loss: 2.0213432 Test Loss: 9.0204782
Validation loss decreased (2.075557 --> 2.021343).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0345529
	speed: 0.0132s/iter; time left: 134.8229s
	iters: 200, epoch: 3 | loss: 0.0822279
	speed: 0.0042s/iter; time left: 42.1817s
	iters: 300, epoch: 3 | loss: 0.0628029
	speed: 0.0041s/iter; time left: 41.5615s
	iters: 400, epoch: 3 | loss: 0.0090389
	speed: 0.0031s/iter; time left: 31.0847s
	iters: 500, epoch: 3 | loss: 0.0263235
	speed: 0.0038s/iter; time left: 37.4275s
	iters: 600, epoch: 3 | loss: 0.0712095
	speed: 0.0044s/iter; time left: 42.9833s
	iters: 700, epoch: 3 | loss: 0.0071208
	speed: 0.0041s/iter; time left: 39.3120s
	iters: 800, epoch: 3 | loss: 0.0470680
	speed: 0.0029s/iter; time left: 27.7486s
	iters: 900, epoch: 3 | loss: 0.0108037
	speed: 0.0031s/iter; time left: 29.4363s
	iters: 1000, epoch: 3 | loss: 0.0353052
	speed: 0.0031s/iter; time left: 28.6670s
	iters: 1100, epoch: 3 | loss: 0.0510260
	speed: 0.0034s/iter; time left: 31.5762s
	iters: 1200, epoch: 3 | loss: 0.0032261
	speed: 0.0034s/iter; time left: 30.8417s
Epoch: 3 cost time: 4.6s
Epoch: 3, Steps: 1291 | Train Loss: 0.0382171 Vali Loss: 2.4063406 Test Loss: 10.5062618
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0348586
	speed: 0.0124s/iter; time left: 111.2291s
	iters: 200, epoch: 4 | loss: 0.0268809
	speed: 0.0029s/iter; time left: 25.4100s
	iters: 300, epoch: 4 | loss: 0.0235275
	speed: 0.0026s/iter; time left: 22.6018s
	iters: 400, epoch: 4 | loss: 0.0167667
	speed: 0.0027s/iter; time left: 23.2442s
	iters: 500, epoch: 4 | loss: 0.0163324
	speed: 0.0027s/iter; time left: 23.0083s
	iters: 600, epoch: 4 | loss: 0.0399420
	speed: 0.0026s/iter; time left: 21.8276s
	iters: 700, epoch: 4 | loss: 0.0956200
	speed: 0.0030s/iter; time left: 24.8701s
	iters: 800, epoch: 4 | loss: 0.0429533
	speed: 0.0026s/iter; time left: 21.2566s
	iters: 900, epoch: 4 | loss: 0.0428082
	speed: 0.0028s/iter; time left: 22.9967s
	iters: 1000, epoch: 4 | loss: 0.0078544
	speed: 0.0029s/iter; time left: 23.7086s
	iters: 1100, epoch: 4 | loss: 0.0152789
	speed: 0.0027s/iter; time left: 21.7422s
	iters: 1200, epoch: 4 | loss: 0.0048131
	speed: 0.0029s/iter; time left: 22.4209s
Epoch: 4 cost time: 3.7s
Epoch: 4, Steps: 1291 | Train Loss: 0.0355572 Vali Loss: 1.6104586 Test Loss: 7.9855623
Validation loss decreased (2.021343 --> 1.610459).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0430885
	speed: 0.0217s/iter; time left: 165.7227s
	iters: 200, epoch: 5 | loss: 0.0017051
	speed: 0.0028s/iter; time left: 21.3294s
	iters: 300, epoch: 5 | loss: 0.1932582
	speed: 0.0028s/iter; time left: 20.8847s
	iters: 400, epoch: 5 | loss: 0.0291560
	speed: 0.0027s/iter; time left: 19.8398s
	iters: 500, epoch: 5 | loss: 0.0305017
	speed: 0.0026s/iter; time left: 18.7168s
	iters: 600, epoch: 5 | loss: 0.0864907
	speed: 0.0026s/iter; time left: 18.5871s
	iters: 700, epoch: 5 | loss: 0.0066160
	speed: 0.0033s/iter; time left: 22.9445s
	iters: 800, epoch: 5 | loss: 0.0344248
	speed: 0.0028s/iter; time left: 19.3612s
	iters: 900, epoch: 5 | loss: 0.0961555
	speed: 0.0034s/iter; time left: 23.1150s
	iters: 1000, epoch: 5 | loss: 0.0844283
	speed: 0.0032s/iter; time left: 21.6092s
	iters: 1100, epoch: 5 | loss: 0.0049939
	speed: 0.0029s/iter; time left: 19.4564s
	iters: 1200, epoch: 5 | loss: 0.0055678
	speed: 0.0037s/iter; time left: 24.1628s
Epoch: 5 cost time: 3.8s
Epoch: 5, Steps: 1291 | Train Loss: 0.0345114 Vali Loss: 1.9603989 Test Loss: 8.6130381
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0223720
	speed: 0.0118s/iter; time left: 75.2873s
	iters: 200, epoch: 6 | loss: 0.0092208
	speed: 0.0033s/iter; time left: 20.6637s
	iters: 300, epoch: 6 | loss: 0.0506734
	speed: 0.0025s/iter; time left: 15.5900s
	iters: 400, epoch: 6 | loss: 0.0856806
	speed: 0.0027s/iter; time left: 16.0809s
	iters: 500, epoch: 6 | loss: 0.0214556
	speed: 0.0028s/iter; time left: 16.5514s
	iters: 600, epoch: 6 | loss: 0.0145573
	speed: 0.0027s/iter; time left: 15.9215s
	iters: 700, epoch: 6 | loss: 0.0624714
	speed: 0.0027s/iter; time left: 15.3869s
	iters: 800, epoch: 6 | loss: 0.0196052
	speed: 0.0027s/iter; time left: 15.0566s
	iters: 900, epoch: 6 | loss: 0.0039510
	speed: 0.0029s/iter; time left: 15.9987s
	iters: 1000, epoch: 6 | loss: 0.0275513
	speed: 0.0027s/iter; time left: 14.8732s
	iters: 1100, epoch: 6 | loss: 0.0217826
	speed: 0.0027s/iter; time left: 14.5567s
	iters: 1200, epoch: 6 | loss: 0.0168732
	speed: 0.0029s/iter; time left: 15.1146s
Epoch: 6 cost time: 3.6s
Epoch: 6, Steps: 1291 | Train Loss: 0.0338145 Vali Loss: 1.7500210 Test Loss: 8.1244659
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0480659
	speed: 0.0108s/iter; time left: 54.9214s
	iters: 200, epoch: 7 | loss: 0.0034453
	speed: 0.0028s/iter; time left: 14.0733s
	iters: 300, epoch: 7 | loss: 0.0008245
	speed: 0.0027s/iter; time left: 13.2910s
	iters: 400, epoch: 7 | loss: 0.0756393
	speed: 0.0030s/iter; time left: 14.4228s
	iters: 500, epoch: 7 | loss: 0.0791556
	speed: 0.0028s/iter; time left: 12.9897s
	iters: 600, epoch: 7 | loss: 0.0332905
	speed: 0.0035s/iter; time left: 15.8337s
	iters: 700, epoch: 7 | loss: 0.0153014
	speed: 0.0030s/iter; time left: 13.5153s
	iters: 800, epoch: 7 | loss: 0.0579447
	speed: 0.0032s/iter; time left: 14.1824s
	iters: 900, epoch: 7 | loss: 0.0620790
	speed: 0.0033s/iter; time left: 13.8978s
	iters: 1000, epoch: 7 | loss: 0.0504360
	speed: 0.0024s/iter; time left: 10.0275s
	iters: 1100, epoch: 7 | loss: 0.0110890
	speed: 0.0028s/iter; time left: 11.3023s
	iters: 1200, epoch: 7 | loss: 0.0205874
	speed: 0.0026s/iter; time left: 10.1372s
Epoch: 7 cost time: 3.7s
Epoch: 7, Steps: 1291 | Train Loss: 0.0337400 Vali Loss: 1.9601555 Test Loss: 8.5960169
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : GD_336_336_MS_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2809

Final Metrics:

DLinear      MSE: 7.985562   MAE: 2.159948   SE: 15.728895  RRMSE: 0.183454   RMAE: 0.140223   (numpy)
DLinear      MSE: 7.985562   MAE: 2.159948   SE: 15.728897  RRMSE: 0.183454   RMAE: 0.140223   (torch)

Repeat       MSE: 7.578791   MAE: 2.093492   SE: 17.440411  RRMSE: 0.178721   RMAE: 0.135908   (numpy)
Repeat       MSE: 7.578791   MAE: 2.093491   SE: 17.440411  RRMSE: 0.178721   RMAE: 0.135908   (torch)

Shapes: pred (2808, 336, 1), true (2808, 336, 1), naive_pred (2808, 336, 1), gt (2808, 672, 1), metrics {'DLinear': {'mse': 7.985562, 'mae': 2.1599483, 'se': 15.728895, 'relative_rmse': 0.18345405, 'relative_mae': 0.14022258, 'mse_torch': 7.985561847686768, 'mae_torch': 2.1599478721618652, 'se_torch': 15.728897094726562, 'relative_rmse_torch': 0.18345405434025372, 'relative_mae_torch': 0.1402225450725373}, 'Repeat': {'mse': 7.5787907, 'mae': 2.0934916, 'se': 17.44041, 'relative_rmse': 0.17872058, 'relative_mae': 0.13590825, 'mse_torch': 7.578790664672852, 'mae_torch': 2.093491315841675, 'se_torch': 17.440410614013672, 'relative_rmse_torch': 0.1787205659566264, 'relative_mae_torch': 0.13590822453541873}}
