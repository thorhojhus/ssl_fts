Args in experiment:
Namespace(is_training=1, model_id='MRO_336_96_S_channels_6', model='FITS_DLinear', data='custom', root_path='./dataset/', data_path='MRO.csv', features='S', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
MRO_336_96_S_channels_6
Use CPU

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=168, out_features=216, bias=True)
  )
  (dlinear): Model(
    (decompsition): series_decomp(
      (moving_avg): moving_avg(
        (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
      )
    )
    (Linear_Seasonal): Linear(in_features=336, out_features=96, bias=True)
    (Linear_Trend): Linear(in_features=336, out_features=96, bias=True)
    (Linear_Decoder): Linear(in_features=336, out_features=96, bias=True)
  )
)

>>>>>>>start training : MRO_336_96_S_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10575
val 1479
test 3049
	iters: 100, epoch: 1 | loss: 0.0266568
	speed: 0.0043s/iter; time left: 56.7699s
	iters: 200, epoch: 1 | loss: 0.0531861
	speed: 0.0009s/iter; time left: 11.2816s
	iters: 300, epoch: 1 | loss: 0.0409521
	speed: 0.0008s/iter; time left: 10.9295s
	iters: 400, epoch: 1 | loss: 0.0110055
	speed: 0.0009s/iter; time left: 11.5466s
	iters: 500, epoch: 1 | loss: 0.1515914
	speed: 0.0009s/iter; time left: 11.3404s
	iters: 600, epoch: 1 | loss: 0.1041211
	speed: 0.0009s/iter; time left: 10.9211s
	iters: 700, epoch: 1 | loss: 0.0215122
	speed: 0.0008s/iter; time left: 10.4746s
	iters: 800, epoch: 1 | loss: 0.0450111
	speed: 0.0010s/iter; time left: 12.5798s
	iters: 900, epoch: 1 | loss: 0.0584836
	speed: 0.0009s/iter; time left: 11.3597s
	iters: 1000, epoch: 1 | loss: 0.0434514
	speed: 0.0009s/iter; time left: 11.0154s
	iters: 1100, epoch: 1 | loss: 0.2471796
	speed: 0.0009s/iter; time left: 10.3418s
	iters: 1200, epoch: 1 | loss: 0.0293188
	speed: 0.0010s/iter; time left: 11.9806s
	iters: 1300, epoch: 1 | loss: 0.0363343
	speed: 0.0008s/iter; time left: 9.8386s
Epoch: 1 cost time: 1.2s
Epoch: 1, Steps: 1321 | Train Loss: 0.0459398 Vali Loss: 2.6978762 Test Loss: 3.4543226
Validation loss decreased (inf --> 2.697876).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0719102
	speed: 0.0042s/iter; time left: 49.2101s
	iters: 200, epoch: 2 | loss: 0.0257390
	speed: 0.0009s/iter; time left: 10.2389s
	iters: 300, epoch: 2 | loss: 0.0462444
	speed: 0.0008s/iter; time left: 9.4884s
	iters: 400, epoch: 2 | loss: 0.0235413
	speed: 0.0010s/iter; time left: 11.7352s
	iters: 500, epoch: 2 | loss: 0.0629790
	speed: 0.0008s/iter; time left: 9.3448s
	iters: 600, epoch: 2 | loss: 0.0650368
	speed: 0.0009s/iter; time left: 9.6673s
	iters: 700, epoch: 2 | loss: 0.0187566
	speed: 0.0008s/iter; time left: 9.2739s
	iters: 800, epoch: 2 | loss: 0.0299203
	speed: 0.0008s/iter; time left: 8.9894s
	iters: 900, epoch: 2 | loss: 0.0193506
	speed: 0.0008s/iter; time left: 8.8053s
	iters: 1000, epoch: 2 | loss: 0.0667164
	speed: 0.0008s/iter; time left: 8.9090s
	iters: 1100, epoch: 2 | loss: 0.0183256
	speed: 0.0008s/iter; time left: 8.6542s
	iters: 1200, epoch: 2 | loss: 0.0126893
	speed: 0.0008s/iter; time left: 8.9956s
	iters: 1300, epoch: 2 | loss: 0.0375603
	speed: 0.0008s/iter; time left: 8.5615s
Epoch: 2 cost time: 1.1s
Epoch: 2, Steps: 1321 | Train Loss: 0.0388281 Vali Loss: 3.6331017 Test Loss: 4.5784235
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0599032
	speed: 0.0045s/iter; time left: 47.1069s
	iters: 200, epoch: 3 | loss: 0.0606390
	speed: 0.0009s/iter; time left: 8.9598s
	iters: 300, epoch: 3 | loss: 0.0113489
	speed: 0.0009s/iter; time left: 9.2815s
	iters: 400, epoch: 3 | loss: 0.0207994
	speed: 0.0008s/iter; time left: 8.5477s
	iters: 500, epoch: 3 | loss: 0.0495443
	speed: 0.0008s/iter; time left: 8.5261s
	iters: 600, epoch: 3 | loss: 0.0132573
	speed: 0.0010s/iter; time left: 10.3855s
	iters: 700, epoch: 3 | loss: 0.0294246
	speed: 0.0008s/iter; time left: 8.2979s
	iters: 800, epoch: 3 | loss: 0.0237847
	speed: 0.0008s/iter; time left: 8.1773s
	iters: 900, epoch: 3 | loss: 0.0520032
	speed: 0.0008s/iter; time left: 7.9578s
	iters: 1000, epoch: 3 | loss: 0.1053927
	speed: 0.0008s/iter; time left: 8.0036s
	iters: 1100, epoch: 3 | loss: 0.1152984
	speed: 0.0008s/iter; time left: 7.9240s
	iters: 1200, epoch: 3 | loss: 0.0076876
	speed: 0.0009s/iter; time left: 8.2512s
	iters: 1300, epoch: 3 | loss: 0.0402646
	speed: 0.0008s/iter; time left: 7.6368s
Epoch: 3 cost time: 1.2s
Epoch: 3, Steps: 1321 | Train Loss: 0.0346377 Vali Loss: 2.4386663 Test Loss: 3.1385949
Validation loss decreased (2.697876 --> 2.438666).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0538404
	speed: 0.0043s/iter; time left: 38.9081s
	iters: 200, epoch: 4 | loss: 0.0382973
	speed: 0.0008s/iter; time left: 7.5083s
	iters: 300, epoch: 4 | loss: 0.0370057
	speed: 0.0008s/iter; time left: 7.4517s
	iters: 400, epoch: 4 | loss: 0.0190001
	speed: 0.0010s/iter; time left: 8.6039s
	iters: 500, epoch: 4 | loss: 0.0233367
	speed: 0.0009s/iter; time left: 7.6566s
	iters: 600, epoch: 4 | loss: 0.0193295
	speed: 0.0008s/iter; time left: 7.2671s
	iters: 700, epoch: 4 | loss: 0.0292247
	speed: 0.0008s/iter; time left: 7.0065s
	iters: 800, epoch: 4 | loss: 0.0571816
	speed: 0.0010s/iter; time left: 8.2365s
	iters: 900, epoch: 4 | loss: 0.0842242
	speed: 0.0008s/iter; time left: 6.8422s
	iters: 1000, epoch: 4 | loss: 0.0221328
	speed: 0.0008s/iter; time left: 6.9813s
	iters: 1100, epoch: 4 | loss: 0.0369757
	speed: 0.0008s/iter; time left: 6.8311s
	iters: 1200, epoch: 4 | loss: 0.0168337
	speed: 0.0009s/iter; time left: 7.0553s
	iters: 1300, epoch: 4 | loss: 0.0329713
	speed: 0.0008s/iter; time left: 6.6756s
Epoch: 4 cost time: 1.1s
Epoch: 4, Steps: 1321 | Train Loss: 0.0322856 Vali Loss: 2.4008832 Test Loss: 3.0604413
Validation loss decreased (2.438666 --> 2.400883).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0280553
	speed: 0.0043s/iter; time left: 33.3894s
	iters: 200, epoch: 5 | loss: 0.0255631
	speed: 0.0008s/iter; time left: 6.3589s
	iters: 300, epoch: 5 | loss: 0.0493184
	speed: 0.0008s/iter; time left: 6.4366s
	iters: 400, epoch: 5 | loss: 0.0211037
	speed: 0.0008s/iter; time left: 6.3675s
	iters: 500, epoch: 5 | loss: 0.0232467
	speed: 0.0009s/iter; time left: 6.5091s
	iters: 600, epoch: 5 | loss: 0.0176380
	speed: 0.0008s/iter; time left: 5.9590s
	iters: 700, epoch: 5 | loss: 0.0220132
	speed: 0.0008s/iter; time left: 6.0224s
	iters: 800, epoch: 5 | loss: 0.0053763
	speed: 0.0008s/iter; time left: 5.7680s
	iters: 900, epoch: 5 | loss: 0.0418574
	speed: 0.0008s/iter; time left: 5.7167s
	iters: 1000, epoch: 5 | loss: 0.0196743
	speed: 0.0008s/iter; time left: 5.6246s
	iters: 1100, epoch: 5 | loss: 0.0148061
	speed: 0.0009s/iter; time left: 5.9352s
	iters: 1200, epoch: 5 | loss: 0.0091606
	speed: 0.0009s/iter; time left: 5.8195s
	iters: 1300, epoch: 5 | loss: 0.0243820
	speed: 0.0008s/iter; time left: 5.4769s
Epoch: 5 cost time: 1.1s
Epoch: 5, Steps: 1321 | Train Loss: 0.0315698 Vali Loss: 2.4560421 Test Loss: 3.1626375
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0298684
	speed: 0.0044s/iter; time left: 28.3545s
	iters: 200, epoch: 6 | loss: 0.0465226
	speed: 0.0008s/iter; time left: 5.3261s
	iters: 300, epoch: 6 | loss: 0.0079309
	speed: 0.0008s/iter; time left: 5.1151s
	iters: 400, epoch: 6 | loss: 0.0530618
	speed: 0.0008s/iter; time left: 5.0318s
	iters: 500, epoch: 6 | loss: 0.0264980
	speed: 0.0009s/iter; time left: 5.2191s
	iters: 600, epoch: 6 | loss: 0.0047770
	speed: 0.0009s/iter; time left: 5.1397s
	iters: 700, epoch: 6 | loss: 0.0438686
	speed: 0.0008s/iter; time left: 4.8523s
	iters: 800, epoch: 6 | loss: 0.0854908
	speed: 0.0008s/iter; time left: 4.9252s
	iters: 900, epoch: 6 | loss: 0.0712299
	speed: 0.0008s/iter; time left: 4.7855s
	iters: 1000, epoch: 6 | loss: 0.0066404
	speed: 0.0008s/iter; time left: 4.6729s
	iters: 1100, epoch: 6 | loss: 0.0095303
	speed: 0.0008s/iter; time left: 4.5192s
	iters: 1200, epoch: 6 | loss: 0.0082563
	speed: 0.0008s/iter; time left: 4.5651s
	iters: 1300, epoch: 6 | loss: 0.0101138
	speed: 0.0008s/iter; time left: 4.4504s
Epoch: 6 cost time: 1.1s
Epoch: 6, Steps: 1321 | Train Loss: 0.0311742 Vali Loss: 2.5117972 Test Loss: 3.2694483
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0161793
	speed: 0.0046s/iter; time left: 23.9451s
	iters: 200, epoch: 7 | loss: 0.0411902
	speed: 0.0008s/iter; time left: 4.0863s
	iters: 300, epoch: 7 | loss: 0.0142858
	speed: 0.0008s/iter; time left: 4.1513s
	iters: 400, epoch: 7 | loss: 0.0437942
	speed: 0.0008s/iter; time left: 4.1430s
	iters: 500, epoch: 7 | loss: 0.0172405
	speed: 0.0010s/iter; time left: 4.7809s
	iters: 600, epoch: 7 | loss: 0.0129125
	speed: 0.0009s/iter; time left: 4.0623s
	iters: 700, epoch: 7 | loss: 0.0268772
	speed: 0.0008s/iter; time left: 3.7646s
	iters: 800, epoch: 7 | loss: 0.0339985
	speed: 0.0009s/iter; time left: 3.8405s
	iters: 900, epoch: 7 | loss: 0.0542054
	speed: 0.0009s/iter; time left: 3.8413s
	iters: 1000, epoch: 7 | loss: 0.0043011
	speed: 0.0008s/iter; time left: 3.6300s
	iters: 1100, epoch: 7 | loss: 0.0113334
	speed: 0.0009s/iter; time left: 3.5621s
	iters: 1200, epoch: 7 | loss: 0.0117395
	speed: 0.0009s/iter; time left: 3.5342s
	iters: 1300, epoch: 7 | loss: 0.0186819
	speed: 0.0008s/iter; time left: 3.2799s
Epoch: 7 cost time: 1.1s
Epoch: 7, Steps: 1321 | Train Loss: 0.0307669 Vali Loss: 2.3773336 Test Loss: 3.0243936
Validation loss decreased (2.400883 --> 2.377334).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0164358
	speed: 0.0043s/iter; time left: 16.5994s
	iters: 200, epoch: 8 | loss: 0.0331022
	speed: 0.0008s/iter; time left: 3.1476s
	iters: 300, epoch: 8 | loss: 0.0368316
	speed: 0.0008s/iter; time left: 2.9736s
	iters: 400, epoch: 8 | loss: 0.0073592
	speed: 0.0008s/iter; time left: 2.9473s
	iters: 500, epoch: 8 | loss: 0.0162550
	speed: 0.0008s/iter; time left: 2.9020s
	iters: 600, epoch: 8 | loss: 0.0058644
	speed: 0.0008s/iter; time left: 2.7278s
	iters: 700, epoch: 8 | loss: 0.1229825
	speed: 0.0008s/iter; time left: 2.6927s
	iters: 800, epoch: 8 | loss: 0.0317597
	speed: 0.0009s/iter; time left: 2.9764s
	iters: 900, epoch: 8 | loss: 0.0366730
	speed: 0.0008s/iter; time left: 2.5374s
	iters: 1000, epoch: 8 | loss: 0.0521378
	speed: 0.0008s/iter; time left: 2.4283s
	iters: 1100, epoch: 8 | loss: 0.0188282
	speed: 0.0008s/iter; time left: 2.3299s
	iters: 1200, epoch: 8 | loss: 0.0369581
	speed: 0.0010s/iter; time left: 2.7983s
	iters: 1300, epoch: 8 | loss: 0.0385736
	speed: 0.0008s/iter; time left: 2.2041s
Epoch: 8 cost time: 1.1s
Epoch: 8, Steps: 1321 | Train Loss: 0.0307122 Vali Loss: 2.4796488 Test Loss: 3.2084737
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0129611
	speed: 0.0042s/iter; time left: 10.7259s
	iters: 200, epoch: 9 | loss: 0.0270226
	speed: 0.0010s/iter; time left: 2.5633s
	iters: 300, epoch: 9 | loss: 0.0355921
	speed: 0.0008s/iter; time left: 1.9543s
	iters: 400, epoch: 9 | loss: 0.0308865
	speed: 0.0008s/iter; time left: 1.8836s
	iters: 500, epoch: 9 | loss: 0.0342381
	speed: 0.0008s/iter; time left: 1.7422s
	iters: 600, epoch: 9 | loss: 0.0363295
	speed: 0.0010s/iter; time left: 1.9467s
	iters: 700, epoch: 9 | loss: 0.0170147
	speed: 0.0009s/iter; time left: 1.6676s
	iters: 800, epoch: 9 | loss: 0.0321835
	speed: 0.0008s/iter; time left: 1.5454s
	iters: 900, epoch: 9 | loss: 0.0051978
	speed: 0.0008s/iter; time left: 1.3976s
	iters: 1000, epoch: 9 | loss: 0.0092770
	speed: 0.0008s/iter; time left: 1.3502s
	iters: 1100, epoch: 9 | loss: 0.0103224
	speed: 0.0009s/iter; time left: 1.4294s
	iters: 1200, epoch: 9 | loss: 0.0125272
	speed: 0.0008s/iter; time left: 1.1568s
	iters: 1300, epoch: 9 | loss: 0.0869808
	speed: 0.0008s/iter; time left: 1.0945s
Epoch: 9 cost time: 1.1s
Epoch: 9, Steps: 1321 | Train Loss: 0.0307258 Vali Loss: 2.4759150 Test Loss: 3.1921165
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0081142
	speed: 0.0050s/iter; time left: 6.1628s
	iters: 200, epoch: 10 | loss: 0.0323715
	speed: 0.0008s/iter; time left: 0.9361s
	iters: 300, epoch: 10 | loss: 0.0127891
	speed: 0.0008s/iter; time left: 0.8380s
	iters: 400, epoch: 10 | loss: 0.0413455
	speed: 0.0011s/iter; time left: 1.0063s
	iters: 500, epoch: 10 | loss: 0.0170554
	speed: 0.0008s/iter; time left: 0.6894s
	iters: 600, epoch: 10 | loss: 0.0781985
	speed: 0.0008s/iter; time left: 0.5982s
	iters: 700, epoch: 10 | loss: 0.0143645
	speed: 0.0008s/iter; time left: 0.5111s
	iters: 800, epoch: 10 | loss: 0.0174893
	speed: 0.0008s/iter; time left: 0.4387s
	iters: 900, epoch: 10 | loss: 0.0152195
	speed: 0.0008s/iter; time left: 0.3470s
	iters: 1000, epoch: 10 | loss: 0.0133017
	speed: 0.0008s/iter; time left: 0.2593s
	iters: 1100, epoch: 10 | loss: 0.0303977
	speed: 0.0008s/iter; time left: 0.1840s
	iters: 1200, epoch: 10 | loss: 0.0102103
	speed: 0.0009s/iter; time left: 0.1144s
	iters: 1300, epoch: 10 | loss: 0.0168508
	speed: 0.0008s/iter; time left: 0.0182s
Epoch: 10 cost time: 1.1s
Epoch: 10, Steps: 1321 | Train Loss: 0.0306920 Vali Loss: 2.4373314 Test Loss: 3.1261926
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : MRO_336_96_S_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3049

Final Metrics:

FITS_DLinear MSE: 3.024394   MAE: 1.308926   SE: 5.616569   RRMSE: 0.207089   RMAE: 0.155867   (numpy)
FITS_DLinear MSE: 3.024393   MAE: 1.308926   SE: 5.616569   RRMSE: 0.207089   RMAE: 0.155867   (torch)

Repeat       MSE: 2.870288   MAE: 1.261266   SE: 5.347196   RRMSE: 0.201744   RMAE: 0.150191   (numpy)
Repeat       MSE: 2.870288   MAE: 1.261266   SE: 5.347196   RRMSE: 0.201744   RMAE: 0.150191   (torch)

Shapes: pred (3048, 96, 1), true (3048, 96, 1), naive_pred (3048, 96, 1), gt (3048, 432, 1), metrics {'FITS_DLinear': {'mse': 3.0243936, 'mae': 1.3089256, 'se': 5.616569, 'relative_rmse': 0.20708936, 'relative_mae': 0.1558668, 'mse_torch': 3.024393320083618, 'mae_torch': 1.3089256286621094, 'se_torch': 5.6165690422058105, 'relative_rmse_torch': 0.20708935566538025, 'relative_mae_torch': 0.15586679774921708}, 'Repeat': {'mse': 2.8702881, 'mae': 1.261266, 'se': 5.3471956, 'relative_rmse': 0.20174436, 'relative_mae': 0.15019149, 'mse_torch': 2.870288133621216, 'mae_torch': 1.2612659931182861, 'se_torch': 5.347195625305176, 'relative_rmse_torch': 0.20174435404524144, 'relative_mae_torch': 0.15019149075587518}}
