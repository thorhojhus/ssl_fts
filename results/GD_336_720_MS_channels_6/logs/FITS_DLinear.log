Args in experiment:
Namespace(is_training=1, model_id='GD_336_720_MS_channels_6', model='FITS_DLinear', data='custom', root_path='./dataset/', data_path='GD.csv', features='MS', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
GD_336_720_MS_channels_6
Use CPU

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=168, out_features=528, bias=True)
  )
  (dlinear): Model(
    (decompsition): series_decomp(
      (moving_avg): moving_avg(
        (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
      )
    )
    (Linear_Seasonal): Linear(in_features=336, out_features=720, bias=True)
    (Linear_Trend): Linear(in_features=336, out_features=720, bias=True)
    (Linear_Decoder): Linear(in_features=336, out_features=720, bias=True)
  )
)

>>>>>>>start training : GD_336_720_MS_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 9951
val 855
test 2425
	iters: 100, epoch: 1 | loss: 0.0563806
	speed: 0.0104s/iter; time left: 128.3486s
	iters: 200, epoch: 1 | loss: 0.0710045
	speed: 0.0059s/iter; time left: 71.6095s
	iters: 300, epoch: 1 | loss: 0.0549347
	speed: 0.0062s/iter; time left: 75.0550s
	iters: 400, epoch: 1 | loss: 0.0392629
	speed: 0.0081s/iter; time left: 96.9731s
	iters: 500, epoch: 1 | loss: 0.0374348
	speed: 0.0068s/iter; time left: 80.7264s
	iters: 600, epoch: 1 | loss: 0.0317209
	speed: 0.0058s/iter; time left: 68.1809s
	iters: 700, epoch: 1 | loss: 0.0600753
	speed: 0.0069s/iter; time left: 80.9983s
	iters: 800, epoch: 1 | loss: 0.0537251
	speed: 0.0065s/iter; time left: 75.3530s
	iters: 900, epoch: 1 | loss: 0.0147824
	speed: 0.0061s/iter; time left: 70.0299s
	iters: 1000, epoch: 1 | loss: 0.0980487
	speed: 0.0062s/iter; time left: 71.0230s
	iters: 1100, epoch: 1 | loss: 0.0395423
	speed: 0.0053s/iter; time left: 59.5377s
	iters: 1200, epoch: 1 | loss: 0.0382824
	speed: 0.0074s/iter; time left: 82.8004s
Epoch: 1 cost time: 8.0s
Epoch: 1, Steps: 1243 | Train Loss: 0.0536383 Vali Loss: 4.6629896 Test Loss: 19.2650623
Validation loss decreased (inf --> 4.662990).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0056059
	speed: 0.0204s/iter; time left: 225.8594s
	iters: 200, epoch: 2 | loss: 0.0155264
	speed: 0.0076s/iter; time left: 83.3339s
	iters: 300, epoch: 2 | loss: 0.0920477
	speed: 0.0063s/iter; time left: 68.2981s
	iters: 400, epoch: 2 | loss: 0.0793012
	speed: 0.0061s/iter; time left: 65.6914s
	iters: 500, epoch: 2 | loss: 0.0391040
	speed: 0.0075s/iter; time left: 79.9852s
	iters: 600, epoch: 2 | loss: 0.0452257
	speed: 0.0073s/iter; time left: 77.2136s
	iters: 700, epoch: 2 | loss: 0.0362505
	speed: 0.0056s/iter; time left: 59.2351s
	iters: 800, epoch: 2 | loss: 0.0196512
	speed: 0.0056s/iter; time left: 57.8175s
	iters: 900, epoch: 2 | loss: 0.0246343
	speed: 0.0057s/iter; time left: 58.5111s
	iters: 1000, epoch: 2 | loss: 0.0228526
	speed: 0.0076s/iter; time left: 77.0084s
	iters: 1100, epoch: 2 | loss: 0.0218002
	speed: 0.0072s/iter; time left: 73.1113s
	iters: 1200, epoch: 2 | loss: 0.0236395
	speed: 0.0059s/iter; time left: 59.2496s
Epoch: 2 cost time: 8.0s
Epoch: 2, Steps: 1243 | Train Loss: 0.0466052 Vali Loss: 3.6245773 Test Loss: 17.7255116
Validation loss decreased (4.662990 --> 3.624577).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0796932
	speed: 0.0211s/iter; time left: 207.3104s
	iters: 200, epoch: 3 | loss: 0.0209783
	speed: 0.0061s/iter; time left: 59.0351s
	iters: 300, epoch: 3 | loss: 0.0133857
	speed: 0.0078s/iter; time left: 74.9475s
	iters: 400, epoch: 3 | loss: 0.0493796
	speed: 0.0064s/iter; time left: 61.4588s
	iters: 500, epoch: 3 | loss: 0.0077298
	speed: 0.0080s/iter; time left: 75.1498s
	iters: 600, epoch: 3 | loss: 0.0450501
	speed: 0.0061s/iter; time left: 57.1847s
	iters: 700, epoch: 3 | loss: 0.0184218
	speed: 0.0058s/iter; time left: 53.1883s
	iters: 800, epoch: 3 | loss: 0.0260662
	speed: 0.0067s/iter; time left: 61.5920s
	iters: 900, epoch: 3 | loss: 0.0132870
	speed: 0.0057s/iter; time left: 51.3699s
	iters: 1000, epoch: 3 | loss: 0.0327222
	speed: 0.0069s/iter; time left: 61.4418s
	iters: 1100, epoch: 3 | loss: 0.0313963
	speed: 0.0078s/iter; time left: 68.8487s
	iters: 1200, epoch: 3 | loss: 0.1136026
	speed: 0.0112s/iter; time left: 98.0878s
Epoch: 3 cost time: 9.0s
Epoch: 3, Steps: 1243 | Train Loss: 0.0411604 Vali Loss: 4.7486444 Test Loss: 19.4337254
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0317251
	speed: 0.0232s/iter; time left: 199.6266s
	iters: 200, epoch: 4 | loss: 0.0411811
	speed: 0.0057s/iter; time left: 48.2330s
	iters: 300, epoch: 4 | loss: 0.0039147
	speed: 0.0073s/iter; time left: 61.1916s
	iters: 400, epoch: 4 | loss: 0.0083685
	speed: 0.0062s/iter; time left: 51.4006s
	iters: 500, epoch: 4 | loss: 0.0535158
	speed: 0.0069s/iter; time left: 56.2889s
	iters: 600, epoch: 4 | loss: 0.0368963
	speed: 0.0055s/iter; time left: 44.4379s
	iters: 700, epoch: 4 | loss: 0.0109464
	speed: 0.0051s/iter; time left: 41.1527s
	iters: 800, epoch: 4 | loss: 0.0238052
	speed: 0.0053s/iter; time left: 41.5325s
	iters: 900, epoch: 4 | loss: 0.0080558
	speed: 0.0050s/iter; time left: 38.7542s
	iters: 1000, epoch: 4 | loss: 0.0558311
	speed: 0.0063s/iter; time left: 48.6570s
	iters: 1100, epoch: 4 | loss: 0.0127477
	speed: 0.0059s/iter; time left: 45.2270s
	iters: 1200, epoch: 4 | loss: 0.0121370
	speed: 0.0075s/iter; time left: 56.3141s
Epoch: 4 cost time: 7.4s
Epoch: 4, Steps: 1243 | Train Loss: 0.0394194 Vali Loss: 4.3873191 Test Loss: 18.1018982
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0142017
	speed: 0.0222s/iter; time left: 163.4431s
	iters: 200, epoch: 5 | loss: 0.0064655
	speed: 0.0076s/iter; time left: 54.9706s
	iters: 300, epoch: 5 | loss: 0.0432637
	speed: 0.0056s/iter; time left: 39.9036s
	iters: 400, epoch: 5 | loss: 0.0351472
	speed: 0.0051s/iter; time left: 36.1282s
	iters: 500, epoch: 5 | loss: 0.0222550
	speed: 0.0062s/iter; time left: 42.9224s
	iters: 600, epoch: 5 | loss: 0.0085674
	speed: 0.0063s/iter; time left: 43.4506s
	iters: 700, epoch: 5 | loss: 0.0043869
	speed: 0.0053s/iter; time left: 35.6478s
	iters: 800, epoch: 5 | loss: 0.0239254
	speed: 0.0060s/iter; time left: 40.2455s
	iters: 900, epoch: 5 | loss: 0.0457663
	speed: 0.0070s/iter; time left: 46.2108s
	iters: 1000, epoch: 5 | loss: 0.0175634
	speed: 0.0053s/iter; time left: 34.2182s
	iters: 1100, epoch: 5 | loss: 0.0707788
	speed: 0.0066s/iter; time left: 41.8823s
	iters: 1200, epoch: 5 | loss: 0.0200935
	speed: 0.0053s/iter; time left: 33.4483s
Epoch: 5 cost time: 7.7s
Epoch: 5, Steps: 1243 | Train Loss: 0.0385651 Vali Loss: 4.3803587 Test Loss: 18.4011612
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : GD_336_720_MS_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2425

Final Metrics:

FITS_DLinear MSE: 17.725513  MAE: 3.310966   SE: 29.014999  RRMSE: 0.272618   RMAE: 0.214392   (numpy)
FITS_DLinear MSE: 17.725512  MAE: 3.310966   SE: 29.015003  RRMSE: 0.272618   RMAE: 0.214392   (torch)

Repeat       MSE: 20.162743  MAE: 3.575489   SE: 46.713753  RRMSE: 0.290756   RMAE: 0.231521   (numpy)
Repeat       MSE: 20.162741  MAE: 3.575489   SE: 46.713760  RRMSE: 0.290756   RMAE: 0.231521   (torch)

Shapes: pred (2424, 720, 1), true (2424, 720, 1), naive_pred (2424, 720, 1), gt (2424, 1056, 1), metrics {'FITS_DLinear': {'mse': 17.725513, 'mae': 3.3109663, 'se': 29.015, 'relative_rmse': 0.2726176, 'relative_mae': 0.21439233, 'mse_torch': 17.72551155090332, 'mae_torch': 3.3109662532806396, 'se_torch': 29.015003204345703, 'relative_rmse_torch': 0.27261759560652443, 'relative_mae_torch': 0.2143923321914266}, 'Repeat': {'mse': 20.162743, 'mae': 3.5754886, 'se': 46.713753, 'relative_rmse': 0.29075643, 'relative_mae': 0.23152073, 'mse_torch': 20.16274070739746, 'mae_torch': 3.575488805770874, 'se_torch': 46.71376037597656, 'relative_rmse_torch': 0.29075639592843516, 'relative_mae_torch': 0.23152074806984826}}
