Args in experiment:
Namespace(is_training=1, model_id='exchange_rate_336_96_M_channels_8', model='FITS_DLinear', data='custom', root_path='./dataset/', data_path='exchange_rate.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
exchange_rate_336_96_M_channels_8
Use CPU

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=168, out_features=216, bias=True)
  )
  (dlinear): Model(
    (decompsition): series_decomp(
      (moving_avg): moving_avg(
        (avg): AvgPool1d(kernel_size=(25,), stride=(1,), padding=(0,))
      )
    )
    (Linear_Seasonal): Linear(in_features=336, out_features=96, bias=True)
    (Linear_Trend): Linear(in_features=336, out_features=96, bias=True)
    (Linear_Decoder): Linear(in_features=336, out_features=96, bias=True)
  )
)

>>>>>>>start training : exchange_rate_336_96_M_channels_8>>>>>>>>>>>>>>>>>>>>>>>>>>

train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.0817769
	speed: 0.0058s/iter; time left: 34.9166s
	iters: 200, epoch: 1 | loss: 0.1397464
	speed: 0.0025s/iter; time left: 14.7548s
	iters: 300, epoch: 1 | loss: 0.1524774
	speed: 0.0023s/iter; time left: 13.3999s
	iters: 400, epoch: 1 | loss: 0.1564838
	speed: 0.0024s/iter; time left: 13.4114s
	iters: 500, epoch: 1 | loss: 0.0987299
	speed: 0.0024s/iter; time left: 13.6877s
	iters: 600, epoch: 1 | loss: 0.1398113
	speed: 0.0028s/iter; time left: 15.2990s
Epoch: 1 cost time: 1.5s
Epoch: 1, Steps: 610 | Train Loss: 0.1452426 Vali Loss: 0.2083827 Test Loss: 0.0993225
Validation loss decreased (inf --> 0.208383).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1212441
	speed: 0.0070s/iter; time left: 37.5538s
	iters: 200, epoch: 2 | loss: 0.1288069
	speed: 0.0025s/iter; time left: 13.0004s
	iters: 300, epoch: 2 | loss: 0.0979140
	speed: 0.0025s/iter; time left: 13.2198s
	iters: 400, epoch: 2 | loss: 0.0637177
	speed: 0.0024s/iter; time left: 12.2174s
	iters: 500, epoch: 2 | loss: 0.0812695
	speed: 0.0024s/iter; time left: 12.1428s
	iters: 600, epoch: 2 | loss: 0.0494169
	speed: 0.0024s/iter; time left: 11.7611s
Epoch: 2 cost time: 1.5s
Epoch: 2, Steps: 610 | Train Loss: 0.1250727 Vali Loss: 0.1543564 Test Loss: 0.0948002
Validation loss decreased (0.208383 --> 0.154356).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0866040
	speed: 0.0073s/iter; time left: 34.9615s
	iters: 200, epoch: 3 | loss: 0.1568670
	speed: 0.0025s/iter; time left: 11.6429s
	iters: 300, epoch: 3 | loss: 0.1796269
	speed: 0.0024s/iter; time left: 11.0087s
	iters: 400, epoch: 3 | loss: 0.0619726
	speed: 0.0024s/iter; time left: 10.7287s
	iters: 500, epoch: 3 | loss: 0.1266544
	speed: 0.0026s/iter; time left: 11.2551s
	iters: 600, epoch: 3 | loss: 0.0785364
	speed: 0.0032s/iter; time left: 13.5801s
Epoch: 3 cost time: 1.6s
Epoch: 3, Steps: 610 | Train Loss: 0.1194624 Vali Loss: 0.1432063 Test Loss: 0.0790049
Validation loss decreased (0.154356 --> 0.143206).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0788331
	speed: 0.0072s/iter; time left: 29.8617s
	iters: 200, epoch: 4 | loss: 0.0721232
	speed: 0.0024s/iter; time left: 9.6063s
	iters: 300, epoch: 4 | loss: 0.0907939
	speed: 0.0026s/iter; time left: 10.2060s
	iters: 400, epoch: 4 | loss: 0.0531786
	speed: 0.0024s/iter; time left: 9.1807s
	iters: 500, epoch: 4 | loss: 0.0729731
	speed: 0.0027s/iter; time left: 10.2021s
	iters: 600, epoch: 4 | loss: 0.0788288
	speed: 0.0032s/iter; time left: 11.5752s
Epoch: 4 cost time: 1.6s
Epoch: 4, Steps: 610 | Train Loss: 0.1167300 Vali Loss: 0.1769099 Test Loss: 0.0850566
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0670617
	speed: 0.0071s/iter; time left: 25.3708s
	iters: 200, epoch: 5 | loss: 0.0722931
	speed: 0.0027s/iter; time left: 9.2450s
	iters: 300, epoch: 5 | loss: 0.2888512
	speed: 0.0024s/iter; time left: 7.9800s
	iters: 400, epoch: 5 | loss: 0.0659645
	speed: 0.0024s/iter; time left: 7.8652s
	iters: 500, epoch: 5 | loss: 0.0809023
	speed: 0.0025s/iter; time left: 8.0284s
	iters: 600, epoch: 5 | loss: 0.0858064
	speed: 0.0024s/iter; time left: 7.4851s
Epoch: 5 cost time: 1.5s
Epoch: 5, Steps: 610 | Train Loss: 0.1155517 Vali Loss: 0.1935854 Test Loss: 0.0896285
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1131192
	speed: 0.0070s/iter; time left: 20.7598s
	iters: 200, epoch: 6 | loss: 0.0905136
	speed: 0.0039s/iter; time left: 11.2428s
	iters: 300, epoch: 6 | loss: 0.1114874
	speed: 0.0024s/iter; time left: 6.6916s
	iters: 400, epoch: 6 | loss: 0.1228486
	speed: 0.0032s/iter; time left: 8.5168s
	iters: 500, epoch: 6 | loss: 0.0991976
	speed: 0.0037s/iter; time left: 9.4167s
	iters: 600, epoch: 6 | loss: 0.1116356
	speed: 0.0031s/iter; time left: 7.6234s
Epoch: 6 cost time: 1.9s
Epoch: 6, Steps: 610 | Train Loss: 0.1151067 Vali Loss: 0.1801826 Test Loss: 0.0847876
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : exchange_rate_336_96_M_channels_8<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422

Final Metrics:

FITS_DLinear MSE: 0.079005   MAE: 0.200091   SE: 0.155699   RRMSE: 0.193072   RMAE: 0.137442   (numpy)
FITS_DLinear MSE: 0.079005   MAE: 0.200091   SE: 0.155699   RRMSE: 0.193072   RMAE: 0.137442   (torch)

Repeat       MSE: 0.080829   MAE: 0.196013   SE: 0.164268   RRMSE: 0.195288   RMAE: 0.134641   (numpy)
Repeat       MSE: 0.080829   MAE: 0.196013   SE: 0.164268   RRMSE: 0.195288   RMAE: 0.134641   (torch)

Shapes: pred (1416, 96, 8), true (1416, 96, 8), naive_pred (1416, 96, 8), gt (1416, 432, 8), metrics {'FITS_DLinear': {'mse': 0.07900489, 'mae': 0.20009126, 'se': 0.1556989, 'relative_rmse': 0.19307193, 'relative_mae': 0.13744225, 'mse_torch': 0.07900489121675491, 'mae_torch': 0.20009128749370575, 'se_torch': 0.15569889545440674, 'relative_rmse_torch': 0.1930719156052314, 'relative_mae_torch': 0.13744226214715005}, 'Repeat': {'mse': 0.08082934, 'mae': 0.1960129, 'se': 0.16426785, 'relative_rmse': 0.19528848, 'relative_mae': 0.13464083, 'mse_torch': 0.08082933723926544, 'mae_torch': 0.1960129737854004, 'se_torch': 0.16426785290241241, 'relative_rmse_torch': 0.19528847981265055, 'relative_mae_torch': 0.13464087749499296}}
