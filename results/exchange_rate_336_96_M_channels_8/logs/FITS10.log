Args in experiment:
Namespace(is_training=1, model_id='exchange_rate_336_96_M_channels_8', model='FITS10', data='custom', root_path='./dataset/', data_path='exchange_rate.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
exchange_rate_336_96_M_channels_8
Use CPU
FITS cutoff frequency: 10

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=10, out_features=12, bias=True)
  )
)

>>>>>>>start training : exchange_rate_336_96_M_channels_8>>>>>>>>>>>>>>>>>>>>>>>>>>

train 4880
val 665
test 1422
	iters: 100, epoch: 1 | loss: 0.2151087
	speed: 0.0045s/iter; time left: 27.2948s
	iters: 200, epoch: 1 | loss: 0.2549143
	speed: 0.0007s/iter; time left: 4.3012s
	iters: 300, epoch: 1 | loss: 0.1612634
	speed: 0.0007s/iter; time left: 4.1900s
	iters: 400, epoch: 1 | loss: 0.1440449
	speed: 0.0007s/iter; time left: 4.1176s
	iters: 500, epoch: 1 | loss: 0.1494315
	speed: 0.0007s/iter; time left: 4.0744s
	iters: 600, epoch: 1 | loss: 0.1411407
	speed: 0.0007s/iter; time left: 4.0099s
Epoch: 1 cost time: 0.5s
Epoch: 1, Steps: 610 | Train Loss: 0.2245623 Vali Loss: 0.1730522 Test Loss: 0.1196900
Validation loss decreased (inf --> 0.173052).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2215016
	speed: 0.0022s/iter; time left: 11.7097s
	iters: 200, epoch: 2 | loss: 0.1282437
	speed: 0.0007s/iter; time left: 3.8637s
	iters: 300, epoch: 2 | loss: 0.1098675
	speed: 0.0007s/iter; time left: 3.7841s
	iters: 400, epoch: 2 | loss: 0.3082306
	speed: 0.0007s/iter; time left: 3.6811s
	iters: 500, epoch: 2 | loss: 0.1771891
	speed: 0.0007s/iter; time left: 3.7087s
	iters: 600, epoch: 2 | loss: 0.0731516
	speed: 0.0008s/iter; time left: 3.7129s
Epoch: 2 cost time: 0.5s
Epoch: 2, Steps: 610 | Train Loss: 0.1670421 Vali Loss: 0.1577696 Test Loss: 0.1046270
Validation loss decreased (0.173052 --> 0.157770).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.1352641
	speed: 0.0022s/iter; time left: 10.3092s
	iters: 200, epoch: 3 | loss: 0.1361340
	speed: 0.0007s/iter; time left: 3.3820s
	iters: 300, epoch: 3 | loss: 0.1225345
	speed: 0.0007s/iter; time left: 3.3286s
	iters: 400, epoch: 3 | loss: 0.2639325
	speed: 0.0007s/iter; time left: 3.2739s
	iters: 500, epoch: 3 | loss: 0.0989730
	speed: 0.0007s/iter; time left: 3.2041s
	iters: 600, epoch: 3 | loss: 0.2257697
	speed: 0.0007s/iter; time left: 3.1235s
Epoch: 3 cost time: 0.4s
Epoch: 3, Steps: 610 | Train Loss: 0.1538482 Vali Loss: 0.1548092 Test Loss: 0.1021591
Validation loss decreased (0.157770 --> 0.154809).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1490991
	speed: 0.0022s/iter; time left: 9.0421s
	iters: 200, epoch: 4 | loss: 0.0748304
	speed: 0.0007s/iter; time left: 2.9650s
	iters: 300, epoch: 4 | loss: 0.1459297
	speed: 0.0007s/iter; time left: 2.8987s
	iters: 400, epoch: 4 | loss: 0.3256116
	speed: 0.0007s/iter; time left: 2.7879s
	iters: 500, epoch: 4 | loss: 0.1005156
	speed: 0.0007s/iter; time left: 2.7368s
	iters: 600, epoch: 4 | loss: 0.1655566
	speed: 0.0007s/iter; time left: 2.6626s
Epoch: 4 cost time: 0.4s
Epoch: 4, Steps: 610 | Train Loss: 0.1499061 Vali Loss: 0.1537516 Test Loss: 0.1010945
Validation loss decreased (0.154809 --> 0.153752).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0924682
	speed: 0.0022s/iter; time left: 7.7153s
	iters: 200, epoch: 5 | loss: 0.0909122
	speed: 0.0007s/iter; time left: 2.5105s
	iters: 300, epoch: 5 | loss: 0.1218106
	speed: 0.0007s/iter; time left: 2.3985s
	iters: 400, epoch: 5 | loss: 0.1348075
	speed: 0.0008s/iter; time left: 2.5268s
	iters: 500, epoch: 5 | loss: 0.1023163
	speed: 0.0007s/iter; time left: 2.3104s
	iters: 600, epoch: 5 | loss: 0.1379235
	speed: 0.0007s/iter; time left: 2.2272s
Epoch: 5 cost time: 0.4s
Epoch: 5, Steps: 610 | Train Loss: 0.1483408 Vali Loss: 0.1527046 Test Loss: 0.1005476
Validation loss decreased (0.153752 --> 0.152705).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0731340
	speed: 0.0022s/iter; time left: 6.4944s
	iters: 200, epoch: 6 | loss: 0.1454713
	speed: 0.0008s/iter; time left: 2.1651s
	iters: 300, epoch: 6 | loss: 0.1315891
	speed: 0.0007s/iter; time left: 1.9750s
	iters: 400, epoch: 6 | loss: 0.1149620
	speed: 0.0007s/iter; time left: 1.9094s
	iters: 500, epoch: 6 | loss: 0.0813456
	speed: 0.0007s/iter; time left: 1.8527s
	iters: 600, epoch: 6 | loss: 0.4398732
	speed: 0.0007s/iter; time left: 1.7807s
Epoch: 6 cost time: 0.5s
Epoch: 6, Steps: 610 | Train Loss: 0.1476068 Vali Loss: 0.1530675 Test Loss: 0.1002749
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.1020275
	speed: 0.0021s/iter; time left: 4.9798s
	iters: 200, epoch: 7 | loss: 0.1186447
	speed: 0.0007s/iter; time left: 1.6194s
	iters: 300, epoch: 7 | loss: 0.2630114
	speed: 0.0007s/iter; time left: 1.5636s
	iters: 400, epoch: 7 | loss: 0.2187224
	speed: 0.0007s/iter; time left: 1.5277s
	iters: 500, epoch: 7 | loss: 0.2287670
	speed: 0.0007s/iter; time left: 1.3856s
	iters: 600, epoch: 7 | loss: 0.1057952
	speed: 0.0007s/iter; time left: 1.2983s
Epoch: 7 cost time: 0.4s
Epoch: 7, Steps: 610 | Train Loss: 0.1472594 Vali Loss: 0.1528390 Test Loss: 0.1001686
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.2526250
	speed: 0.0021s/iter; time left: 3.6358s
	iters: 200, epoch: 8 | loss: 0.1412958
	speed: 0.0007s/iter; time left: 1.1546s
	iters: 300, epoch: 8 | loss: 0.3731101
	speed: 0.0007s/iter; time left: 1.1025s
	iters: 400, epoch: 8 | loss: 0.1770556
	speed: 0.0007s/iter; time left: 1.0424s
	iters: 500, epoch: 8 | loss: 0.1536799
	speed: 0.0007s/iter; time left: 0.9432s
	iters: 600, epoch: 8 | loss: 0.0831558
	speed: 0.0007s/iter; time left: 0.8627s
Epoch: 8 cost time: 0.4s
Epoch: 8, Steps: 610 | Train Loss: 0.1470868 Vali Loss: 0.1527999 Test Loss: 0.1001050
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : exchange_rate_336_96_M_channels_8<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1422

Final Metrics:

FITS10       MSE: 0.100548   MAE: 0.228007   SE: 0.211181   RRMSE: 0.217810   RMAE: 0.156618   (numpy)
FITS10       MSE: 0.100548   MAE: 0.228007   SE: 0.211181   RRMSE: 0.217810   RMAE: 0.156618   (torch)

Repeat       MSE: 0.080829   MAE: 0.196013   SE: 0.164268   RRMSE: 0.195288   RMAE: 0.134641   (numpy)
Repeat       MSE: 0.080829   MAE: 0.196013   SE: 0.164268   RRMSE: 0.195288   RMAE: 0.134641   (torch)

Shapes: pred (1416, 96, 8), true (1416, 96, 8), naive_pred (1416, 96, 8), gt (1416, 432, 8), metrics {'FITS10': {'mse': 0.10054755, 'mae': 0.22800747, 'se': 0.21118069, 'relative_rmse': 0.21781002, 'relative_mae': 0.15661782, 'mse_torch': 0.10054755210876465, 'mae_torch': 0.2280074656009674, 'se_torch': 0.2111806720495224, 'relative_rmse_torch': 0.21781002596273155, 'relative_mae_torch': 0.15661782305049765}, 'Repeat': {'mse': 0.08082934, 'mae': 0.1960129, 'se': 0.16426785, 'relative_rmse': 0.19528848, 'relative_mae': 0.13464083, 'mse_torch': 0.08082933723926544, 'mae_torch': 0.1960129737854004, 'se_torch': 0.16426785290241241, 'relative_rmse_torch': 0.19528847981265055, 'relative_mae_torch': 0.13464087749499296}}
