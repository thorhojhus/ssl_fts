Args in experiment:
Namespace(is_training=1, model_id='GD_336_96_MS_channels_6', model='FITS10', data='custom', root_path='./dataset/', data_path='GD.csv', features='MS', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
GD_336_96_MS_channels_6
Use CPU
FITS cutoff frequency: 10

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=10, out_features=12, bias=True)
  )
)

>>>>>>>start training : GD_336_96_MS_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10575
val 1479
test 3049
	iters: 100, epoch: 1 | loss: 0.0137241
	speed: 0.0039s/iter; time left: 50.5544s
	iters: 200, epoch: 1 | loss: 0.0144533
	speed: 0.0006s/iter; time left: 8.2261s
	iters: 300, epoch: 1 | loss: 0.0490909
	speed: 0.0006s/iter; time left: 8.0319s
	iters: 400, epoch: 1 | loss: 0.0229805
	speed: 0.0007s/iter; time left: 9.3268s
	iters: 500, epoch: 1 | loss: 0.0187084
	speed: 0.0006s/iter; time left: 7.9253s
	iters: 600, epoch: 1 | loss: 0.0337977
	speed: 0.0006s/iter; time left: 8.0680s
	iters: 700, epoch: 1 | loss: 0.0132504
	speed: 0.0006s/iter; time left: 7.8130s
	iters: 800, epoch: 1 | loss: 0.0217443
	speed: 0.0006s/iter; time left: 8.0614s
	iters: 900, epoch: 1 | loss: 0.0661139
	speed: 0.0006s/iter; time left: 7.4252s
	iters: 1000, epoch: 1 | loss: 0.0348804
	speed: 0.0006s/iter; time left: 7.3540s
	iters: 1100, epoch: 1 | loss: 0.0357684
	speed: 0.0006s/iter; time left: 7.3091s
	iters: 1200, epoch: 1 | loss: 0.0543899
	speed: 0.0006s/iter; time left: 7.1822s
	iters: 1300, epoch: 1 | loss: 0.0062234
	speed: 0.0006s/iter; time left: 7.1335s
Epoch: 1 cost time: 0.8s
Epoch: 1, Steps: 1321 | Train Loss: 0.0266074 Vali Loss: 0.5958151 Test Loss: 3.0603364
Validation loss decreased (inf --> 0.595815).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0014899
	speed: 0.0031s/iter; time left: 36.6610s
	iters: 200, epoch: 2 | loss: 0.0029527
	speed: 0.0006s/iter; time left: 7.2654s
	iters: 300, epoch: 2 | loss: 0.0081089
	speed: 0.0006s/iter; time left: 7.1018s
	iters: 400, epoch: 2 | loss: 0.0019839
	speed: 0.0006s/iter; time left: 7.0061s
	iters: 500, epoch: 2 | loss: 0.0112047
	speed: 0.0006s/iter; time left: 6.9099s
	iters: 600, epoch: 2 | loss: 0.0035701
	speed: 0.0006s/iter; time left: 6.8684s
	iters: 700, epoch: 2 | loss: 0.0315564
	speed: 0.0006s/iter; time left: 6.7850s
	iters: 800, epoch: 2 | loss: 0.0034715
	speed: 0.0006s/iter; time left: 6.7363s
	iters: 900, epoch: 2 | loss: 0.0079626
	speed: 0.0006s/iter; time left: 6.6923s
	iters: 1000, epoch: 2 | loss: 0.0046262
	speed: 0.0006s/iter; time left: 6.6159s
	iters: 1100, epoch: 2 | loss: 0.0099982
	speed: 0.0006s/iter; time left: 6.5392s
	iters: 1200, epoch: 2 | loss: 0.0571666
	speed: 0.0006s/iter; time left: 6.4894s
	iters: 1300, epoch: 2 | loss: 0.0002978
	speed: 0.0006s/iter; time left: 6.4136s
Epoch: 2 cost time: 0.8s
Epoch: 2, Steps: 1321 | Train Loss: 0.0201456 Vali Loss: 0.5440576 Test Loss: 2.8163128
Validation loss decreased (0.595815 --> 0.544058).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0081029
	speed: 0.0031s/iter; time left: 32.2647s
	iters: 200, epoch: 3 | loss: 0.0168563
	speed: 0.0006s/iter; time left: 6.2886s
	iters: 300, epoch: 3 | loss: 0.0039104
	speed: 0.0006s/iter; time left: 6.2177s
	iters: 400, epoch: 3 | loss: 0.0111680
	speed: 0.0006s/iter; time left: 6.1477s
	iters: 500, epoch: 3 | loss: 0.0009896
	speed: 0.0006s/iter; time left: 6.1113s
	iters: 600, epoch: 3 | loss: 0.0113848
	speed: 0.0006s/iter; time left: 6.0365s
	iters: 700, epoch: 3 | loss: 0.0001294
	speed: 0.0006s/iter; time left: 6.2929s
	iters: 800, epoch: 3 | loss: 0.0099823
	speed: 0.0006s/iter; time left: 5.9372s
	iters: 900, epoch: 3 | loss: 0.0126295
	speed: 0.0006s/iter; time left: 5.8629s
	iters: 1000, epoch: 3 | loss: 0.0120844
	speed: 0.0006s/iter; time left: 5.7889s
	iters: 1100, epoch: 3 | loss: 0.0006263
	speed: 0.0006s/iter; time left: 5.7484s
	iters: 1200, epoch: 3 | loss: 0.0114478
	speed: 0.0006s/iter; time left: 5.6711s
	iters: 1300, epoch: 3 | loss: 0.0122556
	speed: 0.0006s/iter; time left: 5.6231s
Epoch: 3 cost time: 0.8s
Epoch: 3, Steps: 1321 | Train Loss: 0.0186873 Vali Loss: 0.5311236 Test Loss: 2.7626863
Validation loss decreased (0.544058 --> 0.531124).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.0017851
	speed: 0.0031s/iter; time left: 28.1857s
	iters: 200, epoch: 4 | loss: 0.0246239
	speed: 0.0006s/iter; time left: 5.4898s
	iters: 300, epoch: 4 | loss: 0.0144808
	speed: 0.0006s/iter; time left: 5.3880s
	iters: 400, epoch: 4 | loss: 0.0023098
	speed: 0.0006s/iter; time left: 5.3425s
	iters: 500, epoch: 4 | loss: 0.0131810
	speed: 0.0006s/iter; time left: 5.3712s
	iters: 600, epoch: 4 | loss: 0.0014166
	speed: 0.0006s/iter; time left: 5.2116s
	iters: 700, epoch: 4 | loss: 0.0167182
	speed: 0.0006s/iter; time left: 5.1231s
	iters: 800, epoch: 4 | loss: 0.0175067
	speed: 0.0006s/iter; time left: 5.0678s
	iters: 900, epoch: 4 | loss: 0.0110728
	speed: 0.0006s/iter; time left: 4.9960s
	iters: 1000, epoch: 4 | loss: 0.0432307
	speed: 0.0006s/iter; time left: 4.9394s
	iters: 1100, epoch: 4 | loss: 0.0946327
	speed: 0.0006s/iter; time left: 4.8779s
	iters: 1200, epoch: 4 | loss: 0.0076080
	speed: 0.0006s/iter; time left: 4.8295s
	iters: 1300, epoch: 4 | loss: 0.0246737
	speed: 0.0006s/iter; time left: 4.8227s
Epoch: 4 cost time: 0.8s
Epoch: 4, Steps: 1321 | Train Loss: 0.0182847 Vali Loss: 0.5300902 Test Loss: 2.7209966
Validation loss decreased (0.531124 --> 0.530090).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0021197
	speed: 0.0031s/iter; time left: 24.3582s
	iters: 200, epoch: 5 | loss: 0.0199094
	speed: 0.0006s/iter; time left: 4.7837s
	iters: 300, epoch: 5 | loss: 0.0254203
	speed: 0.0006s/iter; time left: 4.6903s
	iters: 400, epoch: 5 | loss: 0.0043481
	speed: 0.0006s/iter; time left: 4.6571s
	iters: 500, epoch: 5 | loss: 0.0420252
	speed: 0.0006s/iter; time left: 4.5745s
	iters: 600, epoch: 5 | loss: 0.0023831
	speed: 0.0006s/iter; time left: 4.6598s
	iters: 700, epoch: 5 | loss: 0.0250610
	speed: 0.0006s/iter; time left: 4.4836s
	iters: 800, epoch: 5 | loss: 0.0165582
	speed: 0.0006s/iter; time left: 4.3304s
	iters: 900, epoch: 5 | loss: 0.0344883
	speed: 0.0006s/iter; time left: 4.3101s
	iters: 1000, epoch: 5 | loss: 0.0025441
	speed: 0.0006s/iter; time left: 4.1538s
	iters: 1100, epoch: 5 | loss: 0.0011452
	speed: 0.0006s/iter; time left: 4.0982s
	iters: 1200, epoch: 5 | loss: 0.0140349
	speed: 0.0006s/iter; time left: 4.0704s
	iters: 1300, epoch: 5 | loss: 0.0059337
	speed: 0.0006s/iter; time left: 4.0365s
Epoch: 5 cost time: 0.8s
Epoch: 5, Steps: 1321 | Train Loss: 0.0180912 Vali Loss: 0.5286316 Test Loss: 2.7091644
Validation loss decreased (0.530090 --> 0.528632).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.0041644
	speed: 0.0031s/iter; time left: 19.9919s
	iters: 200, epoch: 6 | loss: 0.0066621
	speed: 0.0006s/iter; time left: 3.9977s
	iters: 300, epoch: 6 | loss: 0.0023391
	speed: 0.0006s/iter; time left: 3.9603s
	iters: 400, epoch: 6 | loss: 0.0128633
	speed: 0.0006s/iter; time left: 3.8732s
	iters: 500, epoch: 6 | loss: 0.0155480
	speed: 0.0006s/iter; time left: 3.7530s
	iters: 600, epoch: 6 | loss: 0.0005231
	speed: 0.0006s/iter; time left: 3.6919s
	iters: 700, epoch: 6 | loss: 0.0283360
	speed: 0.0006s/iter; time left: 3.6345s
	iters: 800, epoch: 6 | loss: 0.1400258
	speed: 0.0006s/iter; time left: 3.5709s
	iters: 900, epoch: 6 | loss: 0.0021776
	speed: 0.0006s/iter; time left: 3.4945s
	iters: 1000, epoch: 6 | loss: 0.0031785
	speed: 0.0006s/iter; time left: 3.4521s
	iters: 1100, epoch: 6 | loss: 0.0007756
	speed: 0.0006s/iter; time left: 3.4069s
	iters: 1200, epoch: 6 | loss: 0.0091684
	speed: 0.0006s/iter; time left: 3.3318s
	iters: 1300, epoch: 6 | loss: 0.0032296
	speed: 0.0006s/iter; time left: 3.2814s
Epoch: 6 cost time: 0.8s
Epoch: 6, Steps: 1321 | Train Loss: 0.0179763 Vali Loss: 0.5233245 Test Loss: 2.7044988
Validation loss decreased (0.528632 --> 0.523324).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0234735
	speed: 0.0031s/iter; time left: 16.2142s
	iters: 200, epoch: 7 | loss: 0.0247652
	speed: 0.0006s/iter; time left: 3.1229s
	iters: 300, epoch: 7 | loss: 0.0168483
	speed: 0.0006s/iter; time left: 2.9943s
	iters: 400, epoch: 7 | loss: 0.0170426
	speed: 0.0006s/iter; time left: 2.9345s
	iters: 500, epoch: 7 | loss: 0.0682080
	speed: 0.0006s/iter; time left: 2.9490s
	iters: 600, epoch: 7 | loss: 0.0074162
	speed: 0.0006s/iter; time left: 2.9158s
	iters: 700, epoch: 7 | loss: 0.0275215
	speed: 0.0006s/iter; time left: 2.7506s
	iters: 800, epoch: 7 | loss: 0.0016236
	speed: 0.0006s/iter; time left: 2.6941s
	iters: 900, epoch: 7 | loss: 0.0022705
	speed: 0.0006s/iter; time left: 2.6325s
	iters: 1000, epoch: 7 | loss: 0.0308130
	speed: 0.0006s/iter; time left: 2.5686s
	iters: 1100, epoch: 7 | loss: 0.0035120
	speed: 0.0006s/iter; time left: 2.5082s
	iters: 1200, epoch: 7 | loss: 0.0310854
	speed: 0.0006s/iter; time left: 2.4568s
	iters: 1300, epoch: 7 | loss: 0.0245629
	speed: 0.0006s/iter; time left: 2.3923s
Epoch: 7 cost time: 0.8s
Epoch: 7, Steps: 1321 | Train Loss: 0.0179783 Vali Loss: 0.5267640 Test Loss: 2.7016556
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.0066117
	speed: 0.0031s/iter; time left: 11.8338s
	iters: 200, epoch: 8 | loss: 0.0405953
	speed: 0.0006s/iter; time left: 2.2488s
	iters: 300, epoch: 8 | loss: 0.0007608
	speed: 0.0006s/iter; time left: 2.1880s
	iters: 400, epoch: 8 | loss: 0.0053910
	speed: 0.0006s/iter; time left: 2.1331s
	iters: 500, epoch: 8 | loss: 0.0015836
	speed: 0.0006s/iter; time left: 2.0764s
	iters: 600, epoch: 8 | loss: 0.0079001
	speed: 0.0006s/iter; time left: 2.0147s
	iters: 700, epoch: 8 | loss: 0.0141948
	speed: 0.0006s/iter; time left: 1.9487s
	iters: 800, epoch: 8 | loss: 0.0338217
	speed: 0.0006s/iter; time left: 1.8903s
	iters: 900, epoch: 8 | loss: 0.0020295
	speed: 0.0006s/iter; time left: 1.8379s
	iters: 1000, epoch: 8 | loss: 0.0391329
	speed: 0.0006s/iter; time left: 1.7731s
	iters: 1100, epoch: 8 | loss: 0.0033366
	speed: 0.0006s/iter; time left: 1.7106s
	iters: 1200, epoch: 8 | loss: 0.0322002
	speed: 0.0006s/iter; time left: 1.7407s
	iters: 1300, epoch: 8 | loss: 0.0005937
	speed: 0.0006s/iter; time left: 1.6435s
Epoch: 8 cost time: 0.8s
Epoch: 8, Steps: 1321 | Train Loss: 0.0179400 Vali Loss: 0.5234966 Test Loss: 2.7005017
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0399634
	speed: 0.0032s/iter; time left: 8.1510s
	iters: 200, epoch: 9 | loss: 0.0048308
	speed: 0.0006s/iter; time left: 1.4647s
	iters: 300, epoch: 9 | loss: 0.0016265
	speed: 0.0006s/iter; time left: 1.4030s
	iters: 400, epoch: 9 | loss: 0.0247789
	speed: 0.0006s/iter; time left: 1.3452s
	iters: 500, epoch: 9 | loss: 0.0150858
	speed: 0.0006s/iter; time left: 1.3900s
	iters: 600, epoch: 9 | loss: 0.0278749
	speed: 0.0006s/iter; time left: 1.2759s
	iters: 700, epoch: 9 | loss: 0.0068827
	speed: 0.0006s/iter; time left: 1.1628s
	iters: 800, epoch: 9 | loss: 0.0130972
	speed: 0.0006s/iter; time left: 1.1010s
	iters: 900, epoch: 9 | loss: 0.0289403
	speed: 0.0006s/iter; time left: 1.0430s
	iters: 1000, epoch: 9 | loss: 0.0031902
	speed: 0.0006s/iter; time left: 1.0084s
	iters: 1100, epoch: 9 | loss: 0.0196235
	speed: 0.0006s/iter; time left: 0.9657s
	iters: 1200, epoch: 9 | loss: 0.0007854
	speed: 0.0007s/iter; time left: 0.9477s
	iters: 1300, epoch: 9 | loss: 0.0210486
	speed: 0.0006s/iter; time left: 0.8151s
Epoch: 9 cost time: 0.8s
Epoch: 9, Steps: 1321 | Train Loss: 0.0179445 Vali Loss: 0.5261279 Test Loss: 2.6998620
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : GD_336_96_MS_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3049

Final Metrics:

FITS10       MSE: 2.704499   MAE: 1.238646   SE: 5.193306   RRMSE: 0.106596   RMAE: 0.080287   (numpy)
FITS10       MSE: 2.704499   MAE: 1.238646   SE: 5.193306   RRMSE: 0.106596   RMAE: 0.080287   (torch)

Repeat       MSE: 2.179713   MAE: 1.044575   SE: 4.422679   RRMSE: 0.095697   RMAE: 0.067707   (numpy)
Repeat       MSE: 2.179713   MAE: 1.044575   SE: 4.422679   RRMSE: 0.095697   RMAE: 0.067707   (torch)

Shapes: pred (3048, 96, 1), true (3048, 96, 1), naive_pred (3048, 96, 1), gt (3048, 432, 1), metrics {'FITS10': {'mse': 2.7044985, 'mae': 1.2386459, 'se': 5.193306, 'relative_rmse': 0.106595784, 'relative_mae': 0.08028674, 'mse_torch': 2.704498529434204, 'mae_torch': 1.2386459112167358, 'se_torch': 5.193305969238281, 'relative_rmse_torch': 0.10659578050576374, 'relative_mae_torch': 0.08028673786936019}, 'Repeat': {'mse': 2.179713, 'mae': 1.0445752, 'se': 4.4226794, 'relative_rmse': 0.09569655, 'relative_mae': 0.067707434, 'mse_torch': 2.179713249206543, 'mae_torch': 1.0445752143859863, 'se_torch': 4.4226789474487305, 'relative_rmse_torch': 0.09569655880903553, 'relative_mae_torch': 0.06770743411234963}}
