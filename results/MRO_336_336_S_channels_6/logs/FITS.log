Args in experiment:
Namespace(is_training=1, model_id='MRO_336_336_S_channels_6', model='FITS', data='custom', root_path='./dataset/', data_path='MRO.csv', features='S', target='Adj Close', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=6, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
MRO_336_336_S_channels_6
Use CPU
FITS cutoff frequency: 168

Model(
  (fits): FITS(
    (frequency_upsampler): Linear(in_features=168, out_features=336, bias=True)
  )
)

>>>>>>>start training : MRO_336_336_S_channels_6>>>>>>>>>>>>>>>>>>>>>>>>>>

train 10335
val 1239
test 2809
	iters: 100, epoch: 1 | loss: 0.0794695
	speed: 0.0044s/iter; time left: 56.8104s
	iters: 200, epoch: 1 | loss: 0.0341891
	speed: 0.0014s/iter; time left: 17.6201s
	iters: 300, epoch: 1 | loss: 0.0502470
	speed: 0.0015s/iter; time left: 18.3379s
	iters: 400, epoch: 1 | loss: 0.2358449
	speed: 0.0013s/iter; time left: 16.4566s
	iters: 500, epoch: 1 | loss: 0.0984177
	speed: 0.0014s/iter; time left: 17.0574s
	iters: 600, epoch: 1 | loss: 0.0612871
	speed: 0.0013s/iter; time left: 15.7390s
	iters: 700, epoch: 1 | loss: 0.0757203
	speed: 0.0013s/iter; time left: 16.0283s
	iters: 800, epoch: 1 | loss: 0.1173494
	speed: 0.0018s/iter; time left: 21.4456s
	iters: 900, epoch: 1 | loss: 0.4931588
	speed: 0.0015s/iter; time left: 17.7130s
	iters: 1000, epoch: 1 | loss: 0.0642072
	speed: 0.0013s/iter; time left: 15.5496s
	iters: 1100, epoch: 1 | loss: 0.0480312
	speed: 0.0012s/iter; time left: 14.7094s
	iters: 1200, epoch: 1 | loss: 0.0387910
	speed: 0.0014s/iter; time left: 16.1749s
Epoch: 1 cost time: 1.8s
Epoch: 1, Steps: 1291 | Train Loss: 0.1213948 Vali Loss: 8.6258144 Test Loss: 11.8087444
Validation loss decreased (inf --> 8.625814).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.0825058
	speed: 0.0047s/iter; time left: 53.6742s
	iters: 200, epoch: 2 | loss: 0.0736727
	speed: 0.0013s/iter; time left: 15.1594s
	iters: 300, epoch: 2 | loss: 0.1072265
	speed: 0.0013s/iter; time left: 14.6730s
	iters: 400, epoch: 2 | loss: 0.0549625
	speed: 0.0013s/iter; time left: 14.1712s
	iters: 500, epoch: 2 | loss: 0.1129530
	speed: 0.0014s/iter; time left: 15.7897s
	iters: 600, epoch: 2 | loss: 0.2053355
	speed: 0.0012s/iter; time left: 13.5778s
	iters: 700, epoch: 2 | loss: 0.1561466
	speed: 0.0016s/iter; time left: 17.1218s
	iters: 800, epoch: 2 | loss: 0.0759289
	speed: 0.0014s/iter; time left: 14.9328s
	iters: 900, epoch: 2 | loss: 0.1029942
	speed: 0.0015s/iter; time left: 16.5981s
	iters: 1000, epoch: 2 | loss: 0.0389486
	speed: 0.0014s/iter; time left: 14.3938s
	iters: 1100, epoch: 2 | loss: 0.2674929
	speed: 0.0013s/iter; time left: 13.4516s
	iters: 1200, epoch: 2 | loss: 0.1495953
	speed: 0.0013s/iter; time left: 13.9322s
Epoch: 2 cost time: 1.8s
Epoch: 2, Steps: 1291 | Train Loss: 0.1070794 Vali Loss: 8.2057238 Test Loss: 11.2068577
Validation loss decreased (8.625814 --> 8.205724).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.0697723
	speed: 0.0048s/iter; time left: 49.5477s
	iters: 200, epoch: 3 | loss: 0.0398215
	speed: 0.0014s/iter; time left: 14.0546s
	iters: 300, epoch: 3 | loss: 0.0615910
	speed: 0.0013s/iter; time left: 12.6211s
	iters: 400, epoch: 3 | loss: 0.1876663
	speed: 0.0015s/iter; time left: 14.7936s
	iters: 500, epoch: 3 | loss: 0.0704830
	speed: 0.0014s/iter; time left: 13.7097s
	iters: 600, epoch: 3 | loss: 0.0450743
	speed: 0.0013s/iter; time left: 12.6690s
	iters: 700, epoch: 3 | loss: 0.0468358
	speed: 0.0013s/iter; time left: 12.3107s
	iters: 800, epoch: 3 | loss: 0.0527700
	speed: 0.0014s/iter; time left: 13.1223s
	iters: 900, epoch: 3 | loss: 0.1225665
	speed: 0.0014s/iter; time left: 13.6330s
	iters: 1000, epoch: 3 | loss: 0.0947105
	speed: 0.0015s/iter; time left: 13.8967s
	iters: 1100, epoch: 3 | loss: 0.2011123
	speed: 0.0013s/iter; time left: 12.1534s
	iters: 1200, epoch: 3 | loss: 0.0791984
	speed: 0.0013s/iter; time left: 11.8593s
Epoch: 3 cost time: 1.8s
Epoch: 3, Steps: 1291 | Train Loss: 0.1038171 Vali Loss: 8.0629997 Test Loss: 11.0239763
Validation loss decreased (8.205724 --> 8.063000).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.1621018
	speed: 0.0047s/iter; time left: 41.6745s
	iters: 200, epoch: 4 | loss: 0.0420449
	speed: 0.0015s/iter; time left: 13.4567s
	iters: 300, epoch: 4 | loss: 0.1659448
	speed: 0.0013s/iter; time left: 11.7663s
	iters: 400, epoch: 4 | loss: 0.0306090
	speed: 0.0012s/iter; time left: 10.6951s
	iters: 500, epoch: 4 | loss: 0.1673308
	speed: 0.0015s/iter; time left: 12.5427s
	iters: 600, epoch: 4 | loss: 0.0732910
	speed: 0.0014s/iter; time left: 11.9828s
	iters: 700, epoch: 4 | loss: 0.0279526
	speed: 0.0013s/iter; time left: 11.0182s
	iters: 800, epoch: 4 | loss: 0.1978147
	speed: 0.0013s/iter; time left: 10.7156s
	iters: 900, epoch: 4 | loss: 0.1764904
	speed: 0.0014s/iter; time left: 11.4426s
	iters: 1000, epoch: 4 | loss: 0.1266568
	speed: 0.0017s/iter; time left: 13.7429s
	iters: 1100, epoch: 4 | loss: 0.1286325
	speed: 0.0014s/iter; time left: 11.2475s
	iters: 1200, epoch: 4 | loss: 0.1063317
	speed: 0.0014s/iter; time left: 11.0580s
Epoch: 4 cost time: 1.8s
Epoch: 4, Steps: 1291 | Train Loss: 0.1025267 Vali Loss: 8.0501423 Test Loss: 10.9665155
Validation loss decreased (8.063000 --> 8.050142).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.0646086
	speed: 0.0048s/iter; time left: 36.9631s
	iters: 200, epoch: 5 | loss: 0.0907144
	speed: 0.0014s/iter; time left: 10.6533s
	iters: 300, epoch: 5 | loss: 0.0528429
	speed: 0.0015s/iter; time left: 11.2521s
	iters: 400, epoch: 5 | loss: 0.1239164
	speed: 0.0013s/iter; time left: 9.8487s
	iters: 500, epoch: 5 | loss: 0.0248590
	speed: 0.0014s/iter; time left: 9.8976s
	iters: 600, epoch: 5 | loss: 0.0363219
	speed: 0.0014s/iter; time left: 10.1253s
	iters: 700, epoch: 5 | loss: 0.0380189
	speed: 0.0014s/iter; time left: 9.8976s
	iters: 800, epoch: 5 | loss: 0.1710081
	speed: 0.0014s/iter; time left: 9.4101s
	iters: 900, epoch: 5 | loss: 0.0512466
	speed: 0.0015s/iter; time left: 10.0668s
	iters: 1000, epoch: 5 | loss: 0.0525184
	speed: 0.0017s/iter; time left: 11.4365s
	iters: 1100, epoch: 5 | loss: 0.0371968
	speed: 0.0016s/iter; time left: 10.6234s
	iters: 1200, epoch: 5 | loss: 0.1502355
	speed: 0.0013s/iter; time left: 8.7578s
Epoch: 5 cost time: 1.9s
Epoch: 5, Steps: 1291 | Train Loss: 0.1020762 Vali Loss: 7.9992976 Test Loss: 10.9133368
Validation loss decreased (8.050142 --> 7.999298).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.1111299
	speed: 0.0048s/iter; time left: 30.4624s
	iters: 200, epoch: 6 | loss: 0.0501034
	speed: 0.0013s/iter; time left: 8.0041s
	iters: 300, epoch: 6 | loss: 0.0742243
	speed: 0.0014s/iter; time left: 8.3358s
	iters: 400, epoch: 6 | loss: 0.0495798
	speed: 0.0013s/iter; time left: 7.8531s
	iters: 500, epoch: 6 | loss: 0.0505643
	speed: 0.0015s/iter; time left: 9.1554s
	iters: 600, epoch: 6 | loss: 0.1148315
	speed: 0.0013s/iter; time left: 7.8461s
	iters: 700, epoch: 6 | loss: 0.1648671
	speed: 0.0012s/iter; time left: 7.1051s
	iters: 800, epoch: 6 | loss: 0.0343775
	speed: 0.0014s/iter; time left: 7.7114s
	iters: 900, epoch: 6 | loss: 0.0808161
	speed: 0.0013s/iter; time left: 7.1954s
	iters: 1000, epoch: 6 | loss: 0.1410496
	speed: 0.0016s/iter; time left: 8.6199s
	iters: 1100, epoch: 6 | loss: 0.0516185
	speed: 0.0014s/iter; time left: 7.2330s
	iters: 1200, epoch: 6 | loss: 0.0456330
	speed: 0.0014s/iter; time left: 7.2242s
Epoch: 6 cost time: 1.8s
Epoch: 6, Steps: 1291 | Train Loss: 0.1017747 Vali Loss: 7.9949570 Test Loss: 10.8999023
Validation loss decreased (7.999298 --> 7.994957).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.0430957
	speed: 0.0047s/iter; time left: 24.0082s
	iters: 200, epoch: 7 | loss: 0.0602101
	speed: 0.0014s/iter; time left: 6.8328s
	iters: 300, epoch: 7 | loss: 0.2794653
	speed: 0.0013s/iter; time left: 6.4963s
	iters: 400, epoch: 7 | loss: 0.1338591
	speed: 0.0015s/iter; time left: 7.1165s
	iters: 500, epoch: 7 | loss: 0.1139627
	speed: 0.0014s/iter; time left: 6.3695s
	iters: 600, epoch: 7 | loss: 0.1074302
	speed: 0.0014s/iter; time left: 6.1904s
	iters: 700, epoch: 7 | loss: 0.0962601
	speed: 0.0015s/iter; time left: 6.8247s
	iters: 800, epoch: 7 | loss: 0.1517517
	speed: 0.0015s/iter; time left: 6.4665s
	iters: 900, epoch: 7 | loss: 0.2226711
	speed: 0.0013s/iter; time left: 5.5598s
	iters: 1000, epoch: 7 | loss: 0.0784773
	speed: 0.0020s/iter; time left: 8.3802s
	iters: 1100, epoch: 7 | loss: 0.1385925
	speed: 0.0014s/iter; time left: 5.5640s
	iters: 1200, epoch: 7 | loss: 0.0439161
	speed: 0.0013s/iter; time left: 5.2712s
Epoch: 7 cost time: 1.9s
Epoch: 7, Steps: 1291 | Train Loss: 0.1016691 Vali Loss: 7.9646616 Test Loss: 10.8919859
Validation loss decreased (7.994957 --> 7.964662).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.1170600
	speed: 0.0047s/iter; time left: 17.9246s
	iters: 200, epoch: 8 | loss: 0.2672863
	speed: 0.0013s/iter; time left: 4.7929s
	iters: 300, epoch: 8 | loss: 0.0131011
	speed: 0.0016s/iter; time left: 5.7408s
	iters: 400, epoch: 8 | loss: 0.0701461
	speed: 0.0014s/iter; time left: 5.0290s
	iters: 500, epoch: 8 | loss: 0.0745478
	speed: 0.0013s/iter; time left: 4.5094s
	iters: 600, epoch: 8 | loss: 0.0341271
	speed: 0.0013s/iter; time left: 4.2335s
	iters: 700, epoch: 8 | loss: 0.0587953
	speed: 0.0014s/iter; time left: 4.3237s
	iters: 800, epoch: 8 | loss: 0.1350176
	speed: 0.0013s/iter; time left: 4.0264s
	iters: 900, epoch: 8 | loss: 0.1035659
	speed: 0.0013s/iter; time left: 3.9169s
	iters: 1000, epoch: 8 | loss: 0.0700764
	speed: 0.0016s/iter; time left: 4.7274s
	iters: 1100, epoch: 8 | loss: 0.0402959
	speed: 0.0014s/iter; time left: 3.8735s
	iters: 1200, epoch: 8 | loss: 0.0382145
	speed: 0.0013s/iter; time left: 3.5679s
Epoch: 8 cost time: 1.8s
Epoch: 8, Steps: 1291 | Train Loss: 0.1016217 Vali Loss: 7.9789419 Test Loss: 10.8879051
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.0611470
	speed: 0.0052s/iter; time left: 12.9736s
	iters: 200, epoch: 9 | loss: 0.0530918
	speed: 0.0016s/iter; time left: 3.7003s
	iters: 300, epoch: 9 | loss: 0.0733264
	speed: 0.0017s/iter; time left: 3.8672s
	iters: 400, epoch: 9 | loss: 0.0577406
	speed: 0.0016s/iter; time left: 3.4472s
	iters: 500, epoch: 9 | loss: 0.1013440
	speed: 0.0013s/iter; time left: 2.7768s
	iters: 600, epoch: 9 | loss: 0.2049549
	speed: 0.0013s/iter; time left: 2.6455s
	iters: 700, epoch: 9 | loss: 0.0595040
	speed: 0.0018s/iter; time left: 3.3559s
	iters: 800, epoch: 9 | loss: 0.0572242
	speed: 0.0015s/iter; time left: 2.6843s
	iters: 900, epoch: 9 | loss: 0.0844506
	speed: 0.0015s/iter; time left: 2.5500s
	iters: 1000, epoch: 9 | loss: 0.0324037
	speed: 0.0018s/iter; time left: 2.8991s
	iters: 1100, epoch: 9 | loss: 0.0964790
	speed: 0.0013s/iter; time left: 1.9363s
	iters: 1200, epoch: 9 | loss: 0.1905296
	speed: 0.0020s/iter; time left: 2.7137s
Epoch: 9 cost time: 2.0s
Epoch: 9, Steps: 1291 | Train Loss: 0.1015169 Vali Loss: 7.9585295 Test Loss: 10.8856249
Validation loss decreased (7.964662 --> 7.958529).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.0523469
	speed: 0.0054s/iter; time left: 6.3993s
	iters: 200, epoch: 10 | loss: 0.0584097
	speed: 0.0015s/iter; time left: 1.6462s
	iters: 300, epoch: 10 | loss: 0.0697569
	speed: 0.0019s/iter; time left: 1.8708s
	iters: 400, epoch: 10 | loss: 0.0567791
	speed: 0.0018s/iter; time left: 1.5834s
	iters: 500, epoch: 10 | loss: 0.0643047
	speed: 0.0018s/iter; time left: 1.4284s
	iters: 600, epoch: 10 | loss: 0.0834248
	speed: 0.0014s/iter; time left: 0.9671s
	iters: 700, epoch: 10 | loss: 0.0759743
	speed: 0.0025s/iter; time left: 1.4780s
	iters: 800, epoch: 10 | loss: 0.0796186
	speed: 0.0016s/iter; time left: 0.7836s
	iters: 900, epoch: 10 | loss: 0.0383590
	speed: 0.0018s/iter; time left: 0.7023s
	iters: 1000, epoch: 10 | loss: 0.0485064
	speed: 0.0020s/iter; time left: 0.5775s
	iters: 1100, epoch: 10 | loss: 0.0643825
	speed: 0.0016s/iter; time left: 0.3105s
	iters: 1200, epoch: 10 | loss: 0.0623952
	speed: 0.0018s/iter; time left: 0.1659s
Epoch: 10 cost time: 2.3s
Epoch: 10, Steps: 1291 | Train Loss: 0.1015473 Vali Loss: 7.9849868 Test Loss: 10.8845072
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
>>>>>>>testing : MRO_336_336_S_channels_6<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2809

Final Metrics:

FITS         MSE: 10.885624  MAE: 2.540586   SE: 20.805723  RRMSE: 0.404318   RMAE: 0.311337   (numpy)
FITS         MSE: 10.885626  MAE: 2.540586   SE: 20.805723  RRMSE: 0.404318   RMAE: 0.311337   (torch)

Repeat       MSE: 10.261215  MAE: 2.420922   SE: 21.428272  RRMSE: 0.392551   RMAE: 0.296672   (numpy)
Repeat       MSE: 10.261217  MAE: 2.420922   SE: 21.428272  RRMSE: 0.392551   RMAE: 0.296672   (torch)

Shapes: pred (2808, 336, 1), true (2808, 336, 1), naive_pred (2808, 336, 1), gt (2808, 672, 1), metrics {'FITS': {'mse': 10.885624, 'mae': 2.5405858, 'se': 20.805723, 'relative_rmse': 0.40431798, 'relative_mae': 0.31133667, 'mse_torch': 10.885625839233398, 'mae_torch': 2.540585994720459, 'se_torch': 20.805723190307617, 'relative_rmse_torch': 0.40431802239629644, 'relative_mae_torch': 0.31133668628299993}, 'Repeat': {'mse': 10.261215, 'mae': 2.4209218, 'se': 21.428272, 'relative_rmse': 0.39255074, 'relative_mae': 0.2966724, 'mse_torch': 10.26121711730957, 'mae_torch': 2.420921564102173, 'se_torch': 21.428272247314453, 'relative_rmse_torch': 0.3925507735448641, 'relative_mae_torch': 0.2966723815233658}}
